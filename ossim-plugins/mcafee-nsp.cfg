# Alienvault plugin
# Author: Alienvault Team at plugins@alienvault.com
# Plugin mcafee-nsp id:1832 version: 0.0.6
# Last modification: 2018-05-28 16:30
#
# Plugin Selection Info:
# McAfee:Network Security Platform:-
#
# END-HEADER
# Description:
# 

[DEFAULT]
plugin_id=1832

[config]
type=detector
enable=yes
source=log
location=/var/log/mcafee-nsp.log
create_file=false

process=
start=no
stop=no
startup=
shutdown=

[translation]
Bidirectional attack ICMP_ECHO Anomaly=1
Inbound attack Botnet: DGA Heuristic Detection of Botnet Zombie=2
Inbound attack Botnet: DGA Heuristic Detection of C&C Server in DNS Response=3
Inbound attack Callback Detectors: Connection Using High Confidence C&C Server Domain Name Detected=4
Inbound attack DHCP: Option Suspiciously Long=5
Inbound attack DNS: OPT Denial of Service=6
Inbound attack HTTP: 3Com SuperStack Switch Web Interface Denial Of Service Vulnerability=7
Inbound attack HTTP: Apache HTTPD mod_proxy_ajp Denial Of Service=8
Inbound attack HTTP: Detect PHP-CGI Remote code Execution vulnerability=9
Inbound attack HTTP: HTTP Login Bruteforce Detected=10
Inbound attack HTTP: Microsoft IE MHTML Protocol Cross Domain Policy=11
Inbound attack HTTP: Microsoft Internet Explorer Remote urlmon.dll Buffer Overflow=12
Inbound attack HTTP: Microsoft Internet Explorer VML Memory Corruption Vulnerability=13
Inbound attack HTTP: Microsoft Windows HTML Converter HR Align Buffer Overflow Vulnerability=14
Inbound attack HTTP: Mozilla Firefox Link Tag Code Injection=15
Inbound attack HTTP: Possible HTTP DoS Attack with Invalid HTML Page Access=16
Inbound attack HTTP: Response UTF16/32 Encoding=17
Inbound attack HTTP: RFC 2397 Data URL Usage to Bypass Detection=18
Inbound attack HTTP: SQL Injection Attack Detected=19
Inbound attack HTTP: Thttpd Stack Overflow=20
Inbound attack HTTP: Xitami If-Modified-Since Header Buffer Overflow I=21
Inbound attack HTTP: ZmEu Exploit Scanner=22
Inbound attack ICMP: Timestamp Probe=23
Inbound attack Inbound TCP OTX Segment Volume Too High=24
Inbound attack Inbound TCP SYN or FIN Volume Too High=25
Inbound attack P2P: BitTorrent File Transfer HandShaking=26
Inbound attack P2P: BitTorrent Meta-Info Retrieving=27
Inbound attack RPC: Portmap Dump Request=28
Inbound attack SIP: Asterisk SDP RTP Codec Handling Buffer Overflow=29
Inbound attack SMTP: Microsoft Collaboration Data Objects Vulnerability=30
Inbound attack SSL: OpenSSL Client Hello Cipher Length Overflow=31
Inbound attack SYMANTEC: Symantec Discovery XFERWAN Service Buffer Overflow=32
Inbound attack TCP: SYN Host Sweep=33
Inbound attack TCP: SYN Port Scan=34
Inbound attack Too Many Inbound Large ICMP packets=35
Inbound attack Too Many Inbound Rejected TCP Packets=36
Inbound attack Too Many Inbound TCP SYNs=37
Inbound attack UDP: Too Many Inbound UDP Packets=38
Outbound attack Botnet: DGA Heuristic Detection of Connection to C&C Server=39
Outbound attack HTTP:  Adobe Products PNG file Stack Buffer Overflow=40
Outbound attack HTTP: HTTP Login Bruteforce Detected=41
Outbound attack HTTP: IE Modal Dialog Script Execution=42
Outbound attack HTTP: Microsoft Windows PNG Image Rendering Vulnerability=43
Outbound attack HTTP: Overly Long POST URI in HTTP Request=44
Outbound attack HTTP: Possible HTTP DoS Attack with Invalid HTML Page Access=45
Outbound attack HTTP: Response UTF16/32 Encoding=46
Outbound attack MSSQL: Password Brute Force=47
Outbound attack Outbound TCP OTX Segment Volume Too High=48
Outbound attack P2P: Peer-to-peer Distributed File Download Obfuscated-Traffic Detected=49
Outbound attack P2P: Skype Logon Process Detected=50
Outbound attack SSL: Server-Initiated Key Renegotiation Detected=51
Outbound attack SYMANTEC: Symantec Discovery XFERWAN Service Buffer Overflow=52
Outbound attack TCP: SYN Port Scan=53
Outbound attack Too Many Outbound Large ICMP packets=54
Outbound attack Too Many Outbound Rejected TCP Packets=55
Outbound attack Too Many Outbound UDP Packets=56
Unknown attack BACKDOOR: Back Orifice Trojan=57
Unknown attack ICMP: Netmask Request=58
Unknown attack ICMP: Timestamp Probe=59
Inbound attack HTTP: Microsoft Browser Spoofing Vulnerability=60
Inbound attack HTTP: Microsoft Browser Spoofing Vulnerability=61
Inbound attack Inbound Link Utilization (Bytes/Sec) Too High=62
Outbound attack Outbound Link Utilization (Bytes/Sec) Too High=63
Attack Host: Inbound Service Packet volume too high=64
Attack Host: Outbound SYN or FIN packet volume too high=65
Attack IPv4 has zero destination ID=66
Attack IPv4 has zero source ID=67
Attack Possible botnet activity (SMTP Domain Mismatch)=68
Attack TCP: SYN Host Sweep=69
Attack TCP: SYN Port Scan=70
Attack UDP: Host Sweep=71
Attack UDP: Port Scan=72
Attack Zero Source Port=73
Attack Zero UDP Payload=74
Alert & Packetlog Purge is ongoing=75
Alert & Packetlog Purge succeeded=76
Backup Scheduler is ongoing=77
Backup Scheduler succeeded=78
Bot DAT Download to Manager is ongoing=79
Bot DAT Download to Manager succeeded=80
Botnet DAT Download failed=81
Botnet DAT Download is ongoing=82
Botnet DAT Download succeeded=83
File Maintenance Scheduler is ongoing=84
File Maintenance Scheduler succeeded=85
File to Manager Upload failed=86
File to Manager Upload succeeded=87
Manager Start Up succeeded=88
Network Security Manager Login succeeded=89
Network Security Manager Logoff succeeded=90
Report Generation is ongoing=91
Report Generation succeeded=92
Scheduled check of GTI Server for new DAT Files is ongoing=93
Scheduled check of GTI Server for new DAT Files succeeded=94
Scheduled check of Update Server for new signature sets failed=95
Scheduled check of Update Server for new signature sets is ongoing=96
Scheduled check of Update Server for new signature sets succeeded=97
Signature Download to Manager is ongoing=98
Signature Set Download is ongoing=99
Signature Set Download succeeded=100
Update all policies sigset is ongoing=101
Update all policies sigset succeeded=102
Signature Download to Manager succeeded=103
Inbound attack MSSQL: SQL Server Worm Slammer = 104
Outbound attack P2P: TeamViewer Traffic Detected = 105
Outbound attack P2P: GoToMeeting Traffic Detected = 106
Inbound attack NMAP: XMAS Probe = 107
Inbound attack BACKDOOR: Back Orifice Trojan = 108
Inbound attack DDoS: Trin00 Master-to-Agent Communication = 109
Outbound attack Outbound UDP Packet Volume Too High = 110
Outbound attack DNS: ISC BIND DNS64 RPZ Assertion Failure Denial of Service = 111
Inbound attack Inbound UDP Packet Volume Too High = 112
Fault=200
<CLEARED>=201
Device Disconnected = 202
Synchronization from the peer Manager has been completed successfully = 203
Scheduled Signature Set Download Successful = 204
The scheduled signature set download from the McAfee Update Server to the Manager was successful = 205
Automatic Signature Set Deployment in Progress = 206
A new signature set has recently been downloaded by the Manager and successfully deployed to its devices = 207
Successful Automatic Signature Set Deployment = 208
Callback Detectors Deployment Failure = 209
HA Pair Callback Detectors Out-ofSync = 210
HA Pair Configuration Out-of-Sync = 211
Schedule Report Generation is ongoing = 212
Schedule Report Generation succeeded = 213
LDAP Authentication failed = 214
Network Security Manager Login failed = 215
IPS Policy Modification succeeded = 216
IPS Policy Application succeeded = 217
Scheduled check of GTI Server for new Callback Detectors Files is ongoing = 218
Scheduled Signature Set Download in Progress = 219

Inbound attack RDP: Microsoft Windows RDP Server Abnormal Termination = 300
Signature Set Download Failure failed = 301
Inbound attack P2P: JoinMe Traffic Detected = 302
Outbound attack TCP: Illegal FIN Probe = 303
Outbound attack HTTP: KeepAlive Request Detected = 304
Geolocation Database Deployment Failure = 305
Deployment Failure = 306
MDR Synchronization in Progress = 307
Successful Scheduled Signature Set Deployment = 308
Successful MDR Synchronization = 309
Scheduled Signature Set Deployment in Progress = 310
Link Failure of Port = 311
Alert Channel Down = 312
Update Server Communications Failure = 313
Callback Detectors Deployment Failure = 314
Packet Capture Channel Down = 315
Scheduled Callback Detectors Download in Progress = 316
Successful Automatic Callback Detectors Deployment = 317
Automatic Callback Detectors Deployment in Progress = 318
Database Backup in Progress = 319
Database Backup Successful = 320
Database Tuning Recommended = 321
McAfee GTI Server Disconnected = 322
Key Value not found in the properties file = 323
Scheduled Callback Detectors Download Successful = 324
Conflict in MDR Status = 325
Sensor Throughput Usage detected= 326
New Callback Detectors have recently been downloaded by the Manager and successfully deployed to its devices = 327
The scheduled Callback Detectors download from the McAfee Update Server to the Manager was successful = 328
A new signature set has recently been downloaded by the Manager and successfully deployed to its devices, as scheduled = 329
Callback Detector Download is ongoing = 330
Callback Detector Download succeeded = 331
Callback Detector Download failed = 332
Generate MDR Dump is ongoing = 333
Generate MDR Dump succeeded = 334
Inbound attack ICMP: Possible attack to exploit BlackNurse vulnerability = 335
Outbound attack IM: Google Talk Traffic Detected = 336
Outbound attack P2P: Ares/Warez-Gnutella Traffic Detected = 337
Outbound attack IM: Web Based Instant Messenger Services = 338
Outbound attack RPC: Portmap Dump Request = 339
Inbound attack RPC: Wind River Systems VxWorks WDB Debug Activities Detected = 340
Inbound attack P2P: Skype Logon Process Detected = 341
Signature Set Download failed = 342
Signature Set Download is ongoing = 343
Outbound attack HTTP: Internet Media Tunneling through HTTP = 344
CPU Usage detected = 345
Inbound attack DNS: ISC BIND RRSIG RRsets Denial of Service Vulnerability = 346
Outbound attack ICMP: Timestamp Probe = 347
Inbound attack Inbound TCP SYN or FIN Volume Too High = 348
Unknown attack P2P: Skype Logon Process Detected = 349
Outbound attack DNS: OPT Denial of Service = 350
Outbound attack IM: MSN (.NET) Messenger Alive = 351
Unknown attack IM: MSN (.NET) Messenger Alive = 352
Unknown attack IM: Google Talk Traffic Detected = 353
Inbound attack HTTP: Internet Explorer Memory Corruption Vulnerability = 354
Inbound attack HTTP: IE Nested HTML Tag Memory Corruption Vulnerability = 355
Outbound attack SSH: Juniper OS SSH Accessible = 356
Outbound attack HTTP: Apache Options Memory Leak Vulnerability = 357
Outbound attack RPC: Wind River Systems VxWorks WDB Debug Activities Detected = 358
Inbound attack HTTP: Invalid Usage of Transfer Encoding Header = 359
Inbound attack P2P: Torrent uTP BEP-29 Traffic Detected = 360
Outbound attack P2P: Octoshape Traffic detected = 361
Outbound attack HTTP: Oracle BEA WebLogic Server Apache Connector DoS Vulnerability = 362
Unknown attack HTTP: Oracle BEA WebLogic Server Apache Connector DoS Vulnerability = 363
Unknown attack HTTP: Overly Long POST URI in HTTP Request = 364
Scheduled check of GTI Server for new Callback Detectors Files succeeded = 365
Callback Detector Download to Manager is ongoing = 366
Callback Detector Download to Manager succeeded = 367
Inbound attack DCERPC: Advantech WebAccess datacore Service Function 0x5228 strcpy Heap Buffer Overflow = 368
Outbound attack SCAN: NULL Probe = 369
Outbound attack Malware: Drive-By Crypto Mining Malware Detected = 370
Outbound attack MALWARE: File Mismatch Detected = 371
Sensor reports link status change succeeded = 372
Outbound attack DCERPC: Advantech WebAccess datacore Service Function 0x5228 strcpy Heap Buffer Overflow = 373
Outbound attack P2P: BitTorrent Meta-Info Retrieving = 374
Inbound attack HTTP: Mozilla Multiple Products Multiple Location Headers II = 375
Outbound attack RDP: Microsoft Windows RDP Server Abnormal Termination = 376
Outbound attack NMAP: XMAS Probe = 377
Outbound attack SCAN: SYN FIN Based Probes = 378
Outbound attack NMAP: XMAS with SYN Probe = 379
Outbound attack TELNET: Microsoft Telnet Credential Reflection Vulnerability = 380
Outbound attack ICMP: Possible Attack To Exploit BlackNurse Vulnerability II = 381
Outbound attack ICMP: Possible attack to exploit BlackNurse vulnerability = 381
Outbound attack IMAP: Password Brute Force = 382
Inbound attack Kerberos: Kerberos Login Bruteforce Detected = 383

UpdateServer:ConnectionFailure  <CLEARED> = 400
DATGTICommunication:DATGTICommunicationFailure  <CLEARED> = 401
UpdateSensorScheduler:UpdateSensorBotDATSchedulerInProgress  <CLEARED> = 402
Alert Channel:DOWNFromSensor  <CLEARED> = 403
Packet Log Channel:DOWN  <CLEARED> = 404
DATSensorScheduler:RTDATUpdateSensorSchedulerInProgress  <CLEARED> = 405
. (High Usage Threshold: 90%).  <CLEARED> = 406
UpdateSensorScheduler:UpdateSensorSchedulerInProgress  <CLEARED> = 407
DATServerScheduler:DATServerSchedulerInProgress  <CLEARED> = 408
Command Channel:DISCONNECTED  <CLEARED> = 409
DataDumpRetrieval:DataDumpRetrievalFromPeerInProgress  <CLEARED> = 410
UpdateServerScheduler:UpdateServerSchedulerInProgress  <CLEARED> = 411
UpdateSensorScheduler:RTUpdateSensorSchedulerInProgress  <CLEARED> = 412
Realtime Update:SignatureUpdateFAIL  <CLEARED> = 413
Alert Channel:DOWN  <CLEARED> = 414

#Rule6
ARP: ARP Spoofing Detected = 500
BOT: GoScanSSH Traffic Detected = 501
Callback Detectors: Connection Using High Confidence C&C Server Domain Name Detected = 4
DNP3: Invalid DNP3 Flow = 502
DNS: ISC BIND Resolver Library Buffer Overflow Vulnerability = 503
DNS: Microsoft SMTP Service DNS resolver overflow = 504
DNS: Monero Mining Possible ADB.Miner Worm Activity Detected = 505
DNS: Possible DNS Tunneling Attempt III = 506
DNS: Possible requests for Chrome Remote Desktop detected = 507
DNS: Tftpd32 DNS Server Buffer Overflow = 508
ExploitKit: SweetOrange Exploit Jarjnlp Oct 14 = 509
ExploitKit: Suspicious Activity Detected IV = 510
HTTP: ASP.Net Forms Authentication Bypass Vulnerability = 511
HTTP: Abnormal Chunk Size String Value = 512
HTTP: Adobe Acrobat Memory Corruption Vulnerability(CVE-2016-0936) = 513
HTTP: Adobe Reader SING Tags Founded = 514
HTTP: Apache Multiple Linefeed Request Memory Consumption DoS = 515
HTTP: Apache Tomcat Snoop Servlet Information Disclosure = 516
HTTP: Blind SQL Injection - Exploit = 517
HTTP: CGI Escape Character Directory Traversal = 518
HTTP: Cross Site Scripting - Script Attempt Found in HTTP request = 519
HTTP: Cross-Site Scripting - Script Attempt Found in HTTP Request III = 520
HTTP: Cross-Site Scripting II - Script Attempt Found in HTTP Request II = 521
HTTP: Google Chrome Javascript V8 Engine Integer Overflow = 522
HTTP: HTML Evasions Detected = 523
HTTP: HTTPS Proxy Detected = 524
HTTP: IIS Extended Unicode Character = 525
HTTP: Internet Explorer CTable initialize stack variables Vulnerability (CVE-2015-6146) = 526
HTTP: Joomla Component JCE File Upload Remote Code Execution = 527
HTTP: Joomla HTTP Header Unauthenticated Remote Code Execution = 528
HTTP: KeepAlive Request Detected = 304
HTTP: Malformed Word File = 529
HTTP: Microsoft ATMFD Kernel Pool Code Execution Vulnerability (CVE-2015-2426) = 530
HTTP: Microsoft Excel Malformed Record Vulnerability = 531
HTTP: Microsoft Internet Explorer Improper Ref Counting Use-After-Free Vulnerability = 532
HTTP: Microsoft Internet Explorer Javascript Information Disclosure Vulnerability = 533
HTTP: Microsoft Memory Allocation Vulnerability I = 534
HTTP: Microsoft OWA Calendar Detail XSS Vulnerability (CVE-2014-6326) = 535
HTTP: Microsoft Office Bad Index Remote Code Execution Vulnerability (CVE-2014-6334) = 536
HTTP: Microsoft Office Excel Sheet Object Type Confusion Vulnerability II = 537
HTTP: Microsoft Office Memory Corruption Vulnerability(CVE-2015-2477) = 538
HTTP: Microsoft Outlook Express Information Disclosure Vulnerability = 539
HTTP: Microsoft Word Drawing Object Vulnerability = 540
HTTP: Novell NetMail WebAdmin Possible Username Overly Long = 541
HTTP: Office Malformed Record Vulnerability = 542
HTTP: Oracle WebLogic Server Remote Code Execution Vulnerability (CVE-2017-10271) = 543
HTTP: PHP Wordpress Plugin Revolution Slider Vulnerability = 544
HTTP: Possible Evasion with Chunked Content = 545
HTTP: Possible HTTP Brute Force Attack Against ASP.NET Pages = 546
HTTP: Possible UTF-16/32 Evasion = 547
HTTP: Potentially Malicious JavaScript Detected I = 548
HTTP: Potentially Malicious JavaScript Detected II = 549
HTTP: Potentially Malicious JavaScript Detected III = 550
HTTP: Repeated Download Detected = 551
HTTP: SQL Injection - Exploit II = 552
HTTP: SQL Injection - Exploit IV = 553
HTTP: SQL Injection - Exploit V = 554
HTTP: Thttpd Stack Overflow = 20
HTTP: Unusual Host Detected = 555
HTTP: Websocket connection established = 556
HTTP: Websocket handshake request detected = 557
HTTP: Windows 2003 Shell Folders Directory Traversal = 558
HTTP: ZmEu Exploit Scanner = 22
ICMP: Timestamp Probe = 23
ICMP: Traceroute Echo Request Packet = 559
ICMP: UDP Packet Found inside ICMP = 560
IMAP: Overly Long STATUS Command Parameter = 561
IMAP: Password Brute Force = 562
Inbound TCP SYN or FIN Volume Too High = 25
Inbound UDP Packet Volume Too High = 112
LDAP: CLDAP DDoS reflection attack = 563
MALWARE: File Mismatch Detected = 371
MALWARE: Malicious File Detected by GAM = 564
MALWARE: Malicious PDF file transfer detected ANNOT FUNC VII = 565
NETBIOS-SS: NETBIOS-SMB Bruteforce Attempt = 566
P2P: Peer-to-peer Distributed File Download Obfuscated-Traffic Detected = 49
P2P: TeamViewer Traffic Detected = 105
POP3: Overly Long Server Message Before Response Code = 567
POP3: POP Peeper UIDL Buffer Overflow = 568
RDP: RDP Session Identification = 569
SSH: OpenSSH Connection Detected = 570
SSL: Microsoft IIS TLSv1 Denial of Service Vulnerability = 571
SSL: Possible OpenSSL Use After Free Vulnerability (CVE-2016-6309) = 572
SSL: SSLv3 Session Detected = 573
SSL: Unsupported or Unknown Cipher = 574
TCP: Full-Connect Host Sweep = 575
VoIP: Google Talk Voice and Video connections = 576


_DEFAULT_=20000000

[0001 - Attack detected]
event_type=event
precheck="(severity ="
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<device>\S+)\s(?P<proc>[^:]*):\s(?:\((?P<alert>[^)]*)\)\s)?(?P<sensor>\S+)\sdetected\s(?P<attack>[^(]+(?:\((?!severity|CVE)[^(]+)?)(?:\s\((?P<cve>CVE[^)]*)\))?\s\(severity\s=\s(?P<severity>[^)]+)\)\.\s(?:N/A|(?P<srcip>[^:]*)):(?:N/A|(?P<srcport>\d+))\s->\s(?:N/A|(?P<dstip>[^:]*)):(?:N/A|(?P<dstport>\d+))\s\(result\s=\s(?:n/a|(?P<result>[^)]*))"
date={normalize_date($date)}
plugin_sid={translate($attack)}
device={$device}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
userdata1={$sensor}
userdata2={$severity}
userdata3={$result}
userdata4={$proc}
userdata5={$cve}
userdata6={$alert}

[0002 - Attack]
event_type=event
precheck=": Attack"
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<device>\S+)\s(?P<proc>[^:]*):\s(?P<attack>.*)\s\((?P<severity>[^)]+)"
date={normalize_date($date)}
plugin_sid={translate($attack)}
device={$device}
userdata2={$severity}
userdata4={$proc}

[0003 - Operation]
event_type=event
precheck=" at "
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<device>\S+)\s(?P<proc>[^:]*):\s(?P<operation>.*?(?:succeeded|ongoing|failed))\sat\s(?P<date2>.*)"
date={normalize_date($date2)}
plugin_sid={translate($operation)}
device={$device}
userdata4={$proc}

[0004 - Fault Cleared]
event_type=event
precheck="<CLEARED>"
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<device>\S+)\s(?P<proc>[^:]*):\s(?P<fault>Fault)\s*:\s*(?P<rep>[^\s:]*):\s*(?P<fault_desc>[^:\.]*):?\s*(?P<sid>(?:(?P<mod>[^:]*)(?::(?P<reason>\S+))?|\.\s*\(High Usage Threshold: \d+%\)\.)\s+(?P<result><CLEARED>))"
date={normalize_date($date)}
plugin_sid={translate($sid)}
device={$device}
userdata1={$rep}
userdata4={$proc}
userdata7={$fault_desc}
userdata8={$mod}
userdata9={$reason}

[0005 - Fault]
event_type=event
precheck=" Fault"
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<device>\S+)\s(?P<proc>[^:]*):\s(?P<fault>Fault)\s*:\s*(?:\[(?P<info>[^\]]+)\]:\s+)?(?:(?P<rep>[^\s:]*):\s*(?:\d+%\s)?)?(?P<fault_desc>(?:CPU Usage detected|Sensor Throughput Usage\sdetected|[^:\.]*))(?::(?P<mod>[^:]*)(?::(?P<reason>\S+))?)?(?:\son\s(?P<data>\S+)\.\s\((?P<msg>[^)]+)\)|\s+(?P<result>\S+))?"
date={normalize_date($date)}
plugin_sid={translate($fault_desc)}
device={$device}
userdata1={$rep}
userdata2={$msg}
userdata3={$data}
userdata4={$proc}
userdata7={$fault_desc}
userdata8={$mod}
userdata9={$reason}

[0006 - SyslogAlertForwarder events]
event_type=event
precheck="SyslogAlertForwarder"
regexp="(?P<date>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?P<device>\S+)\s+SyslogAlertForwarder:\s+\|(?P<data>\d+)\|(?P<data1>[^|]+)\|(?P<date_event>\d+-\d+-\d+\s+\d+:\d+:\d+)\s+\w+\|"(?P<sid>[^"]+)"\|(?P<data2>[^|]+)\|(?P<sev>[^|]+)\|(?:N/A|(?P<data3>[^|]+))\|(?:N/A|(?P<data4>[^|]+))\|(?:N/A|(?P<company>[^|]+))\|(?:N/A|(?P<product>[^|]+))\|(?:N/A|(?P<net>[^|]+))\|(?:N/A|(?P<src>[^|]+))\|(?:N/A|(?P<src_port>[^|]+))\|(?:N/A|(?P<dst>[^|]+))\|(?:N/A|(?P<dst_port>[^|]+))\|"
date={normalize_date($date_event)}
plugin_sid={translate($sid)}
device={$device}
src_ip={$src}
src_port={$src_port}
dst_ip={$dst}
dst_port={$dst_port}
userdata1={$data}
userdata2={$data1}
userdata3={$data2}
userdata4={$sev}
userdata5={$data3}
userdata6={$data4}
userdata7={$company}
userdata8={$product}
userdata9={$net}

[9999 - Generic Rule]
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<device>\S+).*"
date={normalize_date($date)}
plugin_sid=20000000
device={$device}
src_ip={$device}
