# Alienvault plugin
# Author: Alienvault Team at plugins@alienvault.com
# Plugin ossec-single-line id:7007 version: 0.0.74
# Last modification: 2018-11-15 11:00
#
# Plugin Selection Info:
# AlienVault:HIDS:-:N
#
# END-HEADER
# Accepted products:
# OSSEC - OSSEC 2.9_singleline
# OSSEC - OSSEC 2.8_singleline
# OSSEC - OSSEC 2.7_singleline
# Description:
# <custom_alert_output>AV - Alert - "$TIMESTAMP" --> RID: "$RULEID"; RL: "$RULELEVEL"; RG: "$RULEGROUP"; RC: "$RULECOMMENT"; USER: "$DSTUSER"; SRCIP: "$SRCIP"; HOSTNAME: "$HOSTNAME"; LOCATION: "$LOCATION"; EVENT: "[INIT]$FULLLOG[END]"; </custom_alert_output>
#
#

[DEFAULT]
plugin_id=7007

[config]
type=detector
enable=yes
pre_match="^AV\s-\sAlert\s-\s\"\d+\"\s-->\sRID:\s\"(?P<key>\d+)\".*"
source=log
location=/var/ossec/logs/alerts/alerts.log

create_file=false

process=ossec-logcollector
start=yes   ; launch plugin process when agent starts
stop=yes    ; shutdown plugin process when agent stops
restart=no  ; restart plugin process after each interval
restart_interval=_CFG(watchdog,restart_interval) ; interval between each restart
startup=/etc/init.d/ossec start
shutdown=/etc/init.d/ossec stop

exclude_sids=1002,1003

[avapi-sids]
5501=1005501
5502=1005502
5715=1005715
10100=10010100
17101=17101

[translation]
01=7001
02=7002
03=7003
04=7004
05=7005
06=7006
07=7007
500=7007
501=7007
502=7007
503=7007
504=7007
509=7093
510=7093
511=7093
512=7093
513=7093
514=7093
515=7094
516=7093
518=7093
519=7093
530=7104
531=7018
532=7007
533=7007
534=7007
535=7007
550=7094
551=7094
552=7094
553=7094
554=7094
555=7102
580=7095
581=7095
591=7007
592=7090
593=7087
594=7094
595=7094
596=7094
597=7094
598=7094
600=8001
601=8001
602=8001
603=8001
604=8001
605=8001
606=8001
1001=7017
1002=7017
1003=7017
1004=7017
1005=7017
1006=7017
1007=7018
1008=7027
1009=7017
2100=7019
2101=7019
2102=7019
2103=7019
2104=7019
2301=7020
2501=7010
2502=7010
2503=7022
2504=7011
2505=7021
2506=7021
2507=7021
2508=7021
2509=7021
2550=7021
2551=7050
2701=7023
2800=7024
2801=7024
2802=7024
2803=7024
2830=7029
2831=7029
2832=7029
2833=7029
2834=7029
2900=7116
2901=7116
2902=7042
2903=7042
2930=7112
2931=7112
2932=7042
2933=7042
2934=7042
3100=7076
3101=7076
3102=7074
3103=7074
3104=7074
3105=7074
3106=7074
3107=7076
3108=7074
3109=7044
3151=7075
3152=7075
3153=7075
3154=7075
3155=7075
3156=7075
3158=7075
3190=7077
3191=7074
3300=7073
3301=7074
3302=7074
3303=7074
3304=7074
3305=7074
3306=7074
3320=7073
3330=7027
3331=7027
3332=7010
3333=7027
3334=7073
3351=7075
3352=7075
3353=7075
3354=7075
3355=7075
3356=7075
3357=7012
3390=7073
3500=7084
3501=7084
3502=7084
3600=7078
3601=7010
3602=7009
3603=7078
3651=7012
3700=7079
3701=7079
3702=7074
3751=7075
3800=7081
3801=7074
3802=7074
3851=7075
3852=7075
3900=7056
3901=7050
3902=7010
3903=7056
3904=7009
3910=7012
3911=7014
4100=7002
4101=7068
4151=7069
4300=7041
4310=7041
4311=7041
4312=7041
4313=7041
4314=7041
4315=7041
4321=7010
4322=7041
4323=7009
4324=7010
4325=7041
4326=7022
4327=7041
4330=7041
4331=7041
4332=7041
4333=7003
4334=7010
4335=7009
4336=7010
4337=7027
4338=7027
4339=7042
4340=7042
4341=7041
4342=7043
4380=7041
4381=7041
4382=7044
4383=7041
4385=7041
4386=7012
4500=7071
4501=7071
4502=7071
4503=7071
4504=7071
4505=7027
4506=7009
4507=7009
4508=7042
4509=7042
4513=7071
4550=7071
4551=7071
4552=7071
4553=7071
4700=7070
4710=7070
4711=7070
4712=7070
4713=7070
4714=7070
4715=7070
4716=7070
4717=7070
4721=7042
4722=7009
4724=7010
4800=7072
4801=7072
4802=7072
4803=7072
4804=7072
4805=7072
4806=7072
4807=7072
4810=7009
4811=7010
4850=7027
4851=7027
5100=7025
5101=7025
5102=7025
5103=7025
5104=7026
5105=7025
5106=7025
5107=7025
5108=7027
5109=7025
5110=7025
5111=7025
5112=7025
5113=7028
5130=7025
5131=7025
5200=7025
5300=7030
5301=7010
5302=7010
5303=7009
5304=7009
5305=7030
5306=7030
5400=7033
5401=7033
5402=7033
5403=7033
5500=7001
5501=7009
5502=7001
5503=7010
5504=7011
5521=7001
5522=7001
5523=7001
5551=7012
5552=7001
5553=7001
5554=7001
5555=7001
5600=7016
5601=7016
5602=7016
5603=7016
5604=7016
5631=7016
5700=7013
5701=7013
5702=7013
5703=7013
5704=7013
5705=7013
5706=7014
5707=7015
5709=7013
5710=7010
5711=7013
5712=7012
5713=7013
5714=7015
5715=7009
5716=7010
5717=7013
5718=7011
5719=7011
5720=7012
5721=7013
5722=7013
5723=7013
5724=7013
5725=7013
5726=7013
5727=7013
5728=7010
5729=7013
5730=7013
5731=7014
5732=7013
5733=7012
5734=7013
5735=7013
5736=7013
5737=7013
5738=7010
5901=7032
5902=7032
5903=7032
5904=7032
6100=7119
6101=7119
6102=7119
6103=7009
6104=7010
6105=7009
6106=7010
6200=7121
6201=7121
6202=7121
6203=7121
6210=7010
6211=7011
6212=7011
6250=7121
6251=7121
6252=7121
6253=7011
6254=7121
6255=7011
6256=7011
6257=7121
6300=7109
6301=7103
6302=7027
6303=7044
6304=7124
6305=7124
6306=7124
6307=7124
6308=7124
6309=7124
6310=7124
6311=7124
6312=7124
6313=7124
6314=7124
6315=7124
6316=7106
6317=7106
6318=7123
6319=7123
6320=7123
6321=7122
6322=7123
6323=7124
6350=7109
6351=7110
6352=7110
6354=7110
6355=7110
6356=7110
6357=7110
6358=7110
6359=7110
6360=7110
6361=7103
6362=7027
6363=7027
6364=7044
6365=7110
6366=7110
6367=7110
6368=7110
6369=7110
6370=7110
6371=7110
6372=7110
6373=7110
6374=7110
6376=7110
7101=7031
7200=7036
7201=7037
7202=7038
7203=7027
7204=7038
7205=7036
7206=7036
7207=7036
7208=7036
7209=7038
7300=7039
7301=7039
7310=7040
7320=7039
7400=7039
7410=7010
7415=7009
7420=7009
7500=7111
7501=7111
7502=7111
7503=7111
7504=7040
7505=7040
7506=7040
7507=7111
7508=7111
7509=7111
7510=7111
7511=7111
7512=7111
7513=7111
7514=7111
7550=7111
7600=7105
7610=7040
7611=7040
7612=7105
7613=7105
7701=7114
7710=7040
7711=7040
7712=7040
7720=7086
7731=7114
7750=7114
7751=7114
9100=7034
9101=7034
9102=7034
9200=7005
9201=7005
9300=7054
9301=7054
9302=7054
9303=7054
9304=7027
9305=7009
9306=7010
9351=7012
9352=7027
9400=7117
9401=7010
9402=7009
9500=7113
9501=7010
9502=7009
9503=7113
9504=7113
9505=7113
9510=7113
9551=7012
9600=7101
9610=7010
9611=7027
9700=7100
9701=7009
9702=7010
9703=7100
9704=7100
9705=7010
9706=7100
9707=7011
9750=7012
9751=7012
9800=7118
9801=7010
9820=7012
9900=7055
9901=7010
9902=7011
9903=7010
9904=7009
9951=7012
9952=7012
9953=7012
10100=7009
11100=7098
11101=7022
11102=7098
11103=7098
11104=7098
11105=7098
11106=7050
11107=7022
11108=7047
11109=7012
11110=7098
11111=7010
11112=7010
11113=7010
11200=7052
11201=7050
11202=7052
11203=7011
11204=7010
11205=7009
11206=7022
11207=7022
11208=7052
11209=7052
11210=7012
11211=7052
11212=7052
11213=7050
11214=7052
11215=7052
11216=7052
11217=7052
11218=7027
11219=7052
11220=7052
11221=7052
11251=7012
11252=7014
11253=7052
11300=7051
11301=7050
11302=7010
11303=7051
11304=7051
11305=7051
11306=7012
11307=7014
11309=7009
11400=7049
11401=7050
11402=7009
11403=7010
11404=7049
11451=7012
11452=7014
11500=7053
11501=7050
11502=7010
11503=7009
11504=7053
11510=7012
11511=7014
11512=7053
12100=7045
12101=7046
12102=7022
12103=7047
12104=7044
12105=7045
12106=7045
12107=7045
12108=7045
12109=7027
12110=7044
12111=7044
12112=7045
12113=7045
12114=7045
12115=7045
12116=7045
12117=7045
12118=7045
12119=7045
12120=7045
12121=7045
12122=7045
12123=7045
12125=7045
12126=7045
12127=7045
12128=7045
12129=7045
12130=7045
12131=7045
12132=7045
12133=7045
12134=7045
12135=7045
12136=7045
12137=7045
12138=7045
12139=7045
12140=7045
12141=7045
12142=7045
12143=7045
12144=7045
12145=7045
12146=7045
12147=7045
12148=7045
13100=7048
13101=7048
13102=7022
13103=7048
13104=7022
13105=7048
13106=7048
13108=7048
13109=7048
13110=7048
13111=7048
13112=7048
14100=7082
14101=7010
14110=7082
14111=7082
14112=7082
14120=7009
14121=7082
14122=7082
14123=7082
14151=7082
14200=7083
14201=7009
14202=7010
14203=7009
14251=7012
17101=7115
17102=7108
18100=7006
18101=7006
18102=7006
18103=7044
18104=7006
18105=7006
18106=7085
18107=7009
18108=7006
18109=7006
18110=7043
18111=7043
18112=7043
18113=7086
18114=7107
18115=7043
18116=7012
18117=7028
18118=7087
18119=7009
18120=7006
18121=7006
18125=7010
18126=7009
18127=7043
18128=7043
18129=7018
18130=7085
18131=7088
18132=7088
18133=7088
18134=7088
18135=7085
18136=7085
18137=7085
18138=7085
18139=7085
18140=7089
18141=7028
18142=7043
18143=7043
18144=7043
18145=7086
18146=7006
18147=7006
18148=7006
18149=7006
18150=7006
18151=7006
18152=7012
18153=7006
18154=7006
18155=7006
18156=7012
18157=7006
18170=7090
18171=7090
18172=7090
18180=7085
18181=7009
18200=7099
18201=7125
18202=7099
18203=7107
18204=7107
18205=7125
18206=7099
18207=7107
18208=7107
18209=7125
18210=7107
18211=7107
18212=7099
18213=7107
18214=7107
18215=7107
18216=7125
18217=7107
18218=7107
18219=7107
18220=7107
18221=7107
18222=7107
18223=7107
18224=7006
18225=7107
18226=7107
18227=7107
18228=7107
18229=7107
18230=7107
18231=7107
18232=7107
18233=7107
18234=7107
18235=7107
18236=7107
18237=7107
18238=7107
18239=7107
18240=7107
18241=7107
18242=7107
18243=7107
18244=7107
18245=7107
18246=7107
18247=7107
18248=7107
18249=7107
18250=7107
18251=7107
18252=7107
18253=7107
18254=7107
18255=7107
18256=7107
18560=7097
19100=7120
19101=7120
19102=7120
19103=7120
19104=7120
19105=7120
19106=7120
19107=7120
19110=7009
19111=7010
19112=7009
19113=7010
19120=7027
19121=7120
19122=7120
19123=7042
19150=7027
19151=7027
19152=7012
19153=7012
20100=7035
20101=7003
20102=7003
20103=7003
20151=7003
20152=7003
20161=7003
20162=7003
30100=7062
30101=7062
30102=7062
30103=7062
30104=7027
30105=7022
30106=7022
30107=7063
30108=7010
30109=7011
30110=7010
30112=7064
30115=7065
30116=7065
30117=7065
30118=7022
30119=7022
30120=7027
30200=7062
30201=7022
30202=7022
31100=7058
31101=7058
31102=7058
31103=7060
31104=7059
31105=7059
31106=7059
31107=7058
31108=7058
31109=7059
31110=7059
31115=7046
31120=7058
31121=7058
31122=7044
31123=7058
31140=7058
31151=7014
31152=7060
31153=7059
31154=7059
31161=7014
31162=7044
31163=7014
31200=7092
31201=7092
31202=7092
31203=7092
31204=7092
31205=7010
31206=7092
31251=7092
31300=7062
31301=7062
31302=7062
31303=7062
31310=7062
31311=7062
31312=7062
31315=7010
31316=7012
31320=7065
31401=7062
31402=7062
31403=7062
31404=7062
31405=7062
31406=7062
31410=7062
31411=7059
31412=7062
31413=7018
31420=7062
31421=7062
31430=7062
31501=7059
31502=7059
31503=7059
31504=7059
31505=7059
31506=7059
31507=7059
31508=7059
31509=7059
31510=7059
31511=7059
31512=7059
31513=7059
31550=7059
35000=7005
35002=7005
35003=7005
35004=7005
35005=7005
35006=7005
35007=7005
35008=7005
35009=7005
35010=7005
35021=7063
35022=7063
35023=7005
35051=7005
35052=7005
35053=7005
35054=7005
35055=7005
35056=7005
35057=7005
35058=7005
35095=7005
40101=7011
40102=7015
40103=7015
40104=7015
40105=7015
40106=7015
40107=7015
40109=7015
40111=7012
40112=7090
40113=7040
40501=7091
40601=7014
50100=7066
50105=7009
50106=7010
50107=7066
50108=7066
50120=7027
50121=7027
50125=7066
50126=7027
50180=7027
50500=7067
50501=7067
50502=7067
50503=7067
50504=7067
50505=7067
50510=7067
50511=7009
50512=7010
50520=7027
50521=7027
50580=7027
50581=7027
51000=8000
51001=8000
51002=8000
51003=7010
51004=7012
51005=8000
51006=7014
51007=7012
51008=7014
51009=7009
51500=8005
51501=8005
51502=8005
51503=8005
51504=8005
51505=8005
51506=8005
51507=8005
51508=8005
51509=8005
51510=8005
51511=8005
51512=8005
51513=8005
51514=8005
51515=8005
51516=8005
51518=8005
51519=8005
51520=8005
51521=8004
51522=8004
51523=8005
51524=8005
51525=8005
51526=8005
51527=8005
51528=8005
51529=8005
51530=8005
52000=8002
52001=8002
52002=8002
52003=8002
52004=8002
52005=8002
52006=8002
52007=8002
52008=8002
52009=8002
52500=8003
52501=8003
52502=7040
52503=7040
52504=7040
52505=7040
52506=7040
52507=7040
52508=7040
52509=8003
100001=7001
140125=7097
1=7999
2=7999
3=7999
4=7999
5=7999
6=7999
7=7999
8=7999
9=7999
10=7999
11=7999
12=7999
13=7999
14=7999
15=7999
16=7999
17=7999
18=7999
19=7999
20=7999
21=7999
22=7999
23=7999
24=7999
25=7999
26=7999
27=7999
28=7999
29=7999
30=7999
31=7999
32=7999
33=7999
34=7999
35=7999
36=7999
37=7999
38=7999
39=7999
40=7999
41=7999
42=7999
43=7999
44=7999
45=7999
46=7999
47=7999
48=7999
49=7999
50=7999
51=7999
52=7999
53=7999
54=7999
55=7999
56=7999
57=7999
58=7999
59=7999
60=7999
61=7999
62=7999
63=7999
64=7999
65=7999
66=7999
67=7999
68=7999
69=7999
70=7999
71=7999
72=7999
73=7999
74=7999
75=7999
76=7999
77=7999
78=7999
79=7999
80=7999
81=7999
82=7999
83=7999
84=7999
85=7999
86=7999
87=7999
88=7999
89=7999
90=7999
91=7999
92=7999
93=7999
94=7999
95=7999
96=7999
97=7999
98=7999
99=7999
100000=7006
101000=7006
101001=7006
101002=7006
101003=7006
101004=7006
12009=7006
12010=7006
12011=7006
12012=7006
12013=7006
12014=7006
12015=7006
12016=7006
12017=7006
12018=7006
12019=7006
12020=7006
12021=7006
12022=7006
12023=7006
12024=7006
12025=7006
100051=7006
106000=7006
110004=7006
106001=7006
100300=7043
100301=7043
110002=7043
100302=7043
100303=7043
110003=7043
100401=7009
100501=7006
100502=7006
100503=7006
100504=7006
100505=7006
100506=7006
100507=7006
100508=7006
100509=7006
100510=7006
100511=7006
100512=7006
100513=7006
100514=7006
100515=7006
100601=7006
100602=7006
100701=7006
100702=7006
100703=7006
100704=7006
100705=7006
100706=7006
102002=7009
102003=7009
102004=7009
700001=7009
700002=7009
700003=7009
700004=7009
700005=7009
700006=7009
700007=7009
700008=7009
700009=7085
700010=7009
700011=7009
700015=7085
700016=7085
110007=7085
700012=7085
110008=7085
700014=7085
110009=7085
10070=7006
103001=7006
103002=7006
103003=7006
103004=7006
103021=7006
103020=7006
104001=7006
104002=7006
30300=7062
30301=7062
30339=7062
30340=7062
30341=7062
30342=7062
30343=7062
30380=7062
30381=7062
104000=7006
110001=7006
103100 = 7006
103101 = 7006
103102 = 7006
103103 = 7006
103104 = 7006
103105 = 7006
103106 = 7006
103107 = 7006
103108 = 7006
103109 = 7006
103110 = 7006
103111 = 7006
103112 = 7006
103113 = 7006
103114 = 7006
103115 = 7006
103116 = 7006
103117 = 7006
103118 = 7006
103119 = 7006
103120 = 7006
103121 = 7006
103122 = 7006
103123 = 7006
103124 = 7006
103125 = 7006
103126 = 7006
103127 = 7006
103128 = 7006
103129 = 7006
103130 = 7006
103131 = 7006
103132 = 7006
103133 = 7006
103134 = 7006
103135 = 7006
103136 = 7006
103137 = 7006
103138 = 7006
103139 = 7006
103140 = 7006
103141 = 7006
103142 = 7006
103143 = 7006
103144 = 7006
103145 = 7006
103146 = 7006
103147 = 7006
103148 = 7006
103149 = 7006
103150 = 7006
103151 = 7006
103152 = 7006
103153 = 7006
103154 = 7006
103155 = 7006
103156 = 7006
103157 = 7006
103158 = 7006
103159 = 7006
103160 = 7006
103161 = 7006
103162 = 7006
103163 = 7006
103164 = 7006
103165 = 7006
103166 = 7006
103167 = 7006
103168 = 7006
103169 = 7006
103170 = 7006
103171 = 7006
103172 = 7006
103173 = 7006
103174 = 7006
103175 = 7006
103176 = 7006
103177 = 7006
103178 = 7006
103179 = 7006
103180 = 7006
103181 = 7006
103182 = 7006
103183 = 7006
103184 = 7006
103185 = 7006
103186 = 7006
103187 = 7006
103188 = 7006
103189 = 7006
103190 = 7006
103191 = 7006
103192 = 7006
103193 = 7006
103194 = 7006
103195 = 7006
103196 = 7006
103197 = 7006
103198 = 7006
103199 = 7006
103200 = 7006
103201 = 7006
103202 = 7006
103203 = 7006
103204 = 7006
103205 = 7006
103206 = 7006
103207 = 7006
103208 = 7006
103209 = 7006
103210 = 7006
103211 = 7006
103212 = 7006
103213 = 7006
103214 = 7006
103300 = 7006
103301 = 7006
103302 = 7006
103303 = 7006
103304 = 7006
103305 = 7006
103306 = 7006
103307 = 7006
103308 = 7006
103309 = 7006
103310 = 7006
103311 = 7006
103312 = 7006
103313 = 7006
103314 = 7006
103315 = 7006
103316 = 7006
103317 = 7006
103318 = 7006
103319 = 7006
103320 = 7006
103321 = 7006
103322 = 7006
103323 = 7006
103324 = 7006
103325 = 7006
103326 = 7006
103327 = 7006
103328 = 7006
103329 = 7006
103330 = 7006
103331 = 7006
103332 = 7006
103333 = 7006
103334 = 7006
103335 = 7006
103336 = 7006
103337 = 7006
103338 = 7006
103339 = 7006
103340 = 7006
103341 = 7006
103342 = 7006
103343 = 7006
103344 = 7006
103345 = 7006
103346 = 7006
103347 = 7006
103348 = 7006
103349 = 7006
103350 = 7006
103351 = 7006
103352 = 7006
103353 = 7006
103354 = 7006
103355 = 7006
103356 = 7006
103357 = 7006
103358 = 7006
103359 = 7006
103360 = 7006
103361 = 7006
103362 = 7006
103363 = 7006
103364 = 7006
103365 = 7006
103366 = 7006
103367 = 7006
103368 = 7006
103369 = 7006
103370 = 7006
103371 = 7006
103372 = 7006
103373 = 7006
103374 = 7006
103375 = 7006
103376 = 7006
103377 = 7006
103378 = 7006
103379 = 7006
103380 = 7006
103381 = 7006
103382 = 7006
103383 = 7006
103384 = 7006
103385 = 7006
103386 = 7006
103387 = 7006
103388 = 7006
103389 = 7006
103390 = 7006
103391 = 7006
103392 = 7006
103393 = 7006
103394 = 7006
103395 = 7006
103396 = 7006
103397 = 7006
103398 = 7006
103399 = 7006
103400 = 7006
103401 = 7006
103402 = 7006
103403 = 7006
103404 = 7006
103405 = 7006
103406 = 7006
103407 = 7006
103408 = 7006
103409 = 7006
103410 = 7006
103411 = 7006
103412 = 7006
103413 = 7006
103414 = 7006
103500 = 7006
110020 = 7006
110021 = 7006
110022 = 7006
110023 = 7006
110024 = 7006
110025 = 7006
200000 = 7006
200001 = 7006
200002 = 7006
700100 = 7012
700101 = 7012
800000 = 7085
800001 = 7085
800002 = 7085
800003 = 7085
800004 = 7085
800005 = 7085
800006 = 7085
800007 = 7085
800008 = 7085
800009 = 7085
800010 = 7085
800011 = 7085
800012 = 7085
800013 = 7085
800014 = 7085
800015 = 7085
800016 = 7085
800017 = 7085
800018 = 7085
800019 = 7085
800020 = 7085
800021 = 7085
800022 = 7085
800023 = 7085
800024 = 7085
800050 = 7085
800051 = 7085
800052 = 7085
700201 = 7025
700202 = 7025
700203 = 7025
700204 = 7025
700250 = 7025
700261 = 7025
700262 = 7025
700263 = 7025
700264 = 7025
700301 = 7043
700302 = 7043
700303 = 7043
700304 = 7043
700305 = 7043
700306 = 7043
700307 = 7043
700308 = 7043
700309 = 7043
700310 = 7043
700311 = 7043
700312 = 7043
700313 = 7043
700314 = 7043
700315 = 7043
700316 = 7043
700317 = 7043
700318 = 7043
700319 = 7043
700320 = 7043
700321 = 7043
700322 = 7043
700323 = 7043
700324 = 7043
100350 = 7006
106002 = 7006
106003 = 7006
106004 = 7006
110005 = 7006
106005 = 7006
106006 = 7006
106007 = 7006
106008 = 7006
106009 = 7006
107001 = 7006
107002 = 7006
107003 = 7006
107004 = 7006
107005 = 7006
107006 = 7006
106010 = 7006
106011 = 7006
106012 = 7006
510000 = 7006
510001 = 7006
510002 = 7006
110000 = 7006
600000 = 7006
600001 = 7006
600002 = 7006
600003 = 7006
600004 = 7006
600005 = 7006
600006 = 7006
600007 = 7006
600050 = 7002
281570 = 7006
710000 = 7107
710001 = 7107
710002 = 7107
710003 = 7107
700150 = 7058
800100 = 7006
800101 = 7006
800102 = 7006
800200 = 7107
800201 = 7107
800202 = 7107
800203 = 7107
800204 = 7107
800205 = 7107
800300 = 7006
800301 = 7006
800302 = 7006
800303 = 7006
800304 = 7006
800305 = 7039
800306 = 7006
800320 = 7039
800500 = 7006
800501 = 7006
800502 = 7006
800503 = 7006
800504 = 7006
800505 = 7006
102005 = 7009
100052 = 7006
102006 = 7085
110006 = 7085
102007 = 7021
102008 = 7021
102009 = 7021
700013 = 7009
810000 = 7006
810001 = 7006
810002 = 7006
820000 = 7006
820001 = 7006
820002 = 7006
820003 = 7006
820004 = 7006
820005 = 7006
820006 = 7006
820007 = 7006
7728 = 7014
5740 = 7013
7726 = 7002
18257 = 7006

# Hostame regex: (?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?
[0001 - Physical Root Login]
event_type=event
#precheck="Physical root login"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>Physical root login.)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>[^\[]*\[\d+\]:\s(?P<user>\S+) LOGIN[^\']*\'(?P<tty>\S+)\')\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$tty}
userdata3={$rule_comment}
userdata4={$rule_group}


[0002 - System User Successfully Logged]
event_type=event
#precheck="System user successfully logged"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>System user successfully logged to the system.)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$username}
userdata1={$location}
userdata3={$rule_comment}
userdata4={$rule_group}


[0003 - AVAPI - PAM Login Success]
event_type=event
#precheck="Login session opened"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>(?:Login session opened|Successful login during non-business hours).)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?session opened for user (?P<user>avapi|avserver|www\-data) by .*?)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
plugin_sid={translate2($rule_id,$avapi-sids)}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$srcip}

[0003-b - AVAPI - PAM Login Success]
event_type=event
#precheck="Login session opened"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>(?:Login session opened|Successful login during non-business hours).)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?session opened for user (?P<user>\S+) by (?P<by>avapi|avserver|www\-data))"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
plugin_sid={translate2($rule_id,$avapi-sids)}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$srcip}


[0004 - PAM Login Success]
event_type=event
#precheck="session opened for user"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:any|(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*))))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?session opened for user (?P<user>(?!avapi|avserver|www\-data)\S+) by (?P<by>(?!avapi|avserver|www\-data)).*?)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$rule_level}
userdata5={$srcip}


[0005 - PAM Login Failure]
event_type=event
#precheck="User login failed"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>(?:User login failed|Failed to switch user)\.)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\]([^\"]+rhost=(?P<rhost>\S+)\s*)?(?P<log>.*?(?:ruser=(?P<ruser>\S*)\s.*?)?user=(?P<user>\S+))?\[END\]";"
date={normalize_date($date)}
device={$hostname}
src_ip={$rhost}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$ruser}


[0006 - AVAPI - PAM Login closed]
event_type=event
#precheck="Login session closed"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>Login session closed.)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?session closed for user (?P<user>avapi|avserver|www\-data).*?)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
plugin_sid={translate2($rule_id,$avapi-sids)}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$srcip}
userdata5={$rule_level}


[0007 - PAM Login closed]
event_type=event
#precheck="Login session closed"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>Login session closed.)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:any|(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*))))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?session closed for user (?P<user>(?!avapi|avserver|www\-data)\S+).*?)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$srcip}
userdata5={$rule_level}


[0008 - AVAPI - SSH Authentication Success / SSH Multiple authentication failures followed by a success]
event_type=event
#precheck="Accepted"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?Accepted (password|publickey) for (?P<user>avapi|avserver|www\-data) from (?P<srcip2>\S+) port (?P<userport>\d+).*?)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
src_port={$userport}
plugin_sid={translate2($rule_id,$avapi-sids)}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$srcip2}
userdata3={$rule_comment}
userdata4={$rule_group}


[0009 - SSH Authentication Success / SSH Multiple authentication failures followed by a success]
event_type=event
#precheck="Accepted"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?:any|(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}|(?:[^-\s]+))|(?:[^)\s"]*))))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?Accepted (password|publickey|keyboard-interactive/pam) for (?P<user>(?!avapi|avserver|www\-data)\S+) from (?P<srcip2>\S+) port (?P<userport>\d+).*?)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$srcip}
dst_ip={$hostname}
src_port={$userport}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$srcip2}
userdata3={$rule_comment}
userdata4={$rule_group}


[0010 - SSH ilegal user]
event_type=event
#precheck="Failed unknown for illegal user"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>Attempt to login using a non-existent user)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\]\w{3}\s\d{1,2}\s\d{1,2}:\d{1,2}:\d{1,2}\s\S+\ssshd\[\d+\]:\sFailed unknown for illegal user (?P<user>\S+) from (?P<srcip2>\S+) port (?P<userport>\d+) ssh2\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$srcip}
dst_ip={$hostname}
src_port={$userport}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$srcip2}
userdata3={$rule_comment}
userdata4={$rule_group}

[0011 - SSH failed login attempts - user, no rhost]
event_type=event
#precheck="SYSTEM_MSG"
regexp="^AV - Alert - \"(?P<date>\d+)\" --> RID: "(?P<rule_id>250\d)"; RL: "\d+"; RG: "(?P<rule_group>syslog,access_control,authentication_failed,)"; RC: \"(?P<rule_comment>[^\"]*)"; USER: \"(?:\S+)\"; SRCIP: \"(?P<ip>[^\"]*)\"; HOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?"; LOCATION: \"(?P<location>[^\"]*)\"; EVENT: "\[INIT\].*?for\s+user\s+(?P<user>\S+)\s+from\s+(?P<src_ip>\S+)\s+\-\s+(?P<service>\S+)\[\d+\]\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$src_ip}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$rule_comment}
userdata2={$rule_group}
userdata3={$service}
userdata4={$ip}
userdata5={$location}


[0012 - (AIX) - SSH failed login attempts (2501|40111)]
event_type=event
#precheck="syslog,access_control,authentication_failed"
regexp="^AV - Alert - \"(?P<date>\d+)\" --> RID: "(?P<rule_id>2501|40111)"; RL: "\d+"; RG: "(?P<rule_group>syslog,[^"]*)"; RC: \"(?P<rule_comment>[^\"]*)"; USER: \"(?P<username>\S+)\"; SRCIP: \"(?P<src_ip>[^\"]*)\"; HOSTNAME: "[^;]*; LOCATION: \"(?P<location>[^\"]*)\"; EVENT: "\[INIT\].*?Message forwarded from (?P<hostname>\S+): syslog: ssh: failed login attempt for [^[]*\[END\]";"
date={normalize_date($date)}
device={$hostname}
src_ip={$src_ip}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$username}
userdata1={$rule_comment}
userdata2={$rule_group}
userdata3={$location}


[0013 - SSH failed login attempts]
event_type=event
#precheck="syslog,access_control,authentication_failed"
regexp="^AV - Alert - \"(?P<date>\d+)\" --> RID: "(?P<rule_id>250\d)"; RL: "\d+"; RG: "(?P<rule_group>syslog,access_control,authentication_failed,)"; RC: \"(?P<rule_comment>[^\"]*)"; USER: \"(?P<username>\S+)\"; SRCIP: \"(?P<srcip>[^\"]*)\"; HOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?"; LOCATION: \"(?P<location>[^\"]*)\"; EVENT: "\[INIT\]([^\"]+rhost=(?P<rhost>\S+)(?: user=(?P<user>\S+))?)?([^\"]+)?\[END\]";"
date={normalize_date($date)}
device={$hostname}
src_ip={$rhost}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$rule_comment}
userdata2={$rule_group}
userdata3={$location}

[0014-a - SSHD brute force trying to get access to the system (5712)]
event_type=event
regexp="^AV - Alert - \"(?P<date>\d+)\" --> RID: "(?P<rule_id>5712)"; RL: "\d+"; RG: "(?P<rule_group>syslog,sshd,authentication_failures,)"; RC: \"(?P<rule_comment>[^\"]*)"; USER: \"(?P<username>\S+)\"; SRCIP: \"(?P<ip>[^\"]*)\"; HOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?"; LOCATION: \"(?P<location>[^\"]*)\"; EVENT: "\[INIT\]\S+\s+\d+\s+\d+:\d+:\d+\s\S+\s+\S+\[\d+\]:\s+(?:\[ID\s+\d+\s+\S+\]\s+)?(?P<desc>Failed \S+ for \S+ user)\s+(?P<user>\S+) from (?P<src_ip>\S+) port (?P<src_port>\d+)\s+\S+\[END\]";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$src_ip}
dst_ip={$hostname}
src_port={$src_port}
username={$user}
userdata1={$rule_group}
userdata2={$rule_comment}
userdata3={$location}
userdata4={$desc}


[0014-b - SSH Authentication Failed]
event_type=event
#precheck="Failed password for"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?::+\w+:)?(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?(?:Failed (?:keyboard-interactive(?:/pam)?|password|none) for (?:invalid\s*user\s*)?|Invalid user\s*)(?:<invalid username>|(?P<user>\S+)?) from (?::+\w+:)?(?P<srcip2>\S+)(?: port (?P<userport>\d+).*?)?)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$srcip}
dst_ip={$hostname}
src_port={$userport}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$srcip2}
userdata3={$rule_comment}
userdata4={$rule_group}


[0015 - SSH Rest of events]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>5706|5740)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s\"(?:(?:\((?P<agent_name>[^\)]*)\)\s+)?(?:\S+@)?(?P<hostname>(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}|\S+)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?:(?P<date_event>\w+\s+\d+\s+\d+:\d+:\d+)\s*(?P<device>\d+\.\d+\.\d+\.\d+|\S+))?(?:.*?from (?P<fromip>\S+))?(?: port (?P<srcport>\d+))?(?:[^"]+)?\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$srcip}
dst_ip={$hostname}
src_port={$srcport}
username={$username}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$rule_level}


[0016 - OSSEC Agent Disconnected with IP]
event_type=event
#precheck="disconnected"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^\s"]+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:[^\s"]+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>(?:(?!disconnected)\S+\s+)+disconnected):\s+.(?P<hostname1>.*?)\-(?!0\.0\.0\.0)(?P<hostip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})...*?\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostip}
userdata1={$hostname1}
userdata4={$rule_comment}
userdata5={$rule_group}

[0016-b - OSSEC Agent Disconnected without IP]
event_type=event
#precheck="disconnected"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?disconnected):\s+.(?P<hostname1>\S+)\-(?P<hostip>\S+)...*?\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname1}
userdata1={$hostname1}
userdata4={$rule_comment}
userdata5={$rule_group}


[0017 - Apache - Authentication failed]
event_type=event
#precheck="User authentication failed"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>apache[^\"]*)\";\sRC:\s\"(?P<rule_comment>User authentication failed.)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?client\s+(?P<sip_event>[^\]]*)\]\suser (?P<event_user>.*?):.*?for (?P<path>.*?):.*?)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$srcip}
username={$username}
userdata1={$rule_comment}
userdata2="http://{$event_user}{$path}"


[0018 - File Added to system]
event_type=event
#precheck="New file"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>5(54|98))\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:.*?->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>New file \'(?P<filename>[^\']*)\'.*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$username}
filename={$filename}


[0019 - Integrity checksum changed]
event_type=event
#precheck="Integrity checksum changed"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>(?:(?:55[012])|(?:59[456])))\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s"]*))).*?LOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>Integrity checksum changed for: '(?P<filename>[^\']*)'(?:\\[n]Size changed from '(?P<size_old>\d+)' to '(?P<size_new>\d+)')?(?:\\[n]Permissions changed from '(?P<permission_from>[^']+)' to '(?P<permission_to>[^']+)')?(?:\\[n]Old md5sum was: '(?P<md5_old>[^']+)'[^\']*'(?P<md5_new>[^']+)'[^\']*'(?P<sha1_old>[^']+)'[^\']*'(?P<sha1_new>[^']+)')?(?:\\[n]What changed:\\[n][^\\]+\\[n][<>]\s+(?P<new_changed>.*?)(?:\\[n]---\\[n<>]+\s*(?P<old_changed>.*))?|.*)?)(?:More changes\.+)?\[END\]";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$username}
filename={$filename}
userdata2="New md5sum: {$md5_new}"
userdata3="Old md5sum: {$md5_old}"
userdata4="New sha1sum: {$sha1_new}"
userdata5="Old sha1sum: {$sha1_old}"
userdata6="Old size: {$size_old}"
userdata7="New size: {$size_new}"
userdata8={$new_changed}
userdata9={$old_changed}


[0020 - Postfix logs]
event_type=event
#precheck="33"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>33\d{2})\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}


[0021 - Syslog errors]
event_type=event
#precheck="100"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>100\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}


[0022 - Ossec started]
event_type=event
#precheck="502"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>502|503)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:.*?->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}


[0023 - Ossec agent connected]
event_type=event
#precheck="50"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>50\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:any|(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*))))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$agent_name}


[0024 - User successfully changed UID to root or failed(5301/5303/5304/40111)]
event_type=event
#precheck="530"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>530[1234]|40111)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?su\[\d+\]: [+-] (?P<tty>.*?) .*?(?::(?P<ruser>[^]]+))?\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}
userdata1={$location}
userdata2={$tty}
userdata3={$rule_comment}
userdata4={$rule_group}
userdata5={$ruser}


[0025 - AVAPI - Successful sudo to ROOT executed]
event_type=event
#precheck="5402"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>5402)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?sudo:\s+(?P<user>avapi|avserver|www\-data) : TTY.*?PWD=(?P<pwd>\S+).*?COMMAND=(?P<command>.*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid=1005402
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$user}
userdata1={$username}
userdata2={$pwd}
userdata3={$command}


[0026 - Successful sudo to ROOT executed]
event_type=event
#precheck="sudo:"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>540\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?sudo:\s*(?P<cmd_user>(?!avapi|avserver|www\-data)\S+) : TTY.*?PWD=(?P<pwd>\S+).*?COMMAND=(?P<command>.*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$cmd_user}
userdata1={$username}
userdata2={$pwd}
userdata3={$command}


[0027 - Excessive number of events]
event_type=event
#precheck="Excessive number of events"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>11)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>Excessive number of events \(above normal\).)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*? reached (?P<nevents>\d+)).\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$username}
userdata1={$log}
userdata2={$nevents}


[0028 - Apache - Web Server 500]
event_type=event
#precheck="Web server 500 error"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>web,accesslog[^\"]*)\";\sRC:\s\"(?P<rule_comment>Web server 500 error code[^\"]+)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?GET (?P<url1>[^\"]+).*?500 (?P<code>\d+) \"(?P<url2>[^\"]+).*\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$srcip}
username={$username}
userdata1={$rule_comment}
userdata2={$url1}
userdata3={$url2}
userdata4={$code}


[0029 - Samba Network Problems]
event_type=event
#precheck="Samba network problems"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>13105)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>([^\"]+)?Samba network problems[^\"]+)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\]\w{3}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}\s+(?:any|(?P<srchost>\S+))\s+smbd.*\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srchost}


[0030 - Apache - group - 30xxx]
event_type=event
#precheck="apache"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>30\d\d\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>apache[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]+)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<request>.*?(?:error|notice|warn)\]\s+(?:\[pid \d+\]\s+)?(?:\[client \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}:(?P<src_port>\d+))?(?:.*?(?:(?:Failed opening required '|matching request: |server configuration: |pid file |coredump in |Command line: ')(?P<filename>/[^'\s[]*).*)|.*))\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$srcip}
src_port={$src_port}
username={$username}
filename={$filename}
userdata1={$rule_comment}
userdata2={$rule_level}
userdata3={$rule_group}


[0031 - Web - group - 31xxx and 700150]
event_type=event
#precheck="web"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>3110\d|700150)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>web,accesslog,(?:attack,)?)\";\sRC:\s\"(?P<rule_comment>[^\"]+)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->[^\;]*)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?(?P<method>GET|POST|HEAD|PUT|DELETE|TRACE|CONNECT|OPTIONS)\s+(?P<resource>https?://[^\s/]+|\S+)\S*\s+\S+\s+(?P<http_code>\d+).*\[END\]"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$srcip}
dst_ip={$hostname}
username={$username}
userdata1={$rule_comment}
userdata2={$rule_level}
userdata3={$rule_group}
userdata4={$location}
userdata5={$method}
userdata6={$resource}
userdata7={$http_code}


[0032-a - SSH Multiple Authentication Failures - 40111 1a.Host and User]
event_type=event
#precheck="40111"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>40111)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?rhost=(?P<rhost>\S+)\s+user=(?P<ruser>\S+).*\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$rhost}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$ruser}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}

[0032-b - SSH Multiple Authentication Failures - 40111 1b.RHost and no user]
event_type=event
#precheck="40111"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>40111)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s\"(?:\((?P<agent_name>[^\)]*)\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?rhost=(?P<rhost>\S+)\s*\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$rhost}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}

[0032-c - SSH Multiple Authentication Failures - 40111 1c]
event_type=event
#precheck="40111"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>40111)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s\"(?:\((?P<agent_name>[^\)]*)\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?FAILED\sLOGIN\s(?P<attempts>\d+)\sFROM\s(?P<rhost>\S+)\sFOR\s(?P<user>[^,]+)?,\s(?P<reason>[^\[]+)\s*\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$rhost}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$agent_name}
userdata5={$attempts}
userdata6={$reason}


[0033-a - SSH Multiple Authentication Failures - 40111 2.No host nor user without dst]
event_type=event
#precheck="40111"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>40111)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?:[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?:.*?device_id=(?P<dev_id>\S+)\s+log_id(?P<log_id>\S+)\s+type=(?P<type>\S+)\s+pri=(?P<pri>\S+)\s+session_id="(?P<session>[^"]+)")?.*?(?:(?:via[^\[]*|client_name="(?P<host>[^\s]+))\s*\[(?P<srcip>[^\]]*)\](?:[^"]+"\s+dst_ip=""|:(?P<srcport>\d+)->\[\]))(?:.*?authtype=(?P<auth_type>\S+),\s+detail=(?P<detail>[^"]+))?.*\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$srcip}
src_port={resolv_port($srcport)}
dst_ip={$srcip}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$username}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$dev_id}
userdata5={$log_id}
userdata6={$type}
userdata7={$pri}
userdata8={$host}
userdata9={$detail}

[0033-b - SSH Multiple Authentication Failures - 40111 2.No host nor user with dst]
event_type=event
#precheck="40111"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>40111)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?:[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?:.*?device_id=(?P<dev_id>\S+)\s+log_id(?P<log_id>\S+)\s+type=(?P<type>\S+)\s+pri=(?P<pri>\S+)\s+session_id="(?P<session>[^"]+)")?.*?(?:(?:via[^\[]*|client_name="(?P<host>[^\s]+))\s*\[(?P<srcip>[^\]]*)\](?::(?P<srcport>\d+)->\[|[^"]+"\s+dst_ip=")(?P<dstip>[^\]"]+)\]?)(?:.*?authtype=(?P<auth_type>\S+),\s+detail=(?P<detail>[^"]+))?.*\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$srcip}
src_port={resolv_port($srcport)}
dst_ip={$dstip}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$username}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$dev_id}
userdata5={$log_id}
userdata6={$type}
userdata7={$pri}
userdata8={$host}
userdata9={$detail}


[0034 - SSH Multiple Authentication Failures - 40111 3.Nombre and Cliente]
event_type=event
#precheck="40111"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>40111)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?Nombre\sde\susuario:\s+(?P<rusername>.*?)\s+Id.*?cliente:\s(?P<rhost>\S+).*\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$rhost}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$rusername}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}


[0035 - OSSEC log operation]
event_type=event
#precheck="59"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>59\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\][^\']*\'(?P<logfile>\S+)\'.*\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}
userdata1={$logfile}
userdata2={$rule_comment}
userdata3={$rule_group}


[0036 - OSSEC rules with host info]
event_type=event
#precheck="host"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>5\d\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]+)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]+)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]+)\";\sEVENT:\s\"\[INIT\].*?host\s+(?P<host1>\S+)\s+host\s+(?P<host2>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host1}
dst_ip={$host2}
username={$username}
userdata1={$rule_comment}
userdata2={$rule_group}


[0037 - OSSEC rules]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>5\d\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]+)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]+)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]+)\";\sEVENT:\s\"\[INIT\].*?'(?P<filename>[^']+)'.*?\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}
filename={$filename}
userdata1={$rule_comment}
userdata2={$rule_group}


[0038 - OSSEC debian pkg]
event_type=event
#precheck="29"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>29\d\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?(install|installed|remove|purge) (?P<pkg>\S+) (?P<version>\S+).*\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}
userdata1={$pkg}
userdata2={$version}


[0039 - OSSEC linux kernel messages]
event_type=event
#precheck="51"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>51\d\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}


[0040 - PAM User password changed]
event_type=event
#precheck="5555"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>5555)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?password changed for (?P<user>\S+).*)\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$srcip}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}


[0041 - OSSEC syscheck]
event_type=event
#precheck="syscheck"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>.*?syscheck[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$username}
userdata1={$log}


[0042 - IDS event]
event_type=event
#precheck="IDS"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]+)\";\sRC:\s\"(?P<rule_comment>IDS event\.)\";\sUSER:\s\"(?:None|(?P<username>[^\"]+))\";\sSRCIP:\s\"(?P<srcip>[^\"]+)\";\sHOSTNAME:\s\"\(?(?P<hostname>[^\"]*).*?Classification:\s(?P<class>[^\]]+).*?(?P=srcip):(?P<srcport>\S+)\s+->\s+(?P<dstip>[^:]+):(?P<dstport>\d+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
username={$username}
userdata1={$class}
userdata2={$rule_level}
userdata3={$rule_group}


[0043 - IDS event (hostname)]
event_type=event
#precheck="IDS event"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]+)\";\sRC:\s\"(?P<rule_comment>IDS event\.)\";\sUSER:\s\"(?:None|(?P<username>[^\"]+))\";\sSRCIP:\s\"(?P<srcip>[^\"]+)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"(?P<event>[^\"]+)\".*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}
userdata1={$location}
userdata2={$rule_level}
userdata3={$rule_group}
userdata4={$event}


[0044 - New user event]
event_type=event
#precheck="5902"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>5902)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:\S+)\";\sSRCIP:\s\"(?:[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?\";\s+LOCATION\:\s\"(?P<location>[^"]*)\"\;.*?name=(?P<username>\w+).*\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}
userdata1={$location}
userdata2={$rule_level}
userdata3={$rule_group}


[0045 - Multiple PAM Login Failure]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>Multiple failed logins in a small period of time.)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?:[^\"]+rhost=(?P<rhost>\S+))?(?P<log>.*?user=(?P<user>\S+).*?)?\s*\[END\]";"
date={normalize_date($date)}
device={$hostname}
src_ip={$rhost}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}


[0046 - Multiple PAM Login Failure NoAgent]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>Multiple failed logins in a small period of time.)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"\((?P<hostname>[^\)]*)\)\s+(?P<host_ip>[^-]*)->\S+";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\][^\"]+rhost=(?P<rhost>\S+).*?(?:\suser=(?P<user>\S+))?.*\[END\]";"
date={normalize_date($date)}
device={$hostname}
src_ip={$rhost}
dst_ip={$host_ip}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}


[0047 - OSSEC yum pkg]
event_type=event
#precheck="29"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>29\d\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?Installed:\s(?P<pkg>[^\[]*)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
username={$username}
userdata1={$pkg}

[0048 - SSH Authentication Failed]
event_type=event
#precheck="Failed password for"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*?Authentication\sfailure\sfor\s(?P<user>\S+)\sfrom\s(?P<srcip2>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}))\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$srcip}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={$user}
userdata1={$location}
userdata2={$srcip2}
userdata3={$rule_comment}
userdata4={$rule_group}

[0049 - PAM tally2]
event_type=event
#precheck="Failed password for"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>700100)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^"]*)\";\sUSER:\s+\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?P<srcip>[^"]*)\"\;\sHOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<dvc_ip>[^\s\-"]+)[^;]*;\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\]\w+\s+\d+\s+\d+:\d+:\d+\s+(?P<dst_hostname>\S+)\s+\S+:\s+pam_tally2\S+:\s+user\s+\S+\s\((?P<uid>\d+)\)\s+tally\s+(?P<tally>\d+),\s+deny\s+(?P<deny>\d+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$dst_hostname}
src_ip={$dst_hostname}
dst_ip={$dst_hostname}
username={$username}
userdata1={$location}
userdata2={$rule_level}
userdata3={$rule_comment}
userdata4={$rule_group}
userdata5={$uid}
userdata6={$tally}
userdata7={$deny}

[0050 - Linux USB (7002~~)]
event_type=event
#precheck="usb"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>7002\d{2})\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^"]*)\";\sUSER:\s+\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?P<srcip>[^"]*)\"\;\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\].*?(?:sd |usb(?:-storage)? |Mounted )(?P<device>/\S+|\S+\d):?\s+(?:new high-speed )?(?:at\s+(?P<filename>\S+)\s+on behalf of uid\s+(?P<uid>\d+)|USB.*? device number\s+(?P<dvc_id>\d+)(?:\s+using (?P<mode>[^[]+))?|New USB device found, idVendor=(?P<vendor_id>\S+),\s+idProduct=(?P<prod_id>[^[]+)|\[\w+\]\s+(?:Mode Sense:\s+)?(?P<usb_data>[^:[]+)|USB.*)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
filename={$filename}
userdata1={$location}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$dvc_id}
userdata5={$mode}
userdata6={$vendor_id}
userdata7={$prod_id}
userdata8={$usb_data}
userdata9={$uid}

######################################################
# MSSQL WINDOWS EVENTS
######################################################

[0051 - Microsoft MSSQL - LOGIN FAILED - FAILURE (with client ip)]
event_type=event
#precheck="103354"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>103354)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>windows,mssql,)\";\sRC:\s\"(?P<rule_comment>MSSQL[^\.\"]*)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<dst_ip>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\]\d+\s\w+\s\d+\s\d+:\d+:\d+\sWinEvtLog:\sApplication: AUDIT_FAILURE\((?P<event_id>\d+)\).*?MSSQL(?:[^:]+)?:\s*[^:]*:\s*(?:no domain:\s(?P<domain>[^:]*)):\sAudit event: event_time:\S+\s\S+\ssequence_number:\d\saction_id:(?P<action_id>LGIF\ssucceeded:false)\spermission_bitmask:\d\sis_column_permission:\S+\ssession_id:\d+\sserver_principal_id:\d+\sdatabase_principal_id:\d+\starget_server_principal_id:\d\starget_database_principal_id:\d+\sobject_id:\d+\sclass_type:\S+\ssession_server_principal_name:.*?\sserver_principal_name:(?P<server_name>\S+)?\sserver_principal_sid.*?server_instance_name:(?P<server_instance_name>\S+)\s.*?statement:(?:--|(?P<desc>[^\.]+))\.?\s(?:Reason:\s(?P<reason>[^\.]+)\.\s)?.*?\[CLIENT:\s(?P<client_ip>[^\]]+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$dst_ip}
src_ip={$client_ip}
dst_ip={$dst_ip}
username={$server_name}
userdata1={$action_id}
userdata2={$event_id}
userdata3={$domain}
userdata4={$hostname}
userdata5={$server_instance_name}
userdata6={$reason}


[0052 - Microsoft MSSQL - LOGIN SUCCEEDED / LOGOUT - SUCCESS (103155|103160) (without client ip)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>1031(?:55|60))\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>windows,mssql,)\";\sRC:\s\"(?P<rule_comment>MSSQL[^\"\.]*)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<dst_ip>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?AUDIT_SUCCESS\((?P<event_id>\d+)\).*?MSSQL(?:[^:]+)?:\s*[^:]*:\s*(?:no domain:\s(?P<domain>[^:]*)):\s.*?action_id:(?P<action_id>(?:LGIS|LGO))\s+(?P<status>succeeded:true).*?\sserver_principal_name:(?:[^\\]+\\)?(?P<server_name>\S+)\s.*?server_instance_name:(?P<server_instance_name>\S+)\s.*?statement:(?:--|(?P<statement>\S+(?:(?!\sadditional_information)\s+\S+)*)?)\s*(?:network protocol:\s(?P<proto>TCP|UDP|HTTP|[^\s/]+))?"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$dst_ip}
src_ip={$srcip}
dst_ip={$dst_ip}
protocol={$proto}
username={$server_name}
userdata1={$hostname}
userdata2={$event_id}
userdata3={$domain}
userdata4={$action_id}
userdata5={$server_instance_name}
userdata6={$statement}

[0053 - SQL injection attempt]
event_type=event
#precheck="SQL injection attempt"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+"(?P<rule_comment>SQL injection attempt.)\";\sUSER:\s+\"(?:None|(?P<username>[^"]+))\";\sSRCIP:\s\"(?P<src_ip>[^"]*)\"\;\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<dst_ip>\S+)->[^"]*)?\";\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\].*?(?P<method>GET|POST|HEAD|PUT|DELETE|TRACE|CONNECT|OPTIONS)\s+(?P<resource>https?://[^\s/]+|\S+)\S*\s+\S+\s+(?P<http_code>\d+).*\[END\]"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$src_ip}
dst_ip={$hostname}
username={$username}
userdata1={$rule_comment}
userdata2={$rule_level}
userdata3={$rule_group}
userdata4={$location}
userdata5={$method}
userdata6={$resource}
userdata7={$http_code}

## MSSQL DB EVENTS: 103130, 103134, 103147, 103184, 103189, 103207, 103500
[0054 - MSSQL DB Alerts - MSSQL - ACTION - SUCCESS ]
event_type=event
#precheck="MSSQL"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>1031(?:30|34|47|84|89)|103207)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>windows,mssql,)\";\sRC:\s\"(?P<rule_comment>MSSQL[^\.\"]*)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\]\d+\s\w+\s\d+\s\d+:\d+:\d+\sWinEvtLog:\sApplication: AUDIT_SUCCESS\((?P<event_id>\d+)\).*?MSSQL(?:[^:]+)?:\s*[^:]*:\s*(?:no domain:\s(?P<domain>[^:]*)):\s.*?action_id:(?P<action_id>\S+)\s+(?P<status>succeeded:true).*?\sserver_principal_name:(?:[^\\]+\\\\?)?(?P<server_name>\S+)\s.*?server_instance_name:(?P<server_instance_name>\S+)\s+database_name:(?P<db_name>\S*)\s+schema_name:(?P<schema>\S+)\s+object_name:(?P<object_name>\S*)\s+statement:(?P<statetment>\S+(?:(?!\sadditional_information)\s+\S+)*)?"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
username={$server_name}
userdata1={$action_id}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$rule_level}
userdata5={$domain}
userdata6={$server_instance_name}
userdata7={$db_name}
userdata8={$object_name}
userdata9={$schema}

[0055 - MSSQL - Database Backup Log (103002)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>103002)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>windows,mssql,)\";\sRC:\s\"(?P<rule_comment>Transaction log backup was completed successfully)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?INFORMATION\((?P<event_id>\d+)\).*?MSSQL(?:SERVER|[^:]+)\:\s+(?P<server>.*?)\:\s+(?P<domain>.*?)\:\s+(?P<application>.*?)\:.*?Database:\s+(?P<db>[^\,]+)\,\s+creation date\(time\):\s(?P<create_date>[^\,]+)\,\s+first LSN:\s+(?P<first_lsn>[^,]+)\,\s+last LSN:\s(?P<last_lsn>[^\,]+).*?\{'(?P<device_name>[^\']+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
username={$server}
userdata1={$rule_comment}
userdata2={$db}
userdata3={$domain}
userdata4={$create_date}
userdata5={$first_lsn}
userdata6={$last_lsn}
userdata7={$device_name}


[0060 - MSSQL - Database Backup Log (103500)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>103500)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>windows,mssql,)\";\sRC:\s\"(?P<rule_comment>Database backup was completed successfully)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?INFORMATION\((?P<event_id>\d+)\).*?MSSQL(?:SERVER|[^:]*)\:\s+(?P<server>.*?)\:\s+(?P<domain>.*?)\:\s+(?P<application>.*?)\:.*?Database:\s+(?P<db>[^\,]+)\,\s+creation date\(time\):\s(?P<create_date>[^\,]+)\,\s+pages\s+dumped:\s+(?P<pages>\d*),\s+first LSN:\s+(?P<first_lsn>[^,]+)\,\s+last LSN:\s(?P<last_lsn>[^\,]+).*?\{'(?P<device_name>[^\']+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
username={$server}
userdata1={$rule_comment}
userdata2={$db}
userdata3={$domain}
userdata4={$create_date}
userdata5={$pages}
userdata6={$first_lsn}
userdata7={$last_lsn}
userdata8={$device_name}
userdata9={$application}

[0070 - Application - Application Failure (1309|1315)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>80030[1,6])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>application)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?(?:WARNING|INFORMATION)\((?P<event_id>\d+)\):\s+(?P<application>[^:]+):(?:[^:]+:){2}\s+(?P<data>[^:]+):\s+Event\s+code:\s+(?P<ev_code>\d+)\s+Event\s+message:\s+.*?(?:Reason:\s+(?P<reason>[^.]+)\.\s+)?Event\s+time:\s+(?P<date_event>\S+\s+\S+\s+\S+)\s+Event\s+time\s+\S+\s+(?P<uct>\S+\s+\S+\s+\S+)\s+Event\s+ID:\s+(?P<id>\S+)\s+Event\s+sequence:\s+(?P<seq>\d+).*?Application\s+domain:\s+(?P<app_domain>\S+).*?Machine\s+name:\s+(?P<machine>\S+).*?Process\s+name:\s+(?P<process>\S+)\s+Account\s+name:\s+(?P<domain>[^\\]+)\\(?P<name>\S+).*?User\s+host\s+address:\s(?P<src>\d+\.\d+\.\d+\.\d+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$src}
dst_ip={$host}
username={$name}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$event_id}
userdata5={$application}
userdata6={$ev_code}
userdata7={$app_domain}
userdata8={$domain}
userdata9={$machine}

[0071 - Application - Scan detected a security risk ]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>800304)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>application)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?INFORMATION\((?P<event_id>\d+)\):\s+(?P<application>[^:]+):(?:[^:]+:){2}\s+(?P<data>[^:]+):\s+Scan\s+type:\s+(?P<type>\S+(?:(?!\s+\w+:)\s+\S+)*)\s+.*?File:\s+(?P<filename>\S+(?:(?!\s+\w+:)\s+\S+)*)\s+Location:\s+(?P<location_file>\S+((?!\s+\w+:)\s+\S+)*)\s+Computer:\s+(?P<computer>\S+)\s+User:\s+(?P<user>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
filename={$filename}
username={$user}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$event_id}
userdata5={$application}
userdata6={$data}
userdata7={$type}
userdata8={$computer}
userdata9={$location_file}

[0072 - Application - Events (4102|7|1003|1704)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>80030[0,2,3,5])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>application)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?INFORMATION\((?P<event_id>\d+)\):\s+(?P<application>[^:]+):(?:[^:]+:){2}\s+(?P<data>[^:]+):\s+(?:.*?(?:Version:\s+(?P<version>\d+)|Application\s+Id=(?P<application_event>\S+)))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
userdata1={$rule_group}
userdata2={$rule_comment}
userdata3={$hostname}
userdata4={$location}
userdata5={$event_id}
userdata6={$application}
userdata7={$data}
userdata8={$version}
userdata9={$application_event}

[0075 - System - Events (8012|8018)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>80050[3,1])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>system,)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?(?:WARNING|INFORMATION)\((?P<event_id>\d+)\):\s+(?P<application>[^:]+):(?:[^:]+:){2}\s+(?P<data>[^:]+):\s+[^:]+:\s+Adapter\s+Name\s+:\s+(?P<adapter_name>\S+)\s+Host\s+Name\s+:\s+(?P<hostname_event>\S+).*?Domain\s+Suffix\s+:\s+(?P<domain_suffix>\S+)\s+DNS\s+server\s+list\s:\s+(?P<dns>.*?)\s+Sent\s+update\s+to\s+server\s+:\s+\S+\s+IP\s+Address(?:\(es\))?\s+:\s+(?P<src>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$src}
dst_ip={$host}
userdata1={$rule_group}
userdata2={$rule_comment}
userdata3={$adapter_name}
userdata4={$hostname_event}
userdata5={$event_id}
userdata6={$application}
userdata7={$data}
userdata8={$domain_suffix}
userdata9={$dns}

[0076 - System - Events (1085|5823)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>80050[0,2])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>system,)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?(?:WARNING|INFORMATION)\((?P<event_id>\d+)\):\s+(?P<application>[^:]+):(?:[^:]+:){2}\s+(?P<data>[^:]+):\s+(?:.*?domain\s+controller\s+\\\\(?P<domain>\S+))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
userdata1={$rule_group}
userdata2={$rule_comment}
userdata3={$hostname}
userdata4={$domain}
userdata5={$event_id}
userdata6={$application}
userdata7={$data}

[0080 - Symantec - Events INFORMATION(2|3)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>800320|7320)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^"]+)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?INFORMATION\((?P<event_id>\d+)\):\s+(?P<application>[^:]+):(?:[^:]+:){2}\s+(?P<data>[^:]+):\s+(?:Scan\s+Complete:\s+Risks:\s+(?P<risk>\d+)\s+Scanned:\s+(?P<scanned>\d+)\s+\S+\s+Omitted:\s+(?P<omitted>\d+)\s+Trusted\s+Files\s+Skipped:\s+(?P<skipped>\d+))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
userdata1={$rule_group}
userdata2={$rule_comment}
userdata3={$event_id}
userdata4={$data}
userdata5={$application}
userdata6={$risk}
userdata7={$scanned}
userdata8={$skipped}
userdata9={$omitted}

######################################################
# WINDOWS EVENTS
######################################################


[0090 - Windows ADFS - Error Event 105]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>100701)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^"]+)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?WinEvtLog:\s(?P<data>[^:]+):\s+ERROR\((?P<event_id>\d+)\):\s+AD\s+FS:\s(?:[^:]+:){2}\s+(?P<data1>[^:]+):(?:[^.]+\.){2}\s+Identifier:\s+(?P<identifier>\S+).*?Exception\s+details:\s+[^.]+\.(?P<name>[^,]+),\s+(?P<type>[^,]+),\s+Version=(?P<version>[^,]+),\s+Culture=(?P<culture>[^,]+),\s+PublicKeyToken=(?P<token>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
username={$username}
userdata1={$rule_level}
userdata2={$event_id}
userdata3={$data1}
userdata4={$identifier}
userdata5={$name}
userdata6={$type}
userdata7={$version}
userdata8={$culture}
userdata9={$token}

[0091 - Windows ADFS - Error Events(111|250|342|364|407)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>10070[2-6])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^"]+)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?WinEvtLog:\s(?P<data>[^:]+):\s+ERROR\((?P<event_id>\d+)\):\s+AD\s+FS:\s(?:[^:]+:){2}\s+(?P<data1>[^:]+):[^.:]+(?:\.|:)\s+(?:Request\sType:\s+\S+\s+)?Additional\s+Data\s+(?:User:\s+(?P<user>[^@\s]+)(?:@(?P<domain>\S+))?\s+[^:]+:\s+(?P<server>\S+)|Protocol\s+Name:\s+(?P<protocol>\S+)\s+Relying\s+Party:\s+(?P<relying>\S+)|Token\sType:\s+(?P<t_type>\S+)\s+%Error\smessage:\s+(?P<error_message>\S+))?\s*(?:Exception|Error)\s+(?:message|details):\s+(?P<details>[^:[]+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
username={$username}
userdata1={$event_id}
userdata2={$data1}
userdata3={$user}
userdata4={$domain}
userdata5={$server}
userdata6={$protocol}
userdata7={$relying}
userdata8={$t_type}
userdata9={$details}

[0092 - Windows ADFS - Information Events(100|103|106|156|157|251|336|337|349|358|386|388|390|397|399)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>1005[0,1][0-9])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^"]+)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?WinEvtLog:\s(?P<data>[^:]+):\s+INFORMATION\((?P<event_id>\d+)\):\s+AD\s+FS:\s(?:[^:]+:){2}\s+(?P<data1>[^:]+):\s+(?:[^:\s]+:\s+)?(?P<msg>[^.:]+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$host}
dst_ip={$host}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$data}
userdata5={$event_id}
userdata6={$data1}
userdata7={$msg}

[0093 - Windows ADFS - Warning Events(441|1000)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>10060[1,2])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^"]+)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^\"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<host>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?WinEvtLog:\s(?P<data>[^:]+):\s+WARNING\((?P<event_id>\d+)\):\s+AD\s+FS:\s(?:[^:]+:){2}\s+(?P<data1>[^:]+):\s+(?P<msg>[^.]+).*?Additional\s+Data\s+(?:User:\s+(?:-|(?P<user>\S*))\s+Target\s+RP:\s+(?:-|(?P<rp>\S*))\s+Client\s+IP:\s+(?P<src>\S+)\s+Token\sBinding\s+ID:\s+(?P<token>\S+)\s+Request\s+Provided\s+ID:\s+(?P<provided_id>\S+)|.*?Target\s+Relying\s+Party:\s+(?P<target_relying>\S+)).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$src}
dst_ip={$host}
username={$username}
userdata1={$rule_level}
userdata2={$event_id}
userdata3={$data1}
userdata4={$msg}
userdata5={$user}
userdata6={$rp}
userdata7={$token}
userdata8={$provided_id}
userdata9={$target_relying}

[1001 - Windows Logon Success - Audit Success(528|540)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>(528|540))\).*?User\s+Name\:\s+(?P<username>.*?)\s*Domain\:\s+(?P<domain>.*?)\s*Logon\s+ID\:\s+(?P<logon_id>\S+)\s+Logon\s+\Type\:\s+(?P<logon_type>\d+).*?Logon\s+Process\:\s+(?P<process_name>\S+).*?Workstation\s+Name\:\s+(?P<workstation>.*?)\s+Logon\s+GUID.*?Source\s+Network\s+Address\:\s+(?P<src_ip>\IPV4).*?Source\s+Port\:\s+(?P<src_port>\d+)?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$process_name}
userdata9={$workstation}


[1002 - Windows Logon Success - Audit Success(528|540) - No Source IP]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>(528|540))\).*?User\s+Name\:\s+(?P<username>.*?)\s*Domain\:\s+(?P<domain>.*?)\s*Logon\s+ID\:\s+(?P<logon_id>\S+)\s+Logon\s+\Type\:\s+(?P<logon_type>\d+).*?Logon\s+Process\:\s+(?P<process_name>\S+).*?Workstation\s+Name\:\s+(?P<workstation>.*?)\s+Logon\s+GUID.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$process_name}
userdata9={$workstation}


[1003 - Windows Logon Success - Audit Success(672)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>672)\).*?User\s+Name\:\s+(?P<username>\S+)\s+Supplied\s+Realm\s+Name\:\s+(?P<domain>\S+)\s+User\s+ID\:\s+(?P<user_id>\S+)\s+Service\s+Name\:\s+(?P<service_name>\S+).*?Pre\-Authentication\s+Type\:\s+(?P<auth_type>\d+)\s+Client\s+Address\:.*?(?P<src_ip>\IPV4).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$auth_type}
userdata6={$domain}
userdata7={$user_id}
userdata8={$service_name}


[1004 - Windows Logon Success - Audit Success(673)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>673)\).*?User\s+Name\:\s+(?P<username>[^(@|\s)]*).*?User\s+Domain\:\s+(?P<domain>\S+)\s+Service\s+Name\:\s+(?P<service_name>\S+)\s+Service\s+ID\:\s+(?P<service_id>\S+).*?Client\s+Address\:.*?(?P<src_ip>\IPV4).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$service_id}
userdata8={$service_name}


[1005 - Windows Logon Success - Audit Success(4624)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\s*USER:\s\"(?P<username>[^$"]+)\";\s*SRCIP:\s"[^"]*";\s*HOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+)(?:(?!AUDIT_SUCCESS)[^\s]*\s)*AUDIT_SUCCESS\((?P<winevent_id>4624)\)(?:(?!Logon\s+Type)[^\s]*\s)*Logon\s+Type\:\s+(?P<logon_type>\d+)(?:(?!Account\s+Domain)[^\s]*\s)*Account\s+Domain\:\s+(?P<domain>.*?)\s*Logon\s+ID\:\s+(?P<logon_id>\S+)(?:(?!Process\s+Name)[^\s]*\s)*Process\s+Name\:\s+(?P<process_name>\S+)\s+(?:(?!Workstation\s+Name)[^\s]*\s)*Workstation\s+Name\:\s+(?P<workstation>\S*)\s+Source\s+Network\s+Address\:\s+(?!-)(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s*Source\s+Port\:\s+(?!-)(?P<src_port>\d+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$process_name}
userdata9={$workstation}


[1006 - Windows Logon Success - Audit Success(4624) - No Source IP]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+)(?:(?!AUDIT_SUCCESS)\S+\s)+AUDIT_SUCCESS\((?P<winevent_id>4624)\):\s(?:(?!Account\s+Name)\S+\s+)+Account\s+Name:\s+(?P<hostname>[^\s]+)\s+(?:(?!Logon\s+Type)\S+\s+)+Logon\s+Type\:\s+(?P<logon_type>\d+)(?:(?!Account\s+Name)\S*\s)+Account\s+Name\:\s+(?P<username>\S+(?:(?!\sAccount\sDomain)\s+\S+)*)?\s*Account\s+Domain\:\s+(?P<domain>\S+(?:(?!\sLogon\sID)\s+\S+)*)\s*Logon\s+ID\:\s+(?P<logon_id>\S+)\s(?:(?!Process\s+Name)\S*\s)+Process\s+Name\:\s+(?P<process_name>\S+(?:(?!\sNetwork\sInformation)\s+\S+)*)\s*(?:(?!Workstation\sName)\S*\s)+Workstation\s+Name\:\s+(?P<workstation>\S*)\s*Source\s+Network\s+Address\:\s+(?!\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\-.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$hostname}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$process_name}
userdata9={$workstation}


[1007 - Windows Logon Success - Audit Success(4769)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)(?:(?!AUDIT_SUCCESS)[^\s]*\s)*AUDIT_SUCCESS\((?P<winevent_id>4769)\)(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>[^@\s]*)(?:@\S*)?\s+Account\s+Domain\:\s+(?P<domain>\S+)(?:(?!Service\s+Name)[^\s]*\s)*Service\s+Name\:\s+(?P<service_name>[^\s$]+)\$?(?:(?!Client\s+Address)[^\s]*\s)*Client\s+Address\:\s+(?:(?:::ffff:)?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?!\-)|(?P<ipv6>\S*))\s+Client\s+Port\:\s+(?P<src_port>\d+)(?:(?!Failure\s+Code)[^\s]*\s)*Failure\s+Code\:\s+(?P<failure_code>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$failure_code}
userdata8={$service_name}
userdata9={$hostname}


[1008 - Windows Logon Success - Audit Success(4769) - No Source IP]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)(?:(?!AUDIT_SUCCESS)[^\s]*\s)*AUDIT_SUCCESS\((?P<winevent_id>4769)\)(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>[^\s@]+)(?:@\S+)\s+Account\s+Domain\:\s+(?P<domain>\S+)(?:(?!Service\s+Name)[^\s]*\s)*Service\s+Name\:\s+(?P<service_name>\S+)(?:(?!Client\s+Address:\s+(?::+f+:)?\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})[^\s]*\s)*Failure\s+Code\:\s+(?P<failure_code>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$failure_code}
userdata8={$service_name}

## Workstation Logon success
[1009 - Windows Logon Success - Audit Success(4624)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?USER:\s\"(?P<username>[^"]+)\";.*?HOSTNAME\:\s*"?\((?P<hostname>[^\)]*)\)\s(?P<winip>[^"\s]*)->.*?AUDIT_SUCCESS\((?P<winevent_id>4624)\):\s+Microsoft-Windows-Security-Auditing:\s*(?P<user_log>[^$:]*)[\$:].*?Logon\s+Type\:\s+(?P<logon_type>\d+).*?Account\s+Domain\:\s+(?P<domain>.*?)\s*Logon\s+ID\:\s+(?P<logon_id>\S+).*?Process\s+Name\:\s+(?P<process_name>\S+).*?Workstation\s+Name\:\s*(?P<workstation>.*?)\s+Source\s+Network\s+Address\:\s+(?P<src_ip>\S+).*?Source\s+Port\:\s+(?P<src_port>\d*).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$hostname}
userdata9={$workstation}


[1009-b - Windows Logon Success - Audit Success(4769)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?\((?P<hostname>[^\)]*)\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>4769)\).*?Account\s+Name\:\s+(?P<username>[^@\s]*)(?:@\S*)?\s+Account\s+Domain\:\s+(?P<domain>\S+).*?Service\s+Name\:\s+(?P<service_name>\S+).*?Client\s+Address\:\s+.*?(?P<src_ip>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})\s+Client\s+Port\:\s+(?P<src_port>\d+).*?Failure\s+Code\:\s+(?P<failure_code>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$domain}
userdata6={$failure_code}
userdata7={$service_name}
userdata8={$hostname}


#
# Windows logon failure <id>^529$|^530$|^531$|^532$|^533$|^534$|^535$|^536$|^537$|^539$|^4625$</id>
# Windows DC logon failure <id>^672$|^673$|^675$|^676$|^681$|^4769$</id>
# Multiple Windows logon failures <if_matched_group>win_authentication_failed</if_matched_group>
# Windows DC integrity check on decrypted <match>Failure Code: 0x1F</match>
# Windows DC possible replay attack <match>Failure Code: 0x22</match>
# Windows DC clock skew too great <match>Failure Code: 0x25</match>
# [1010 - Windows Logon Failure - Audit Failure(529|530|531|532|533|534|535|536|537|539)]
# [1011 - Windows Logon Failure - Audit Failure(529|530|531|532|533|534|535|536|537|539) - No Source IP]
# [1012 - Windows Logon Failure - Audit Failure(672)]
# [1013 - Windows Logon Failure - Audit Failure(673)]
# [1014 - Windows Logon Failure - Audit Failure(675)]
# [1015 - Windows Logon Failure - Audit Failure(4625)]
# [1016 - Windows Logon Failure - Audit Failure(4625) - No Source IP]
# [1017 - Windows Logon Failure - Audit Failure(4769)]
# [1018 - Windows Logon Success - Audit Failure(4769) - No Source IP]
# [1019 - Windows Logon Failure - Audit Failure(4771)]
#

[1010 - Windows Logon Failure - Audit Failure(529|530|531|532|533|534|535|536|537|539)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\s+(?:(?!HOSTNAME)[^\s]+\s+)+HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->(?:(?!AUDIT_FAILURE)[^\s]+\s+)+AUDIT_FAILURE\((?P<winevent_id>(?:529|530|531|532|533|534|535|536|537|539))\):\s+.*?;?User\s+Name\:\s+(?P<username>.*?)(?:\s+|;)?Domain\:\s+;?(?P<domain>.*?)\s+;?Logon\s+Type\:\s+(?P<logon_type>\d+)\s+;?Logon\s+Process\:\s+(?P<process_name>\S+)\s+(?:(?!;?Workstation Name)[^\s]+\s+)+;?Workstation\s+Name\:\s+(?P<workstation>\S+)\s+(?:(?!;?Caller Domain)[^\s]+\s+)+;?Caller\s+Domain\:\s+(?P<caller_domain>\S+)\s+(?:(?!;?Source Network)[^\s]+\s+)+;?Source\s+Network\s+Address\:\s+(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*?Source\s+Port\:\s+(?P<src_port>\d+)?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$caller_domain}
userdata8={$process_name}
userdata9={$workstation}


[1011 - Windows Logon Failure - Audit Failure(529|530|531|532|533|534|535|536|537|539) - No Source IP]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\s+(?:(?!HOSTNAME)[^\s]+\s+)+HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->(?:(?!AUDIT_FAILURE)\S+\s+)+AUDIT_FAILURE\((?P<winevent_id>(529|530|531|532|533|534|535|536|537|539))\).*?User\s+Name\:\s+(?P<username>.*?)\s*Domain\:\s+(?P<domain>.*?)\s*Logon\s+Type\:\s+(?P<logon_type>\d+)\s+Logon\s+Process\:\s+(?P<process_name>\S+)\s+(?:(?!Workstation Name)[^\s]+\s+)+Workstation\s+Name\:\s+(?P<workstation>\S+)\s+(?:(?!Caller Domain)[^\s]+\s+)+Caller\s+Domain\:\s+(?P<caller_domain>\S+)\s+(?:(?!Source Network)[^\s]+\s+)+Source Network Address:\s+-"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$caller_domain}
userdata8={$process_name}
userdata9={$workstation}


[1012 - Windows Logon Failure - Audit Failure(672)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>672)\).*?User\s+Name\:\s+(?P<username>\S+)\s+Supplied\s+Realm\s+Name\:\s+(?P<domain>\S+)\s+User\s+ID\:\s+(?P<user_id>\S+)\s+Service\s+Name\:\s+(?P<service_name>\S+).*?Pre\-Authentication\s+Type\:\s+(?P<auth_type>\d+)\s+Client\s+Address\:.*?(?P<src_ip>\IPV4).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$auth_type}
userdata6={$domain}
userdata7={$user_id}
userdata8={$service_name}


[1013 - Windows Logon Failure - Audit Failure(673)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>673)\).*?User\sst+Name\:\s+(?P<username>[^(@|\s)]*).*?User\s+Domain\:\s+(?P<domain>\S+)\s+Service\s+Name\:\s+(?P<service_name>\S+)\s+Service\s+ID\:\s+(?P<service_id>\S+).*?Client\s+Address\:.*?(?P<src_ip>\IPV4).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$service_id}
userdata8={$service_name}


[1014 - Windows Logon Failure - Audit Failure(675)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>675)\).*?User\s+Name\:\s+(?P<username>.*?)\s*User\s+ID\:\s+(?P<user_id>.*?)\s*Service\s+Name\:\s+(?P<service_name>\S+)\s+Pre\-Authentication\s+Type\:\s+(?P<auth_type>\S+)\s+Failure\s+Code\:\s+(?P<failure_code>\S+)\s+Client\s+Address\:.*?(?P<src_ip>\IPV4).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$auth_type}
userdata7={$user_id}
userdata8={$service_name}
userdata9={$failure_code}


[1015 - Windows Logon Failure - Audit Failure(4625) - With IP]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\s.*?HOSTNAME\:[^\(]*\((?P<hostname>[^\)]*)\)\s(?P<winip>[^-]+)->(?:\S+\s+)*?AUDIT_FAILURE\((?P<winevent_id>4625)\):\s(?:(?!Logon\s+Type)[^\s]+\s+)+Logon\sType\:\s+(?P<logon_type>\d+)\s+(?:(?!Account\s+Name)[^\s]+\s+)+Account\s+Name\:\s*(?:(?P<username>(?:[^\s@]+|(?:(?!\s+Account\s+Domain\:\s)[^:])+))|\s*)(?:@\S+\s+)?\s+Account\s+Domain\:\s+(?P<domain>(?:(?!\s+Failure Information:\s)[^:])+)?\s*Failure\s+Information:\s+Failure\s+Reason\:\s+(?P<failure_reason>\S+)\s+(?:(?!Process\sName)[^\s]+\s+)+Process\s+Name\:\s+(?P<process_name>\S+)\s(?:(?!Workstation\s+Name)[^\s]*\s+)+Workstation\s+Name\:\s+\\*(?P<workstation>\S*)\s+Source\s+Network\s+Address\:\s+(?:(?!127\.0\.0\.1)(?:(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<src_ipv6>\S+)))+\s+Source\s+Port\:\s+(?P<src_port>\d+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$src_ipv6}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$failure_reason}
userdata8={$process_name}
userdata9={$workstation}


[1016 - Windows Logon Failure - Audit Failure(4625) - No Source IP]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+-\sAlert\s+-\s"(?P<date>\d+)"\s-->\sRID:\s"(?P<rule_id>\d+)";\s+RL:\s+"(?P<rule_level>\d+)";\s+RG:\s+"(?P<rule_group>[^"]*)";\s+RC:\s+"(?P<rule_comment>[^"]*)";\s(?:(?!HOSTNAME:)[^\s]+\s)+HOSTNAME:[^)]*\)\s(?P<winip>[^-]+)->(?:(?!AUDIT_FAILURE)[^\s]+\s+)+AUDIT_FAILURE\((?P<winevent_id>4625)\):\s(?:(?!Logon\s+Type)[^\s]+\s+)+Logon\sType:\s+(?P<logon_type>\d+)\s+(?:(?!Account\s+Name)[^\s]+\s+)+Account\s+Name:\s+(?:(?P<username>(?:[^\s@]+|(?:(?!\s+Account\s+Domain\:\s)[^:])+))|\s*)(?:@\S+\s+)?\s+Account\s+Domain:\s+(?P<domain>.*?)\s*Failure\s+Information:\s+Failure\s+Reason:\s+(?P<failure_reason>\S+)\s+(?:(?!Process\s+Name:)[^\s]+\s+)+Process\sName:\s+(?P<process_name>\S+(?:(?!\s\w+:)\s\S+)*)\s+(?:(?!Workstation\s+Name:)[^\s]+\s+)+Workstation\s+Name:\s+(?P<workstation>\S*)\s+Source\s+Network\s+Address:\s*(?:-|127\.0\.0\.1).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$failure_reason}
userdata8={$process_name}
userdata9={$workstation}


[1017 - Windows Logon Failure - Audit Failure(4769)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)(?:(?!AUDIT_FAILURE)[^\s]*\s)*AUDIT_FAILURE\((?P<winevent_id>4769)\)(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>[^@\s]*)(?:@\S*)?\s+Account\s+Domain\:\s+(?P<domain>\S+)(?:(?!Service\s+Name)[^\s]*\s)*Service\s+Name\:\s+(?P<service_name>\S+)(?:(?!Client\s+Address)[^\s]*\s)*Client\s+Address\:\s*(?::+f+:\s*)?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+Client\s+Port\:\s+(?P<src_port>\d+)(?:(?!Failure\s+Code)[^\s]*\s)*Failure\s+Code\:\s+(?P<failure_code>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$failure_code}
userdata8={$service_name}
userdata9={$hostname}


[1018 - Windows Logon Success - Audit Failure(4769) - No Source IP]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)(?:(?!AUDIT_FAILURE)[^\s]*\s)*AUDIT_FAILURE\((?P<winevent_id>4769)\)(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>\S+)\s+Account\s+Domain\:\s+(?P<domain>\S+)(?:(?!Service\s+Name)[^\s]*\s)*Service\s+Name\:\s+(?P<service_name>\S+)(?:(?!Client\s+Address:\s+(?::+f+:)?\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})[^\s]*\s)*Failure\s+Code\:\s+(?P<failure_code>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$failure_code}
userdata8={$service_name}


[1019 - Windows Logon Failure - Audit Failure(4771)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)"?(?:(?!AUDIT_FAILURE)[^\s]*\s)*AUDIT_FAILURE\((?P<winevent_id>4771)\)(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>[^\s@]+)(?:@(?P<domain>\S+))?(?:(?!Service\s+Name)[^\s]*\s)*Service\s+Name\:\s+(?P<service_name>\S+)(?:(?!Client\s+Address)[^\s]*\s)*Client\s+Address\:.*?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+Client\s+Port\:\s+(?P<src_port>\d+)(?:(?!Failure\sCode)[^\s]*\s)*Failure\s+Code\:\s+(?P<failure_code>\S+)\s+Pre\-Authentication\s+Type\:\s+(?P<auth_type>\d+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$winip}
src_port={$src_port}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$auth_type}
userdata6={$service_name}
userdata7={$failure_code}
userdata8={$domain}


#
# Windows user logoff <id>^538$|^4634$|^4647$</id>
# [1020 - Windows User Logoff - Audit Success(538)]
# [1021 - Windows User Logoff - Audit Success(4634|4647)]
#

[1020 - Windows User Logoff - Audit Success(538)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>538)\).*?User\s+Name\:\s+(?P<username>[^\s$]+)\$?.*?Domain\:\s+(?P<domain>.*?)\s*Logon\s+ID\:\s+(?P<logon_id>\S+)\s+Logon\s+\Type\:\s+(?P<logon_type>\d+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$logon_id}


[1021 - Windows User Logoff - Audit Success(4634|4647)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?\((?P<hostname>[^\)]*)\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>(?:4634|4647))\).*?Account\s+Name\:\s+(?P<username>.*?)\s*Account\s+Domain\:\s+(?P<domain>.*?)\s*Logon\s+ID\:\s+(?P<logon_id>\S+)(?:\s+Logon\s+\Type\:\s+(?P<logon_type>\d+))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_type}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$hostname}

#
# Windows computer shutdown <id>^1074$</id>
# [1022 - Windows computer shutdown - System: INFORMATION(1074)]
# Windows process created or exited <id>^4688$|^4689$</id>
# [1023 - Windows process created or exited - Audit Success(4688|4689)]
#

[1022 - Windows computer shutdown - System: INFORMATION(1074)]
event_type=event
#precheck="INFORMATION(1074)"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>10070)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>computer,shutdown,)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)[^"]*";.*?EVENT:\s(?:\S+\s+)*?The process\s*(?P<process>\S+)\s.*?(?:power off|shutdown) of computer\s*(?P<domain>\S+)\s(?:\S+\s+)*?reason:\s*(?P<reason>.*?)\sReason\sCode:\s*(?P<reason_code>\S+)\s*Shutdown Type:\s(?P<shutdown_type>.*?)\s*Comment:\s*(?P<comment>[^\[]*)\[END\]";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$domain}
dst_ip={$domain}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$process}
userdata5={$reason}
userdata6={$reason_code}
userdata7={$shutdown_type}
userdata8={$comment}

[1023 - Windows process created or exited - Audit Success(4688|4689)]
event_type=event
#precheck="INFORMATION(1074)"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>104001|104002)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)(?:(?!AUDIT_)[^\s]*\s)+AUDIT_\S+\((?P<winevent_id>4688|4689)\):\s+Microsoft-Windows-Security-Auditing:\s+[^:]*:[^:]*:\s+(?P<computer_name>[^:]*):\s+A (?:new )?process has (?:been created|exited)\.\s+Subject:\s+Security\s+ID:\s+(?P<user_id>\S+)\s*Account Name:\s*(?P<acc_name>.*?)\s+Account Domain:\s+(?P<acc_domain>.*?)\s+Logon ID:.*?Process ID:\s*(?P<process_id>\S+)\s+.*?Process Name:\s+(?P<process_name>.*?)\s+(?:Token Elevation Type:\s*(?P<token>\S*).*?Creator Process ID:\s+(?P<creator_process_id>[^\[]*)\[END|Exit Status).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$acc_name}
userdata1={$rule_level}
userdata2={$winevent_id}
userdata3={$token}
userdata4=User ID: {$user_id}
userdata5={$acc_domain}
userdata6=Process ID: {$process_id}
userdata7={$process_name}
userdata8={$creator_process_id}
userdata9={$computer_name}


[1024 - Windows Kerberos Authenticacion - Audit Success/Failure(4768)]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";(?:(?!HOSTNAME)[^\s]*\s)+HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)(?:(?!AUDIT_)[^\s]*\s)+AUDIT_\S+\((?P<winevent_id>4768)\)(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>[^@\s]*)(?:@(?P<domain>\S*))?\s+Supplied Realm Name:\s*(?P<realm>\S*)(?:(?!Service\s+Name)[^\s]*\s)*Service\s+Name\:\s+(?P<service_name>[^\s$]+)\$?(?:(?!Client\s+Address)[^\s]*\s)*Client\s+Address\:\s+(?:::ffff:)?(?:(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?!\-)\S*)\s+Client\s+Port\:\s+(?P<src_port>\d+)(?:(?!Result\s+Code)[^\s]*\s)*Result\s+Code\:\s+(?P<failure_code>\S+)\s+(?:(?!Ticket\s+Encryption)[^\s]*\s)*Ticket\sEncryption\sType:\s(?P<encryption_type>\S+)\s(?:(?!Pre-Authentication\s+Type)[^\s]*\s)*Pre-Authentication\sType:\s(?P<pre_auth_type>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$src_ip}
src_port={$src_port}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$service_name}
userdata5={$failure_code}
userdata6={$encryption_type}
userdata7={$pre_auth_type}
userdata8={$domain}
userdata9={$realm}


#
# Windows: disk is at or near capacity <id>2013
#

[1025 - Windows is near capacity - Warning(2013)]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>18157|281570)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s+"(?P<hostname>[^"]*)".*?WARNING\((?P<winevent_id>2013)\):\s+(?P<source>[^:]+):\s+(?:\(no\suser\)|(?P<user>[^:]+)):\s(?:no\sdomain|(?P<domain>[^:]+)):\s(?P<computer_name>[^:]+):\s(?P<msg>The\s\S+\sdisk\sis\sat\sor\snear\scapacity).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$computer_name}
username={$user}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$source}
userdata5={$domain}
userdata6={$msg}

#
# Windows user account enabled or created <id>^624$|^626$|^645$|^4720$|^4722$|^4741$</id>
# Windows user account changed <id>^628$|^642$|^685$|^4738$|^4781$</id>
# Windows user account disabled or deleted <id>^630$|^629$|^4725$|^4726$</id>
# Windows computer account changed/deleted <id>^646$|^647$</id>
# Windows user account unlocked <id>^671$|^4767$</id>
# Windows security enabled group created <id>^631$|^635$|^658$</id>
# Windows security enabled group deleted <id>^634$|^638$|^662$</id>
# [1030 - Windows Account Changed - Audit Success(624|626|628|629|630|631|634|635|638|642|645|646|647|658|662|671|685)]
# [1032 - Windows Account Changed - Audit Success(4720|4722|4725|4726|4738|4741|4767|4781)]
#

[1030 - Windows Account Changed - Audit Success(624|626|628|629|630|631|634|635|638|642|645|646|647|658|662|671|685)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>(624|626|628|629|630|631|634|635|638|642|645|646|647|658|662|671|685))\).*?Account\s+Name\:\s+(?P<username>\S+).*?Domain\:\s+(?P<domain>\S+).*?Account\s+ID\:\s+(?P<account_id>\S+).*?Caller\s+\User\s+Name\:\s+(?P<caller_name>\S+).*?Caller\s+Domain\:\s+(?P<caller_domain>\S+).*?Caller\s+Logon\s+ID\:\s+(?P<caller_id>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$caller_id}
userdata6={$domain}
userdata7={$account_id}
userdata8={$caller_name}
userdata9={$caller_domain}


[1031-a - Windows Account Changed - Audit Success(4738) Without UAC]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s+"[^"]+";\sSRCIP:[^;]+;\s+HOSTNAME:\s\"(?:\((?P<hostname>[^\)]*)\))?\s+?(?:\S+@)?\(?(?P<winip>(?(hostname)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:[^;]+;\s+EVENT:\s+"\[INIT\]\d+\s\w+\s\d+\s\S+\sWinEvtLog:\s+Security:\sAUDIT_SUCCESS\((?P<winevent_id>4738)\):\s(?:\S+(?:(?!\s+Subject:)\s\S+)*)\sSubject:\s+Security ID:\s+\S+\s+Account\s+Name\:\s+(?P<caller_name>\S+(?:(?!\s+Account Domain:)\s\S+)*)\s+Account Domain\:\s+(?P<caller_domain>\S+(?:(?!\s+Logon ID)\s+\S+)*)\s+Logon\s+ID\:\s+(?P<caller_id>\S+)\s+Target Account:\s+Security ID:\s+\S+\s+Account\s+Name\:\s+(?P<username>\S+)\s+Account\s+Domain\:\s+(?P<domain>[^\s\[]+)\s+\S+(?:(?!\s+Old UAC Value:)\s+\S+)+\s+Old UAC Value:\s+-\s+New UAC Value:\s+-"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$caller_name}
userdata1={$rule_group}
userdata2={$hostname}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$caller_id}
userdata8={$username}
userdata9={$caller_domain}

[1031-b - Windows Account Changed - Audit Success(4738) With UAC]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+).*?AUDIT_SUCCESS\((?P<winevent_id>4738)\):\s+(?:(?!Account Name)\S+\s+)+Account\s+Name\:\s+(?P<caller_name>\S+).*?Domain\:\s+(?P<caller_domain>\S+).*?Logon\s+ID\:\s+(?P<caller_id>\S+)\s+(?:(?!Account Name)\S+\s+)+Account\s+Name\:\s+(?P<username>\S+).*?Account\s+Domain\:\s+(?P<domain>\S+)\s+(?:(?!Old UAC)\S+\s+)+Old UAC Value:\s+(?P<old_uac>[^-\s+]+)\s+New UAC Value:\s+(?P<new_uac>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$caller_name}
userdata1=Old UAC: {$old_uac}
userdata2=New UAC: {$new_uac}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$caller_id}
userdata8={$username}
userdata9={$caller_domain}


[1032 - Windows Account Changed - Audit Success(4720|4722|4725|4726|4741|4767|4781|4723|4724|4742)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+).*?AUDIT_SUCCESS\((?P<winevent_id>(?:4720|4722|4725|4726|4741|4767|4781|4723|4724|4742))\).*?Account\s+Name\:\s+(?P<caller_name>\S+).*?Domain\:\s+(?P<caller_domain>\S+).*?Logon\s+ID\:\s+(?P<caller_id>\S+).*?Account\s+Name\:\s+(?P<username>\S+(?:(?!\s\w+:)\s\S+)*).*?Account\s+Domain\:\s+(?P<domain>[^\s\[]+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$caller_name}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$caller_id}
userdata8={$username}
userdata9={$caller_domain}


[1033 - Windows Account Changed - Audit Failure(4723|4724)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>100301|100303|110002|110003)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+).*?AUDIT_FAILURE\((?P<winevent_id>(4723|4724))\).*?Account\s+Name\:\s+(?P<caller_name>\S+).*?Domain\:\s+(?P<caller_domain>\S+).*?Logon\s+ID\:\s+(?P<caller_id>\S+).*?Account\s+Name\:\s+(?P<username>\S+).*?Account\s+Domain\:\s+(?P<domain>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$caller_name}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$caller_id}
userdata8={$username}
userdata9={$caller_domain}


#
# Windows group account created <id>^631$|^4727$|^635$|^4731$|^658$|^4754$|^648$|^4744$|^653$|^4749$|</id>
# Windows group account created <id>^663$|^4759$</id>
# Windows group account deleted <id>^634$|^4730$|^638$|^4734$|^662$|^4758$|^652$|^4748$|^657$|^4753$|</id>
# Windows group account deleted <id>^667$|^4763$</id>
# Windows security enabled global group created <id>^631$|^4727$</id>
# Windows security enabled global group member added <id>^632$|^4728$</id>
# Windows security enabled global group member removed <id>^633$|^4729$</id>
# Windows security enabled global group deleted <id>^634$|^4730$</id>
# Windows security enabled global group changed <id>^641$|^4737$</id>
# Windows security enabled local group created <id>^635$|^4731$</id>
# Windows security enabled local group member added <id>^636$|^4732$</id>
# Windows security enabled local group member removed <id>^637$|^4733$</id>
# Windows security enabled local group removed <id>^638$|^4734$</id>
# Windows security enabled local group changed <id>^639$|^4735$</id>
# Windows security enabled universal group created <id>^658$|^4754$</id>
# Windows security enabled universal group member added <id>^660$|^4756$</id>
# Windows security enabled universal group member removed <id>^661$|^4757$</id>
# Windows security enabled universal group deleted <id>^662$|^4758$</id>
# Windows security enabled universal group changed <id>^659$|^4755$</id>
# [1040 - Windows Group Changed - Audit Success(631|634|635|638|639|641|648|652|653|657|658|659|662|663|667)]
# [1041 - Windows Group Member Added or Removed - Audit Success(632|633|636|637|660|661)]
# [1042 - Windows Group Changed - Audit Success(4727|4730|4731|4734|4735|4737|4744|4748|4749|4753|4754|4755|4758|4759|4763)]
# [1043 - Windows Group Member Added or Removed - Audit Success(4728|4729|4732|4733|4756|4757)]
#

[1040 - Windows Group Changed - Audit Success(631|634|635|638|639|641|648|652|653|657|658|659|662|663|667)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>(631|634|635|638|639|641|648|652|653|657|658|659|662|663|667))\).*?Account\s+Name\:\s+(?P<username>\S+).*?Domain\:\s+(?P<domain>\S+).*?Account\s+ID\:\s+(?P<account_id>\S+).*?Caller\s+\User\s+Name\:\s+(?P<caller_name>\S+).*?Caller\s+Domain\:\s+(?P<caller_domain>\S+).*?Caller\s+Logon\s+ID\:\s+(?P<caller_id>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$caller_id}
userdata6={$domain}
userdata7={$account_id}
userdata8={$caller_name}
userdata9={$caller_domain}


[1041 - Windows Group Member Added or Removed - Audit Success(632|633|636|637|660|661)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>(632|633|636|637|660|661))\).*?Member\s+Name\:\s+cn\W(?P<username>[^,]+).*?DC\W(?P<domain>[\w-]+).*?Member\s+ID\:\s+(?P<member_id>\S+).*?Target\s+Account\s+Name\:\s+(?P<group_name>\S+).*?Caller\s+User\s+Name\:\s+(?P<caller_name>\S+).*?Caller\s+Domain\:\s+(?P<caller_domain>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$member_id}
userdata6={$domain}
userdata7={$group_name}
userdata8={$caller_name}
userdata9={$caller_domain}


[1042 - Windows Group Changed - Audit Success(4727|4730|4731|4734|4735|4737|4744|4748|4749|4753|4754|4755|4758|4759|4763)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>(4727|4730|4731|4734|4735|4737|4744|4748|4749|4753|4754|4755|4758|4759|4761|4763))\).*?Account\s+Name\:\s+(?P<username>\S+).*?Domain\:\s+(?P<domain>\S+).*?Logon\s+ID\:\s+(?P<logon_id>\S+).*?Group:\s+Security\sID:\s+\S+\s+(?:Group|Account)\s+Name\:\s+(?P<group_name>.*?)(?:\s+(?:Group|Account))\s+Domain\:\s+(?P<group_domain>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$group_name}
userdata9={$group_domain}


[1043 - Windows Group Member Added or Removed - Audit Success(4728|4729|4732|4733|4756|4757)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+)(?:(?!AUDIT_SUCCESS)\S+\s+)*?AUDIT_SUCCESS\((?P<winevent_id>(?:4728|4729|4732|4733|4756|4757))\).*?Account\s+Name\:\s+(?P<username>\S+).*?Domain\:\s+(?P<domain>\S+).*?Logon\s+ID\:\s+(?P<logon_id>\S+).*?Member:\s*Security ID:\s*(?P<security_member_id>\S+)\s*Account\s+Name\:\s+(?:CN=)?(?P<member_name>-|(?:(?!,OU|\sGroup:|,CN|,DC),?[^,]*)*).*?Group:\s+Security\sID:\s+\S+\s+(?:Group|Account)\s+Name\:\s+(?P<group_name>.*?)(?:\s+(?:Group|Account))\s+Domain\:\s+(?P<group_domain>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5=Account name: {$member_name} / Security ID: {$security_member_id}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$group_name}
userdata9={$group_domain}


#
# Windows audit policy changed <id>^612$|^643$|^4719$|^4907$|^4912$</id>
# [1050 - Windows Audit Policy Changed - Audit Success(612|643)]
# [1051 - Windows Audit Policy Changed - Audit Success(4719|4907|4912)]
# [1052 - Windows Startup Type Changed - Information(7040)]
# [1053 - Network Policy Server denied access to a user - AUDIT_FAILURE(6273)]
#

[1050 - Windows Audit Policy Changed - Audit Success(612|643)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>(612|643))\).*?User\s+Name\:\s+(?P<username>\S+).*?Domain(\s+Name)?\:\s+(?P<domain>\S+).*?Logon\s+ID\:\s+(?P<logon_id>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata6={$domain}
userdata7={$logon_id}


[1051 - Windows Audit Policy Changed - Audit Success(4719|4907|4912)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?:any|(?P<winip>\S+))->.*?AUDIT_SUCCESS\((?P<winevent_id>(4719|4907|4912))\).*?Account\s+Name\:\s+(?P<username>\S+).*?Domain\:\s+(?P<domain>\S+).*?Logon\s+ID\:\s+(?P<logon_id>\S+)(.*?Category\:\s+(?P<category>\S+).*?Subcategory\:\s+(?P<subcategory>\S+).*?Changes\:\s+(?P<changes>\S+))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$changes}
userdata6={$domain}
userdata7={$logon_id}
userdata8={$category}
userdata9={$subcategory}


[1052 - Windows Startup Type Changed - Information(7040)]
event_type=event
#precheck="INFORMATION"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?INFORMATION\((?P<winevent_id>7040)\):\s+Service\s+Control\s+Manager\:\s+(?P<username>\w+)\:\s+(?P<domain>\w+).*?The\sstart\stype\sof\sthe\s(?P<service_name>.*?)\sservice\swas\schanged.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$service_name}
userdata6={$domain}

[1053 - Network Policy Server denied access to a user - AUDIT_FAILURE(6273)]
event_type=event
#precheck="INFORMATION"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>6273)\):\s+.*?User:\s+.*?Fully Qualified Account Name:\s+(?P<domain>[^\\]+)(?:/|\\+)(?P<username>.*?)\s+Client Machine:\s+.*?NAS IPv4 Address:\s+(?:-|(?P<src_ip>\S+))\s+NAS IPv6 Address:\s+(?:-|(?P<src_ipv6>\S+))\s+NAS Identifier:\s+(?P<identifier>\S*)\s+NAS Port-Type:\s+(?P<port_type>\S+(?:(?!\s\w+:)\s\S+)*)\s+NAS Port:\s+(?P<src_port>\d*).*?Client Friendly Name:\s+(?P<source_name>.*?)\s+Client IP Address:\s+.*?Authentication Server:\s+(?P<authentication_server>\S+)\s+Authentication Type:\s+(?P<auth_type>.*?)\s+EAP Type:.*?Reason Code:\s+(?P<reason_code>\S+)\s+Reason:\s+(?P<reason_text>[^[]+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$src_ip}
username={$username}
userdata1={$port_type}
userdata2={$identifier}
userdata3={$domain}
userdata4={$src_ipv6}
userdata5={$source_name}
userdata6={$auth_type}
userdata7={$reason_code}
userdata8={$reason_text}
userdata9={$authentication_server}

[1054 - Network Policy Server granted access to a user - AUDIT_SUCCESS(6272|6278)]
event_type=event
#precheck="INFORMATION"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>627[2,8])\):\s+.*?User:\s+.*?Fully Qualified Account Name:\s+(?P<domain>[^\\/]+)(?:/|\\+)(?:(?:[^/]+/)+)?(?P<username>\S+)\s+Client Machine:\s+.*?NAS IPv4 Address:\s+(?:-|(?P<src_ip>\S+))\s+NAS IPv6 Address:\s+(?:-|(?P<src_ipv6>\S+))\s+NAS Identifier:\s+(?:-|(?P<identifier>\S*))\s+NAS Port-Type:\s+(?P<port_type>\S+(?:(?!\s\w+:)\s\S+)*)\s+NAS Port:\s+(?P<src_port>\d*).*?Client Friendly Name:\s+(?P<source_name>.*?)\s+Client IP Address:\s+(?P<src>\d+\.\d+\.\d+\.\d+).*?Authentication Server:\s+(?P<authentication_server>\S+)\s+Authentication Type:\s+(?P<auth_type>.*?)\s+(?:EAP Type:.*?Reason Code:\s+(?P<reason_code>\S+)\s+Reason:\s+(?P<reason_text>[^[]+))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$winevent_id}
userdata3={$port_type}
userdata4={$identifier}
userdata5={$domain}
userdata6={$src_ipv6}
userdata7={$source_name}
userdata8={$auth_type}
userdata9={$authentication_server}

#
# Windows user account locked out <id>^644$|^4740$</id>
# [1060 - Windows User Account Locked Out - Audit Success(644)]
# [1061 - Windows User Account Locked Out - Audit Success(4740)]
#

[1060 - Windows User Account Locked Out - Audit Success(644)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>644)\).*?Target\s+Account\s+Name\:\s+(?P<username>\S+).*?Target\s+Account\s+ID\:\s+(?P<account_id>\S+).*?Caller\s+Machine\s+Name\:\s+(?P<caller_machine>\S+).*?Caller\s+User\s+Name\:\s+(?P<caller_name>\S+).*?Caller\s+Domain\:\s+(?P<caller_domain>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$caller_machine}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$account_id}
userdata6={$caller_domain}
userdata7={$caller_name}
userdata8={$caller_machine}


[1061 - Windows User Account Locked Out - Audit Success(4740)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\s*USER:\s*"[^"]*";\s*SRCIP:\s*"[^"]*";\s*HOSTNAME\:[^\)]*\)\s(?P<winip>[^-]+)->(?:[^;]+;){2}\s+EVENT:(?:(?!AUDIT_)[^\s]*\s)+AUDIT_SUCCESS\((?P<winevent_id>4740)\):(?:(?!Account\s+Name)\s*\S+\s+)+Account\s+Name\:\s+(?P<account_name>\S+)\s+Account\s+Domain\:\s+(?P<account_domain>\S+).*?Logon\s+ID\:\s+(?P<logon_id>\S+)[^:]+:\s+Security\s*ID:\s+(?P<secid>\S*)\s+Account\s+Name\:\s+(?P<username>\S+)[^:]+:\s+Caller\s+Computer\s+Name\:\s+\\*(?P<caller_machine>[^\s\[]*).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$caller_machine}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_id}
userdata6={$account_domain}
userdata7={$account_name}
userdata8={$caller_machine}
userdata9={$secid}


[1065 - Windows Sysmon - INFORMATION (1,2,5)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\s*USER:\s*"[^"]*";\s*SRCIP:\s*"[^"]*";\s*HOSTNAME\:[^\)]*\)\s(?P<winip>[^-]+)->(?:[^;]+;){2}\s+EVENT:\s+"\[INIT\]\S+(?:(?! INFORMATION)\s\S+)*\s+INFORMATION\((?P<eventId>\d+)\):\s+Microsoft-Windows-Sysmon:\s+(?P<user>[^:]+):\s+NT\s+AUTHORITY:\s+(?P<server>[^:]+):[^:]+:\s+UtcTime:\s+(?P<dateevent>\d+.\d+-\d+\s+\d+:\d+:\d+)\.\d+\s+ProcessGuid:\s+(?P<guid>\S+)\s+ProcessID:\s+(?P<pid>\d+)\s+Image:\s+(?P<image>\S+(?:(?!\s\w+=)\s[^\s[]+)*)(?:(?:(?!Company)[^\s]*\s)+Company:\s+(?P<company>\S+(?:(?!\s\w+:)\s\S+)*)(?:(?!User)[^\s]*\s)+User:\s+(?P<domain>[^\\]+)\\(?P<username>\S+(?:(?!\s\w+:)\s\S+)*))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$eventId}
userdata5={$user}
userdata6={$server}
userdata7={$guid}
userdata8={$domain}
userdata9={$company}


#
# Windows MS SQL server logon success <id>^18454$|^18453$</id>
# Windows MS SQL server logon failure <id>^18456$</id>
# [1070 - Windows MS SQL Server Logon Success - Audit Success(18454|18453)]
# [1071 - Windows MS SQL Server Logon Failure - Audit Success(18456)]
#

[1070 - Windows MS SQL Server Logon Success - Audit Success(18454|18453) - Local machine]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";(?:[^;]+;\s+){2}HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->(?:(?!AUDIT_SUCCESS)\S+\s+)+AUDIT_SUCCESS\((?P<winevent_id>(18454|18453))\):\s+(?:(?!Login succeeded)\S+\s+)+Login\s+succeeded\s+for\s+user\s+'(?:(?P<domain>[^\\]+)\\)?(?P<username>[^\']*)'[^[]+\[CLIENT\:\s+(?P<client>(?!\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})[^]]+)\].*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$domain}
userdata6={$client}

[1071 - Windows MS SQL Server Logon Success - Audit Success(18454|18453) - Client ip]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";(?:[^;]+;\s+){2}HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->(?:(?!AUDIT_SUCCESS)\S+\s+)+AUDIT_SUCCESS\((?P<winevent_id>(18454|18453))\):\s+(?:(?!Login succeeded)\S+\s+)+Login\s+succeeded\s+for\s+user\s+'(?:(?P<domain>[^\\]+)\\)?(?P<username>[^\']*)'[^[]+\[CLIENT\:\s+(?P<client>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\].*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$client}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$domain}

[1072 - Windows MS SQL Server Logon Failure - Audit Failure(18456) - Local machine]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";(?:[^;]+;\s+){2}HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->(?:(?!AUDIT_FAILURE)\S+\s+)+AUDIT_FAILURE\((?P<winevent_id>18456)\):\s+(?:(?!Login failed)\S+\s+)+Login\s+failed\s+for\s+user\s+'(?:(?P<domain>[^\\]+)\\(?:\\+)?)?(?P<username>[^\']*)'[^[]+\[CLIENT\:\s+(?P<client>(?!\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})[^]]+)\].*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$domain}
userdata6={$client}

[1073 - Windows MS SQL Server Logon Failure - Audit Failure(18456) - Client ip]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";(?:[^;]+;\s+){2}HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->(?:(?!AUDIT_FAILURE)\S+\s+)+AUDIT_FAILURE\((?P<winevent_id>18456)\):\s+(?:(?!Login failed)\S+\s+)+Login\s+failed\s+for\s+user\s+'(?:(?P<domain>[^\\]+)\\(?:\\+)?)?(?P<username>[^\']*)'[^[]+\[CLIENT\:\s+(?P<client>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\].*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$client}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$domain}

[1074 - Windows MS SQL Server Information Event]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>103003)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s+"[^"]+";\sSRCIP:[^;]+;\s+HOSTNAME:\s\"(?:\((?P<hostname>[^\)]*)\))?\s+?(?:\S+@)?\(?(?P<winip>(?(hostname)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:[^;]+;\s+EVENT:\s+"\[INIT\]\d+\s\w+\s\d+\s\S+\sWinEvtLog:\s+Application:\sINFORMATION\((?P<id>\d+)\):\sMSSQLSERVER:\s[^:]+:\s[^:]+:\s(?P<domain>[^:]+):\s(?P<msg>[^\.]+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$hostname}
userdata5={$id}
userdata6={$domain}
userdata7={$msg}

[1075 - Windows MS SQL Server Error Event - With Client IP]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>103004)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s+"[^"]+";\sSRCIP:[^;]+;\s+HOSTNAME:\s\"(?:\((?P<hostname>[^\)]*)\))?\s+?(?:\S+@)?\(?(?P<winip>(?(hostname)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:[^;]+;\s+EVENT:\s+"\[INIT\]\d+\s\w+\s\d+\s\S+\sWinEvtLog:\s+Application:\sERROR\((?P<id>\d+)\):\sMSSQLSERVER:\s[^:]+:\s[^:]+:\s(?P<domain>[^:]+):\s(?P<msg>[^\.]+)[^\[]+\[CLIENT:\s(?P<client>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\]"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$client}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$hostname}
userdata5={$id}
userdata6={$domain}
userdata7={$msg}

#
# Windows Failed attempt to perform a privileged operation <id>^577$</id>
# Windows Multiple failed attempts to perform a privileged operation by the same user <if_matched_sid>18108</if_matched_sid>
# [1080 - Windows Failed To Perform a Privileged Operation - Audit Failure(577)]
# [1081 - Windows Failed to Call a Privileged Service - Audit Failure(4673)]
# [1082 - An operation was performed on an object - Audit Success(4662)]
#

[1080 - Windows Failed to Perform a Privileged Operation - Audit Failure(577)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>577)\).*?Primary\s+User\s+Name\:\s+(?P<username>\S+)\s+Primary\s+Domain\:\s+(?P<domain>\S+)\s+Primary\s+Logon\s+ID\:\s+(?P<logon_id>\S+).*?Client\s+User\s+Name\:\s+(?P<client_name>\S+)\s+Client\s+Domain\:\s+(?P<client_domain>\S+).*?Privileges\:\s+(?P<privileges>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_id}
userdata6={$domain}
userdata7={$client_name}
userdata8={$client_domain}
userdata9={$privileges}


[1081 - Windows Privileged Service - Audit Failure/Success(4673)]
event_type=event
#precheck="AUDIT_FAILURE/AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_(?:SUCCESS|FAILURE)\((?P<winevent_id>467(?:3|4))\).*?Account\s+Name\:\s+(?P<username>\S+)\s+Account\s+Domain\:\s+(?P<domain>.*?)\s+Logon\s+ID\:\s+(?P<logon_id>\S+).*?(?:Service\s+Name\:\s+(?P<service_name>.*?))?\s+Process(?:\s+\S+)?\:.*?Process\s+Name\:\s+(?P<process_name>.*?\.\S+).*?Privileges\:\s+(?P<privileges>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_id}
userdata6={$domain}
userdata7={$service_name}
userdata8={$process_name}
userdata9={$privileges}

[1082 - Windows Operation performed on object - Audit Success(4662|4663)]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*object[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_(?:SUCCESS|FAILURE)\((?P<winevent_id>4662|4663)\).*?Account\s+Name\:\s+(?P<username>\S+)\s+Account\s+Domain\:\s+(?P<domain>.*?)\s+Logon\s+ID\:\s+(?P<logon_id>\S+).*?(?:Object\s+Name\:\s+(?P<object_name>\S+(?:(?!\s+\w+:)\s\S+)*))\s+Handle ID:\s+(?P<handle_id>\S+)\s+(?:.*?Operation Type:\s+(?P<operation_type>.*?)\s+|Process\s+Information:\s+.*?Process\s+Name:\s+(?P<process>.*?)\s*Access\s+Request\s+Information:\s+)?Accesses:.*?Access Mask:\s+(?P<access_mask>[^\s[]+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$process}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$logon_id}
userdata6={$domain}
userdata7={$object_name}
userdata8={$operation_type}
userdata9={$handle_id}


[1083 - Windows Handle closed (4658) and duplicate handle (4690)]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>106006|106007)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?SRCIP:\s+"(?:None|(?P<src>[^"]*))";\s+HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>\d+)\).*?Security ID:\s+(?P<security_id>\S+)\s+Account\s+Name\:\s+(?P<username>\S+)\s+Account\s+Domain\:\s+(?P<domain>.*?)\s+Logon\s+ID\:\s+(?P<logon_id>\S+)(?:.*?Source Handle ID:\s+(?P<src_handle_id>\S+)\s+Source Process ID:\s+(?P<src_process_id>\S+))?(?:.*?Security\s+Handle\s+ID:\s+(?P<security_handle_id>\S+).*?Process Name:\s+(?P<process_name>[^[]+))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src}
dst_ip={$winip}
username={$username}
userdata1={$rule_group}
userdata2={$rule_comment}
userdata3={$winevent_id}
userdata4={$security_id}
userdata5={$domain}
userdata6={$logon_id}
userdata7={$src_handle_id}
userdata8={$security_handle_id}
userdata9={$process_name}

#
# Windows remote access login success <id>^20158$</id>
# Windows remote access login failure <id>^20187$|^20014$|^20078$|^20050$|^20049$|^20189$</id>
# Multiple remote access login failures <if_matched_sid>18125</if_matched_sid>
# [1090 - Windows Remote Access Login Failure - Warning(20014)]
# [1091 - Windows Remote Access Login Failure - Warning(20189)]
# The rest of event IDs match Windows Warning/Error rules
#

[1090 - Windows Remote Access Login Failure - Warning(20014)]
event_type=event
#precheck="WARNING"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?WARNING\((?P<winevent_id>20014)\).*?The\s+user\s+(?P<domain>\w+)\\(?P<username>\w+)\s+has\s+connected\s+and\s+failed.*?\s+port\s+(?P<port_name>.*?)\..*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$port_name}
userdata6={$domain}


[1091 - Windows Remote Access Login Failure - Warning(20189)]
event_type=event
#precheck="WARNING"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?WARNING\((?P<winevent_id>20189)\).*?The\s+user\s+(?P<username>\S+)\s+connected\s+from\s+(?P<src_ip>\IPV4)\s+but\s+failed.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}


[1092 - Windows Application Installed]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s+\"(?P<username>[^\"]+)\";\sSRCIP:\s\"(?:[^\"]*)\"\;\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION\:\s\"(?P<location>[^\"]*)\"\;\s+EVENT\:\s+\"\[INIT\].*?INFORMATION\((?P<wineventid>\d+)\).*?Product:\s(?P<pkg>.*?)\s--.*\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$wineventid}
userdata5={$pkg}

#
#   Windows Service Control Manager
#    Win evt IDs: 7045, 7036
#    RIDs: 800100-800102
#    ossec: alienvault-windows-service-control-manager_rules
#

[1095 - Windows Service Control Manager]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>80010\d)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?USER:\s+"(?:\(no user\)|(?P<username>[^"]+))".*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?INFORMATION\((?P<winevent_id>70\d{2})\)\:\s+Service Control Manager: [^:]+:[^:]+:\s+(?P<user_domain>[^:]+):\s+(?:The|A service was installed in the system\.\s+Service Name:)\s+(?P<service>.*?)\s+(?:service entered|Service File Name:\s+"?(?P<filename>[^"\s]+(?:(?!"?\s+Service Type)\s+[^"\s]+)*)"?\s+Service Type:\s+(?P<service_type>.*?)\s+Service Start Type:\s+(?P<service_start_type>.*?)\s+Service Account:\s+(?P<service_acc>.*?)\[END)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
filename={$filename}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$user_domain}
userdata6={$service}
userdata7={$service_type}
userdata8={$service_start_type}
userdata9={$service_acc}

#
#   Windows Defender events
#   ossec: alienvault-windows-defender_rules
#

[1096 - Windows Defender Scan events (Started 1000 - Finished 1001 - stopped 1002)]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+).*?\";\s*LOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?:\d+\s\w{3}\s\d+\s\d+:\d+:\d+)\sWinEvtLog: [^:]+:\s(?:INFORMATION|WARNING)\((?P<winevent_id>\d+)\)\:\sMicrosoft[^:]+: [^:]+: [^:]+:\s+(?P<authority>\S+)\:\s+(?P<description>.*? scan has (?:started|finished|been stopped before completion))\.\s*Scan ID: \{(?P<scanID>\S+)\}\s*Scan Type:\s(?P<scan_type>\S+)\s*Scan Parameters:\s(?P<scan_par>\S+\s*\S+?)\s*(?:Scan Resources:\s(?P<scan_res>.*?))?User:(?P<dom>[^\\]+)\\(?P<user>\S+).*?\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
username={$user}
userdata1={$winevent_id}
userdata2={$authority}
userdata3={$description}
userdata4={$scanID}
userdata5={$scan_type}
userdata6={$scan_par}
userdata7={$scan_res}
userdata8={$dom}
userdata9={$username}

[1097 - Windows Defender Malware events (Detected 1116 - Action Taken 1117)]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+).*?\";\s*LOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?:\d+\s\w{3}\s\d+\s\d+:\d+:\d+)\sWinEvtLog: [^:]+:\s(?:INFORMATION|WARNING)\((?P<winevent_id>\d+)\)\:\sMicrosoft[^:]+: [^:]+: [^:]+:\s+(?P<authority>\S+)\:\s+(?P<description>[^\.]+)\.\s*For more information please see the following:\s*(?P<url_info>\S+)\s*(?:Name:\s(?P<name>\S+)\s*|ID:\s*(?P<id>\d+)\s*|Severity:\s(?P<severity>\S+)\s*|Category:\s(?P<cat>\S+)\s*|Path:\s(?P<path>\S+)\s*|.*?User:\s(?P<dom>[^\\]+)\\(?P<user>\S+)\s*|Process Name:\s(?P<process>\S+)\s*|Action:\s(?P<action>\S+)\s*|.*?Error Code:\s(?P<error_code>\S+)\s*Error description:\s(?P<error_des>[^\.]+))+.*?\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcip}
username={$user}
filename={$path}
userdata1={$winevent_id}
userdata2={$description}
userdata3={$url_info}
userdata4={$name}
userdata5={$severity}
userdata6={$cat}
userdata7={$process}
userdata8={$action}
userdata9={$error_des}

[1098 - Windows Defender Configuration changed events (5007)]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+).*?\";\s*LOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?:\d+\s\w{3}\s\d+\s\d+:\d+:\d+)\sWinEvtLog: [^:]+:\sINFORMATION\((?P<winevent_id>\d+)\)\:\sMicrosoft[^:]+: [^:]+: [^:]+:\s+(?P<authority>\S+)\:\s+.*?Configuration has changed\.\s(?:[^\.]+)\.\s*Old value:\s(?P<old_value>[^\=]+=\s\S+)\s*New value:\s(?P<new_value>[^\[]+)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcip}
username={$username}
userdata1={$winevent_id}
userdata2={$authority}
userdata3={$old_value}
userdata4={$new_value}

[1099 - Windows Defender information events (1013,1150,2000)]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>600005|600006|600007)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+).*?\";\s*LOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<date_event>\d+\s+\w+\s+\d+\s+\d+:\d+:\d+)\s+WinEvtLog:\s+System:\s+INFORMATION\((?P<event_id>\d+)\):(?:[^:]+:){3}\s+(?P<data>[^:]+):\s+(?P<msg>[^.]+)\.\s+(?:[\W\w]*?(?:Current Signature version|\d+\s+Signature version):\s+(?P<sig_version>\S+)(?:[\W\w]*?Signature Type:\s+(?P<sig_type>\S+)\s+Update Type:\s+(?P<update_type>\S+))?)?(?:[\W\w]*?User:\s+(?P<domain>[^\\]+)\\(?P<username1>\S+(?:(?!\s\w+:)\s\S+)*))?[\W\w]*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
username={$username1}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$msg}
userdata4={$event_id}
userdata5={$data}
userdata6={$update_type}
userdata7={$sig_type}
userdata8={$sig_version}
userdata9={$domain}

[1100 - Windows Defender error event (20001)]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>7726|600050)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:none|(?P<srcip>[^\"]*))\";\sHOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+).*?\";\s*LOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<date_event>\d+\s+\w+\s+\d+\s+\d+:\d+:\d+)\s+WinEvtLog:\s+System:\s+Error\((?P<event_id>\d+)\):\s+(?:[^:]+:){3}\s+(?P<data>[^:]+):\s+(?P<msg>[^.]+)\.\s+New\s+Signature\s+Version:\s+(?P<new_sig_version>\S*)\s+Previous\s+Signature\s+Version:\s+(?P<previous_sig_version>\S*)\s+Update\s+Source:\s+(?P<update_src>\S*)\s+Update\s+Stage:\s+(?P<update_stage>\S*)\s+Source\s+Path:\s+(?P<src_path>\S*(?:(?!\s\w+:)\s\S+)*)\s+Signature\s+Type:\s+(?P<sig_type>\S*)\s+Update\s+Type:\s+(?P<update_type>\S*)\s+User:\s+(?P<domain>[^\\]+)\\(?P<username1>\S+(?:(?!\s\w+:)\s\S+)*)[\W\w]*Error\s+code:\s+(?P<error_code>\S*)\s+Error\s+description:\s+(?P<error_descr>[\W\w]*)\.\s+\[END\]"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
username={$username1}
userdata1={$error_code}
userdata2={$error_descr}
userdata3={$msg}
userdata4={$event_id}
userdata5={$data}
userdata6={$update_type}
userdata7={$sig_type}
userdata8={$src_path}
userdata9={$domain}


#
#   Windows AppLocker events
#    Win evt IDs: 8002 - 8007
#    RIDs: 110020-110025
#    ossec: alienvault-windows-applocker_rules
#

[1101 - Windows Applocker events]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>11002[0-5])\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>windows,applocker,)\";\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s"(?P<username>\S+)\";\s\S+\s"\S+;\sHOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?";\sLOCATION:.*?\[INIT\].*?WinEvtLog: Microsoft-Windows-AppLocker/(?P<lookup>[^:]+):\s+\w+\((?P<id>\d+)\):[^:]+:\s*(?P<user>[^:]+):\s(?P<domain>[^:]+):\s*(?P<host>[^:]+):\s(?P<path>.*?)\swas.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$user}
filename={$path}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$host}
userdata5={$domain}


#
# Windows Error Event <status>^ERROR</status>
# Multiple Windows Error Events <if_matched_sid>18103</if_matched_sid>
# [102 - Windows Error Event]
#

[1102 - Windows Error Event]
event_type=event
#precheck="ERROR"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?ERROR\((?P<winevent_id>\d+)\)\:\s(?:Service Control Manager:[^:]+:[^:]+:[^:]+:\s(?P<msg>.*?)(?:\s+It has done this|\.\[END))?.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$msg}


#
# Windows Warning Event <status>^WARNING</status>
# OSSEC rule disabled by default (level 0)
# Multiple Windows Warning Events <if_matched_sid>18102</if_matched_sid>
# [103 - Windows Warning Event]
#

[1103 - Windows Warning Event]
event_type=event
#precheck="WARNING"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?WARNING\((?P<winevent_id>\d+)\)\:.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}


#
# Windows Information Event <status>^INFORMATION</status>
# OSSEC rule disabled by default (level 0)
# [1104 - Windows Information Event]
#

[1104 - Windows Information Event]
event_type=event
#precheck="INFORMATION"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?INFORMATION\((?P<winevent_id>\d+)\)\:.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}

[1110 - Windows IPSec Events]
event_type=event
#precheck=""
regexp="^AV\s+\-\s+Alert\s+\-\s+\"(?P<date>\d+)\"\s+\-\->\s+RID\:\s+"(?P<rule_id>10700[1-6])"\;\s+RL\:\s+"(?P<rule_level>.*?)"\;\s+RG\:\s+"(?P<rule_group>[^\"]*)"\;\s+RC\:\s+"(?P<rule_comment>[^\"]*)"\;\s+USER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s"-]+)"?(?:->[^\"]*\")?;\s+LOCATION\:\s+"?(?P<location>[^\"]*)"?\;\s+EVENT\:\s+\"\[INIT\].*?WinEvtLog: Security: AUDIT_FAILURE\((?P<event_id>\d+)\):(?:[^:]+:){3}\s+(?P<data>[^:]+):\s*(?:\S+(?:(?!\s+Local\s|\s+Remote\s)\s+\S+)*)\s+(?:Local\s+Endpoint:\s\S*\s(?:(?:Local\s)?Principal Name:\s+-)?)?(?:(?:Local\s+)?Network\s+Address:\s+(?P<src>\d+\.\d+\.\d+\.\d+))?(?:\s*Network\s+Address\s+mask:\s+(?P<srcmask>\S+)\s+Port:\s+(?P<srcport>\d+))?.*?Remote\s+.*?Network\s+Address:\s+(?P<dst>\d+\.\d+\.\d+\.\d+)(?:\s+Address\s+Mask:\s+(?P<dstmask>\S+)\s+Port:\s+(?P<dstport>\d+))?(?:.*?Failure\s+Information:\s+.*?Failure\s+Point:\s+(?P<point>\S+)\s+Failure\s+Reason:\s+(?P<reason>\S+(?:(?!\s\w+:)\s\S+)*))?.*?\[END\]"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src}
src_port={$srcport}
dst_ip={$dst}
dst_port={$dstport}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$event_id}
userdata5={$hostname}
userdata6={$data}
userdata7={$srcmask}
userdata8={$dstmask}
userdata9={$reason}

[1120 - Windows Certificate Service Event]
event_type=event
#precheck="Certificate"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>810000|810001|810002)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s+"\((?P<host>[^\)]*)\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>\d+)\):\s+Microsoft-Windows-Security-Auditing:\s+[^:]+:[^:]+domain:\s+(?P<domain>[^\s:]+):\sCertificate Services[^.]+\.\s+(?:Request ID: (?P<req_id>\d+)\s*|Requester: (?P<domain2>[^\\]+)\\(?P<username>\S+)\s*|Serial Number:\s+(?P<serial_num>\S+)\s*|Reason:\s+(?P<reason>\d+)\s*|Attributes:\scdc:(?P<cdc>\S+)\s+rmd:(?P<rmd>\S+)\s+ccm:(?P<ccm>[^\s[]+)(?:.*?CN=(?P<common_name>[^,]+))?)+.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$host}
userdata2={$domain}
userdata3={$req_id}
userdata4={$domain2}
userdata5={$serial_num}
userdata6={$reason}
userdata7={$cdc}
userdata8={$rmd}
userdata9={$common_name}

[1130 - Windows Firewall Events]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>82000[0-5])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>windows,win_firewall,)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<dst_ip>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?AUDIT_SUCCESS\((?P<event_id>\d+)\):(?:[^:]+:){4}\s+(?P<msg>[^\s[]+(?:(?!\s\w+:)\s[^\s[]+)*)\s*(?:Profile (?:That Was )?Changed:\s+(?P<profile>\S+)\s+(?:New Setting:\s+Type:\s+(?P<type>\S+(?:(?!\s\w+:)\s\S+)*)\s+Value:\s+(?P<value>\w+)|(?:Deleted|Added|Modified)\s+Rule:\s+Rule ID:\s+(?P<rule>\S+)\s+Rule Name:\s+(?P<rulename>[^[]+))?)?\[END\]";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$dst_ip}
src_ip={$dst_ip}
dst_ip={$dst_ip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$event_id}
userdata4={$hostname}
userdata5={$profile}
userdata6={$type}
userdata7={$value}
userdata8={$rule}
userdata9={$rulename}

[1131 - Windows Firewall Events (4957|5031)]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>82000[6-7])\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>windows,win_firewall,)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<dst_ip>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?AUDIT_(?:SUCCESS|FAILURE)\((?P<event_id>\d+)\):(?:[^:]+:){3}\s+(?P<data>[^:]+):\s+[^.:]+(?::\s+Rule\s+Information:\s+ID:\s+(?P<fwrule_id>\S+)\s+Name:\s+(?P<fwrule_name>\S+(?:(?!\s\w+:)\s\S+)*)\s+Error\s+Information:\s+Reason:\s+(?P<reason>[^.]+))?(?:\.\s+Profiles:\s+(?P<rpofiles>\S+)\s+Application:\s+(?P<application>[^\[]+))?"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$dst_ip}
src_ip={$dst_ip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$event_id}
userdata4={$hostname}
userdata5={$data}
userdata6={$fwrule_id}
userdata7={$fwrule_name}
userdata8={$reason}
userdata9={$application}

[1140 - Permissions Changed]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>106008)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>windows,)\";\sRC:\s\"(?P<rule_comment>[^"]+)\.\";\sUSER:\s\"(?:\(no user\)|(?P<username>\S+))\";\sSRCIP:\s\"(?:None|(?P<srcip>[^"]*))\";\sHOSTNAME:\s+\"(?:\()?(?P<hostname>[^)\s]+)(?:\)\s(?P<ip>\d+\.\d+\.\d+\.\d+)->[^"]*)?\";\sLOCATION:\s"(?P<location>[^"]+)";\sEVENT:\s*"\[INIT\].*?AUDIT_SUCCESS\((?P<event_id>\d+)\):(?:[^:]+:){3}\s+(?P<data>[^:]+):\sPermissions\s+on\s+an\s+object\s+were\s+changed\.\s+Subject:\s+Security\s+ID:\s+(?P<sec_id>\S+)\s+Account\s+Name:\s+(?P<name>\S+)\s+Account\s+Domain:\s+(?P<domain>\S+)\s+Logon\s+ID:\s+(?P<logon>\S+)\s+Object:\s+Object\s+Server:\s+(?P<obj_server>\S+)\s+Object\s+Type:\s+(?P<obj_type>\S+)\s+Object\s+Name:\s+(?:-|(?P<obj_name>\S*))\s+Handle\s+ID:\s+(?P<handle>\S+)\s+Process:\s+Process\s+ID:\s+(?P<pid>\S+)\s+Process\s+Name:\s+(?P<process_name>\S+)\s+Permissions\s+Change:\s+(?P<change>\S*)\s+Original\s+Security\s+Descriptor:\s(?P<sec_descr>\S+)\s+New\s+Security\s+Descriptor:\s+(?P<new_sec_descr>\S+)\[END\]"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$ip}
src_ip={$ip}
dst_ip={$ip}
userdata1={$hostname}
userdata2={$event_id}
userdata3={$data}
userdata4={$sec_id}
userdata5={$name}
userdata6={$domain}
userdata7={$logon}
userdata8={$sec_descr}
userdata9={$new_sec_descr}

[1200 - Windows Logoff 3.Usuario and Dominio]
event_type=event
#precheck="18149"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s+\"(?:[^\"]+)\";\sSRCIP:\s\"(?:[^\"]*)\"\;\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION\:\s\"(?P<location>[^\"]*)\"\;\s+EVENT\:\s+\"\[INIT\](?P<log>.*?)Nombre\sde\susuario\:\s*(?P<username>.*?)\s+Dominio\:\s*(?P<domain>.*?)\s+Id[^\:]+:\s+(?P<logonid>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$domain}
userdata2={$logonid}
userdata3={$rule_comment}
userdata4={$rule_group}


[1201 - DC Directory Service Object move]
event_type=event
#precheck="101003"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"[^"]+\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\s+(?:(?!AUDIT_SUCCESS)[^\s]+\s+)+AUDIT_SUCCESS\(5139\)(?:(?!Account Name:)[^\s]+\s+)+Account Name:\s+(?P<account_name>.*?)\s+Account Domain:\s+(?P<account_name_domain>.*?)\s+Logon\s+(?:(?!Object:)[^\s]+\s+)+Object:\s+Old\sDN:\s+(?P<oldobject_name>(?:(?!New DN:)\S+\s+)+)\s+New\sDN:\s+(?P<newobject_name>(?:(?!GUID:)\S+\s+)+)\s+GUID:.*?Class:\s+(?P<class>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
username={$account_name}
userdata1={$account_name_domain}
userdata2={$class}
userdata3={$oldobject_name}
userdata4={$newobject_name}
userdata5={$rule_level}


[1202 - DC Directory Service Object create, modify or delete]
event_type=event
#precheck="A directory service object"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^\"]*)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"\(?(?P<hostname>[\w-]+)\)?[^"]*";.*?(?:AUDIT\_SUCCESS\((?P<event>5137|5141|5136)\)).*?(?:Account Name:\s+(?P<account_name>.*?))\s+(?:Account Domain:\s+(?P<account_name_domain>.*?))\s+Logon ID:\s*(?P<logon>\S*).*?Type:\s*(?P<type>\S*).*?(?:Object:\s+DN:\s+(?P<object_name>.*?))\s+GUID:.*?(?:Class:\s+(?P<class>\S+))(?:.*?(?P<object2>CN=.*?)\s+Operation:)?"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
username={upper($account_name)}
userdata1={$account_name_domain}
userdata2={$class}
userdata3={$object_name}
userdata4={$object2}
userdata5={$logon}
userdata6={$type}
userdata7={$event}

[1210 - Network share object (5145)]
event_type=event
#precheck=""
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^\"]*)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?(?:AUDIT\_(?:SUCCESS|FAILURE)\((?P<event>5145)\)):(?:[^:]+:){3}\s+(?P<data>[^:]+):\s+(?P<secure_group>\S+)\s+(?P<computer_name>\S+)\s+(?P<type>\S+)\s+(?P<data2>\S+)\s+File\s+(?:(?P<src>\d+\.\d+\.\d+\.\d+)\s+(?P<srcport>\d+))?(?P<file>(?:[^.]+\.\w+)*)\s+(?P<data3>\S+)\s+(?P<access>[^\s[]+)"
date={normalize_date($date)}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
device={$winip}
src_ip={$src}
src_port={$srcport}
dst_ip={$winip}
filename={$file}
userdata1={$rule_level}
userdata2={$event}
userdata3={$data}
userdata4={$secure_group}
userdata5={$computer_name}
userdata6={$type}
userdata7={$data2}
userdata8={$data3}
userdata9={$access}


[1220 - State of a transaction (4985)]
event_type=event
#precheck=""
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^\"]*)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?(?:AUDIT\_SUCCESS\((?P<event>4985)\)):(?:[^:]+:){3}\s+(?P<data>[^:]+):\s+[^.]+\.\s+Subject:\s+Security\s+ID:\s+(?P<security>\S+)\s+Account\s+Name:\s+(?P<account>\S+)\s+Account\s+Domain:\s+(?P<domain>\S+)\s+Logon\s+ID:\s+(?P<logon>\S+)\s+Transaction\s+Information:\s+RM\s+Transaction\s+ID:\s+(?P<id>\S+)\s+New\s+State:\s+(?P<state>\d+)\s+Resource\s+Manager:\s+(?P<resource>\S+).*?Process\s+Name:\s+(?P<process>[^[\s]+)"
date={normalize_date($date)}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
userdata1={$resource}
userdata2={$event}
userdata3={$data}
userdata4={$security}
userdata5={$account}
userdata6={$domain}
userdata7={$logon}
userdata8={$id}
userdata9={$state}


[1360 - Microsoft_Windows with username instead of Account Name]
event_type=event
#precheck="Special privileges assigned to new logon"
regexp="^AV\s+\-\s+Alert\s+\-\s+\"(?P<date>\d+)\"\s+\-\->\s+RID\:\s+"(?P<rule_id>\d+)"\;\s+RL\:\s+"(?P<rule_level>.*?)"\;\s+RG\:\s+"(?P<rule_group>[^\"]*)"\;\s+RC\:\s+"(?P<rule_comment>[^\"]*)"\;\s+.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s"-]+)"?(?:->[^\"]*\")?;\s+LOCATION\:\s+["][^\"]*["]\;\s+EVENT\:\s+\"\[INIT\].*?WinEvtLog: Security: (?:(?!AUDIT_SUCCESS)[^\s]*\s)*AUDIT_SUCCESS\((?P<winevent_id>[^)]+)\)(?:(?!Special privileges)[^\s]*\s)*Special privileges assigned to new logon(?:(?!(?:Account|User)\s+Name)[^\s]*\s)*(?:User|Account)\s+Name\:\s+(?P<username>.*?)\s+(?:Account\s)?Domain\:\s+(?P<domain>.*?)\s+Logon\s+ID\:\s+[^\"]*"\;"
date={normalize_date($date)}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
username={$username}
userdata1={$domain}
userdata2={$rule_level}
userdata3={$rule_group}
userdata4={$winevent_id}
userdata5={$rule_comment}
userdata9={$username}


[1361 - Microsoft_Windows_AudiSuccess with Account Name]
event_type=event
#precheck="Account Name"
regexp="^AV\s+\-\s+Alert\s+\-\s+["](?P<date>\d+)["]\s+\-\-\>\s+RID\:\s+["](?P<rule_id>\d+)["]\;\s+RL\:\s+["][^\"]*["]\;\s+RG\:\s+["][^\"]*["]\;\s+RC\:\s+["][^\"]*["]\;\s+.*?HOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\s+LOCATION\:\s+["][^\"]*["]\;\s+EVENT\:\s+["].*?Account\s+Name\:\s+(?P<username>.*?)\s+Account\s+Domain\:\s+(?P<domain>.*?)\s+Logon\s+ID\:\s+.*?\s+Network\s+Information\:\s+.*?Object\s+Type\:\s+(.*?)\s+Source\s+Address\:\s+(?P<src_ip>.*?)\s+Source\s+Port\:\s+(?P<src_port>.*?)\s+[^\"]*["]"
date={normalize_date($date)}
device={$winip}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
src_ip={$src_ip}
dst_ip={$winip}
src_port={$src_port}
username={$username}
userdata1={$domain}
userdata9={$username}

[1362 - The Windows Filtering Platform blocked a packet or a connection]
event_type=event
#precheck="The Windows Filtering Platform blocked a packet"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>51000[0-1]|110000)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?(?P<event_description>The Windows Filtering Platform blocked a packet|Windows Filtering Platform has blocked a connection).*?Source Address:\s+(?P<srcnetip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+Source Port:\s+(?P<srcnetport>\d+)\s+Destination Address:\s+(?P<dstnetip>\S+)\s+Destination Port:\s+(?P<dstnetport>\d+)\s+Protocol:\s+(?P<proto>\d+).*?\[END\]\"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcnetip}
src_port={$srcnetport}
dst_ip={$dstnetip}
dst_port={$dstnetport}
userdata1={$event_description}
userdata2={$location}
userdata5=RC: {$rule_comment}
userdata6=RG: {$rule_group}
userdata7=RL: {$rule_level}


[1363 - Windows Source and Dest Network]
event_type=event
#precheck="Source Address"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?Source Address:\s+(?P<srcnetip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+Source Port:\s+(?P<srcnetport>\d+)\s+Destination Address:\s+(?P<dstnetip>\S+)\s+Destination Port:\s+(?P<dstnetport>\d+)\s+Protocol:\s+(?P<proto>\d+).*?\[END\]\"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcnetip}
src_port={$srcnetport}
dst_ip={$dstnetip}
dst_port={$dstnetport}
userdata2={$location}
userdata5={$rule_comment}
userdata6={$rule_group}


[1366 - Windows Authentication Success 3.Nombre and Origen]
event_type=event
#precheck='18107'
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";\sUSER:\s+\"(?:[^\"]+)\";\sSRCIP:\s\"(?:[^\"]*)\"\;\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION\:\s\"(?P<location>[^\"]*)\"\;\s+EVENT\:\s+\"\[INIT\](?P<log>.*?)Nombre\sde\susuario\:\s*(?P<username>.*?)\s+Dominio\:\s*(?P<domain>.*?)Id[^\:]*:\s+(?P<logonid>\S+).*?red\sde\sorigen:\s+(?P<srcip>\S+)\s+Puerto\sde\sorigen:\s+(?P<srcport>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcip}
dst_ip={$winip}
src_port={resolv_port($srcport)}
username={$username}
userdata1={$domain}
userdata2={$logonid}
userdata3={$rule_comment}
userdata4={$rule_group}

[1367 - Windows audit log was cleared]
event_type=event
#precheck='18118'
regexp="^AV\s+\-\s+Alert\s+\-\s+\"(?P<date>\d+)\"\s+\-\->\s+RID\:\s+"(?P<rule_id>\d+)"\;\s+RL\:\s+"(?P<rule_level>.*?)"\;\s+RG\:\s+"(?P<rule_group>[^\"]*)"\;\s+RC\:\s+"(?P<rule_comment>[^\"]*)"\;\s+USER:\s\"(?P<username>[^"]*)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s"-]+)"?(?:->[^\"]*\")?;\s+LOCATION\:\s+"?(?P<location>[^\"]*)"?\;\s+EVENT\:\s+\"\[INIT\].*?WinEvtLog: Security: (?:(?!AUDIT_SUCCESS)[^\s]*\s)*AUDIT_SUCCESS\((?P<winevent_id>[^)]+)\):[^:]+:\s(?P<user>[^:]+):\s[^:]+:\s(?P<domain>[^:]+):\s(?P<security_id>\S+)\s(?P<account_name>\S+)\s(?P<domain_name>\S+)\s(?P<logon_id>\S+)\s\[END\]";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$account_name}
userdata1={$domain_name}
userdata2={$logon_id}
userdata3={$rule_comment}
userdata4={$rule_group}
userdata5={$domain}
userdata6={$security_id}
userdata7={$rule_level}

[1368 - Windows ADFS event]
event_type=event
#precheck='100401'
regexp="^AV\s+\-\s+Alert\s+\-\s+\"(?P<date>\d+)\"\s+\-\->\s+RID\:\s+"(?P<rule_id>\d+)"\;\s+RL\:\s+"(?P<rule_level>.*?)"\;\s+RG\:\s+"(?P<rule_group>[^\"]*)"\;\s+RC\:\s+"(?P<rule_comment>[^\"]*)"\;\s+USER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s"-]+)"?(?:->[^\"]*\")?;\s+LOCATION\:\s+"?(?P<location>[^\"]*)"?\;\s+EVENT\:\s+\"\[INIT\].*?WinEvtLog: Security: (?:(?!AUDIT_SUCCESS)[^\s]*\s)*AUDIT_SUCCESS\((?P<winevent_id>[^)]+)\):[^:]+:\s(?P<user>[^:]+):\s[^:]+:\s(?P<domain>[^:]+):\s(?P<logon_id>\S+)\s(?P<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s(?P<url>\S+)\s(?P<sid>The\sclient\swas\sauthenticated)(?:\s[^']+'(?P<thumbprint>[^']+)'\sand\ssubject\s'(?P<subject>[^']+)')?[^\[]+\[END\]"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$ip}
dst_ip={$winip}
username={$username}
userdata1={$domain}
userdata2={$logon_id}
userdata3={$rule_comment}
userdata4={$rule_group}
userdata5={$thumbprint}
userdata6={$subject}
userdata7={$url}
userdata8={$rule_level}

[1370 - Windows Source Network]
event_type=event
#precheck="Source Network Address"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?Account Name:\s+(?P<accountname>\S+).*?Account Name:\s+(?P<accountname2>\S+).*?Domain:\s+(?P<domain>\S+).*?ID:\s+(?P<logonid>\S+).*?Source Network Address:\s(?P<srcnetip>(?:\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|-)).*?\[END\]\"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcnetip}
dst_ip={$winip}
username={$accountname2}
userdata1={$accountname}
userdata2={$location}
userdata3={$domain}
userdata4={$logonid}
userdata5={$rule_comment}
userdata6={$rule_group}


[1371 - Windows error event]
event_type=event
#precheck="181"
regexp=^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>18103|18154)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>.*)\[END\]\";
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$log}


[1372 - Windows audit event]
event_type=event
#precheck="Windows Audit event"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>512)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>Windows Audit event.)\";\sUSER:\s\"(?:None|(?P<username>\S+))\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>Windows Audit:(?P<msg>.*).)\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$msg}


[1373 - SEC ENABLED UNIVERSAL GROUP MEMBER ADDED]
event_type=event
#precheck="18214"
regexp="AV\s+\-\s+Alert\s+\-\s+["](?P<date>\d+)["]\s+\-\-\>\s+RID\:\s+["](?P<rule_id>18214)["]\;\s+RL\:\s+["](?P<rulelvl>\d+)["]\;\s+RG\:\s+["](?P<desc>[^\"]*)["]\;\s+.*?HOSTNAME\:\s+["]\([^\)]*\)\s+(?P<hostname>\d+\.\d+\.\d+\.\d+)\-\>.*?Account\s+Name\:\s+(?P<user>.*?)\s+Account\s+Domain\:\s+(?P<domain>.*?)\s+.*?Account\s+Name\:\s+CN\=(?P<username>.*?)\,OU\=(?P<ou>.*?)\,DC\=.*?Account\s+Name\:\s+(?P<username3>.*?)\s+.*?["]\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$user}
userdata1={$domain}
userdata2={$username}
userdata3={$username3}
userdata5={$rulelvl}
userdata6={$desc}
userdata7={$ou}
userdata9={$user}


[1374 - WINDOWS GROUP ACCOUNT CHANGED]
event_type=event
#precheck="18114"
regexp="AV\s+\-\s+Alert\s+\-\s+["](?P<date>\d+)["]\s+\-\->\s+RID\:\s+["](?P<rule_id>18114)["]\;\s+RL\:\s+["](?P<rulelvl>\d+)["]\;\s+RG\:\s+["](?P<desc>[^\"]*)["]\;\s+.*?HOSTNAME\:\s+["]\([^\)]*\)\s+(?P<hostname>\d+\.\d+\.\d+\.\d+)\->.*?Account\s+Name\:\s+(?P<user>.*?)\s+Account\s+Domain\:\s+(?P<domain>.*?)\s+(?:.*?Logon\s+ID\:\s+(?P<logon_id>\S+).*?(?:Group)\s+Name\:\s+(?P<group_name>.*?)(?:\s+(?:Group|Account))\s+Domain\:\s+(?P<group_domain>\S+))?.*?["]\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$user}
userdata1={$domain}
userdata2={$desc}
userdata3={$logon_id}
userdata4={$group_name}
userdata5={$group_domain}
userdata9={$user}


[1380 - Security Enabled Global Group Changed]
event_type=event
#precheck="Security Enabled Global Group Changed"
regexp="AV\s+\-\s+Alert\s+\-\s+\"(?P<date>\d+)\"\s+-->\s+RID\:\s+\"(?P<rule_id>18211)\"\;\s+RL\:\s+\"(?P<rulelvl>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]+)\"\;\s+RC:\s\"(?P<rule_comment>[^\"]+)\";.*?HOSTNAME\:\s+\"\([^\)]*\)\s+(?P<hostname>\d+\.\d+\.\d+\.\d+)->.*?Account\s+Name\:\s+(?P<user>.*?)\s+Account\s+Domain\:\s+(?P<domain>.*?)\s+.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
username={$user}
userdata1={$domain}
userdata3={$rule_group}


[1381 - Windows User Account Lock out]
event_type=event
#precheck="18116"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>18116)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>User account locked out [^\"]+)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?Caller Machine Name: (?P<callermachinename>\S+) Caller User Name: (?P<callerusername>\S+)[^\"]+\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$callerusername}
userdata1={$callermachinename}

[1382 - Windows Logon Failure Account Locked out]
event_type=event
#precheck="18138"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>18138)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]+)\";\sUSER:\s\"(?P<username>[^\"]*)\";\sSRCIP:\s\"[^\"]*\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?Network\s+Address:\s+(?P<srcip>\S+)\s+Source\s+Port:\s+(?P<srcport>\d+)[^\"]+\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcip}
dst_ip={$winip}
src_port={$srcport}
username={$username}
userdata1={$rule_group}
userdata2={$rule_comment}


[1385 - Windows clock skew]
event_type=event
#precheck="1817"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>1817\d)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]+)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\].*?User Name:\s+(?P<logonusername>\S+)[^\"]+\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$logonusername}


[1387 - Windows Audit Multiple Failure]
event_type=event
#precheck="18153"
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>18153)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>[^\"]*)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:[^\)]*\)\s(?P<winip>\S+)->[^\"]*\";\sLOCATION:\s\"(?P<location>[^\"]*)\";\sEVENT:\s\"\[INIT\](?P<log>).*\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}

[1388 - Windows Audit Failure: Attempt to reset password]
event_type=event
#precheck="18105"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>18105)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^"]*)\";\sUSER:\s+\"[^"]+\";\sSRCIP:\s\"(?P<srcip>[^"]*)\"\;\sHOSTNAME:\s+\"\((?P<hostname>[^)]+)\)\s(?P<winip>\S+)->[^"]*\";\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\](?P<log>.*?An\sattempt\swas\smade\sto\sreset\san\saccount's\spassword.*?Account\sName:\s+(?P<username>.*?)\s+Account\sDomain[^[]*)\[END\]\"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid=102000
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}


[1391 - Windows device detected]
event_type=event
#precheck="100052"
regexp="AV\s+-\sAlert\s+-\s"(?P<date>\d+)"\s-->\sRID:\s"(?P<rule_id>100052)";\s+RL:\s+.*?USER:\s+"[^"]+";\sSRCIP:\s"[^"]*";\sHOSTNAME:\s+"\((?P<hostname>[^)]+)\)\s(?P<src_ip>[^-\s]*)\s*->WinEvtLog";[^[]+\[INIT].*?AUDIT_SUCCESS\(6416\):[^:]+:[^:]+:[^:]+:\s+(?P<computer>[^:]+):\s+\S+\s+(?P<username>\S+)\s+(?P<domain>.*?)\s+(?P<logon_id>0x\S+)\s+(?P<dvc_id>\S+)\s+(?P<dvc_desc>.*?)\s+[({](?P<class_id>\S+)[})]\s+(?P<class_name>[^[]+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
src_ip={$src_ip}
device={$computer}
username={$username}
userdata1={$domain}
userdata2={$logon_id}
userdata3={$dvc_id}
userdata4={$dvc_desc}
userdata5={$class_id}
userdata6={$class_name}

[1392 - Windows User Account Locked Out]
event_type=event
#precheck="User account locked out"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^"]*)\";\sUSER:\s+\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?P<srcip>[^"]*)\"\;\sHOSTNAME:\s+\"\((?P<hostname>[^)]+)\)\s(?P<winip>\S+)->[^"]*\";\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\](?P<log>[^[]*)Account Name\: (?P<name>(\w|\s)+) Additional[^[]*\[END\]\"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$name}
userdata1={$log}
userdata2={$hostname}
userdata3={$location}
userdata4={$rule_comment}
userdata5={$rule_group}


[1393 - Excessive Number of Events]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^"]*)\";\sUSER:\s+\"(?:\(no user\)|(?P<username>[^"]+))\";\sSRCIP:\s\"(?P<srcip>[^"]*)\"\;\sHOSTNAME:\s+\"\((?P<hostname>[^)]+)\)\s(?P<winip>[^-]*)->[^"]*\";\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\](?P<log>The average number of logs between (?P<begin>\S+) and (?P<end>\S+) is (?P<average>\d+). We reached (?P<events_number>\d+).[^[]*)\[END\]\"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$log}
userdata2={$hostname}
userdata3={$location}
userdata4={$rule_comment}
userdata5={$rule_group}
userdata6={$average}
userdata7={$events_number}
userdata8={$begin}
userdata9={$end}

[1394 - Windows File Audit Success]
event_type=event
#precheck="Windows file"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>file,audit,)\"\;\s+RC\:\s+"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)[^;]*;.*?AUDIT_SUCCESS\((?P<winevent_id>\d+)\).+?Account Name:\s+(?P<account_name>\S+)\s+Account Domain:\s+(?P<domain>\S*)\s*Logon ID:\s*(?P<logon>\S*).*?Object\sName\:\s+(?P<file_name>.*?)\s+Handle.+?Accesses\:(?P<action>\s+\%%\d+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$account_name}
filename={$file_name}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$action}
userdata4={$winevent_id}
userdata5={$logon}
userdata6={$domain}

[1395- Windows Handle to Object Requested]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>106000|106001|12013|110004)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^"]*)\";\sUSER:\s+\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?P<srcip>[^"]*)\"\;\sHOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s\-"]+)[^;]*;\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\].*?handle\s+to\s+an\s+object\s+was\s+requested.*?Account\s+Name:\s+(?P<account>.*?)\s+Account\s+Domain:\s+(?P<domain>.*?)\s+Logon\s+ID:\s+(?P<logon>\S*).*?Object Type:\s+(?P<obj_type>\S+)\s+Object\s+Name:\s+(?P<filename>.*?)\s+Handle\s+ID(?:(?!Accesses:)[^\s]+\s+)+Accesses:\s+(?:-|%+(?P<acc1>\d+)\s+(?:%+(?P<acc2>\d+)\s+)?(?:%+(?P<acc3>\d+)\s+)?)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$account}
filename={$filename}
userdata1={$location}
userdata2={$logon}
userdata3={$rule_group}
userdata4={$rule_level}
userdata5={$domain}
userdata6={$acc1}
userdata7={$acc2}
userdata8={$acc3}
userdata9={$obj_type}

[1396- Windows Event Log Cleared]
event_type=event
#precheck="Event Log cleared"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>18150)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^"]*)\";\sUSER:\s+\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?P<srcip>[^"]*)\"\;\sHOSTNAME:\s+\"\((?P<hostname>[^)]+)\)\s(?P<winip>\S+)->[^"]*\";\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\](?P<log>[^[]*)\[END\]\"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcip}
dst_ip={$winip}
username={$username}
userdata1={$log}
userdata2={$hostname}
userdata3={$location}
userdata4={$rule_comment}
userdata5={$rule_group}

[1397 - Windows USB Storage]
event_type=event
#precheck="100051"
regexp='AV\s+-\sAlert\s+-\s"(?P<date>\d+)"\s-->\sRID:\s"(?P<rule_id>100051)";\s+RL:\s+.*?USER:\s+"(?P<username>[^"]+)";\sSRCIP:\s"[^"]*";\sHOSTNAME:\s+"\((?P<hostname>[^)]+)\)\s(?P<src_ip>[^-]*)->.*\s+(?P<drive>[B-Z]:)\s+(?P<filesystem>\w+)\s+(?P<size>\d+)\s+(?:(?P<volume_name>\S+)\s+)?(?P<volume_serial_number>\S+)\s+.*?\[END\]'
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
src_ip={$src_ip}
device={$hostname}
username={$username}
userdata1=Drive: {$drive}
userdata2=FileSystem: {$filesystem}
userdata3=Size: {$size}
userdata5=Volume Serial Number: {$volume_serial_number}
userdata6=Volume Name: {$volume_name}

[1398 - Windows USB Storage no drive info]
event_type=event
#precheck="100051"
regexp='AV\s+-\sAlert\s+-\s"(?P<date>\d+)"\s-->\sRID:\s"(?P<rule_id>100051)";\s+RL:\s+.*?USER:\s+"(?P<username>[^"]+)";\sSRCIP:\s"[^"]*";\sHOSTNAME:\s+"\((?P<hostname>[^)]+)\)\s(?P<src_ip>\S+)->'
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
src_ip={$src_ip}
device={$hostname}
username={$username}

[1399 - Windows Session reconnected/disconnected to winstation]
event_type=event
#precheck="18109"
regexp="AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\((?P<hostname>[^\)]*)\))?\s*(?P<winip>[^\s"-]+)(?:->[^"]+)?"?(?:(?!AUDIT_FAILURE)[^\s]*\s)*AUDIT_SUCCESS\((?P<winevent_id>4779|4778)\)(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>[^\s@]+)(?:@(?P<domain>\S+))?(?:(?!Account\s+Domain)[^\s]*\s)*Account\s+Domain\:\s+(?P<account_domain>\S+)(?:(?!Logon\s+ID)[^\s]*\s)*Logon\s+ID\:\s+(?P<logon_id>\S+)(?:(?!Session\s+Name)[^\s]*\s)*Session\s+Name\:\s+(?P<session_name>\S+)(?:(?!Client\s+Name)[^\s]*\s)*Client\s+Name\:\s+(?P<client_name>\S+)(?:(?!Client\s+Address)[^\s]*\s)*Client\s+Address\:.*?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
dst_ip={$winip}
username={$username}
userdata1={$rule_comment}
userdata2={$rule_group}
userdata3={$logon_id}
userdata4={$session_name}
userdata5={$client_name}

######################################################
# WINDOWS FORWARDED EVENTS
######################################################

[1400 - Windows Logon Success]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?USER:\s\"(?P<username>[^"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>4624)\).*?\S-\d-\d-\d+-\d+-\d+-\d+-\d+\s(?P<user2>\S+).*?(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcip}
dst_ip={$winip}
username={$user2}
userdata4={$rule_comment}
userdata5={$rule_group}

[1401 - Failed Privileged operation]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>\d+)\).*?\S-\d-\d-\d+-\d+-\d+-\d+-\d+\s(?P<user2>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
dst_ip={$winip}
username={$user2}
userdata4={$rule_comment}
userdata5={$rule_group}

[1402 - Failure with username]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>\d+)\).*?0x\S+\s+S-\d-\d-\d+\s(?P<user2>\S+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
dst_ip={$winip}
username={$user2}
userdata4={$rule_comment}
userdata5={$rule_group}


######################################################
# WINDOWS AUDIT SUCCESS/FAILURE EVENTS
######################################################

#
# Windows Audit Success <status>^AUDIT_SUCCESS|^success</status>
# OSSEC rule disabled by default (level 0)
# [100 - Windows Audit Success]
#

[1488 - Windows Audit Success]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>\d+)\).*?Process ID:\s+(?P<process_id>\S+)\s+Process Name:\s+(?P<process_name>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}


[1489 - Windows Audit Failure with Client Address]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>\d+)\).*?Client\s+Address:\s+(?P<src_ip>\S+)\s+Client\s+Port:\s+(?P<sport>\d+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
src_port={$sport}
dst_ip={$winip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}


#
# Windows Audit Failure <status>^AUDIT_FAILURE|^failure</status>
# Multiple Windows Audit Failure Events <if_matched_sid>18105</if_matched_sid>
# [101 - Windows Audit Failure]
#

[1490 - Windows Audit Failure with Process ID]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>\d+)\)(?:(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>\S+)\s+Account\sDomain\:\s+(?P<domain>\S+))?(?:(?!Process\s+ID)[^\s]*\s)*Process ID:\s+(?P<process_id>\S+)\s+Process Name:\s+(?P<process_name>\S+).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$process_id}
userdata6={$process_name}
userdata7={$domain}

[1495 - Windows Audit Failure with Account name - 18105]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>18105)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>\d+)\)(?:(?!Account\s+Name)[^\s]*\s)*Account\s+Name\:\s+(?P<username>\S+)\s+Account\sDomain\:\s+(?P<domain>\S+)(?:(?:(?!Client\s+IP\s+Address)[^\s]*\s)*Client\sIP\sAddress:\s+(?P<client_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$client_ip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$domain}

[1496 - Windows Audit Failure with Error code - (102009|510002)]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>102009|510002)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>\d+)\):(?:[^:]+:){3}\s+(?P<data>[^:]+):.*?Error\s+Code:\s+(?P<error>\d+|[^.]+)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$data}
userdata6={$error}


[1498 - Windows Audit Success]
event_type=event
#precheck="AUDIT_SUCCESS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:[^\)]*\)\s(?P<winip>\S+)->.*?AUDIT_SUCCESS\((?P<winevent_id>\d+)\).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}


#
# Windows Audit Failure <status>^AUDIT_FAILURE|^failure</status>
# Multiple Windows Audit Failure Events <if_matched_sid>18105</if_matched_sid>
# [101 - Windows Audit Failure]
#

[1499 - Windows Audit Failure]
event_type=event
#precheck="AUDIT_FAILURE"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?\((?P<hostname>[^\)]*)\)\s(?P<winip>\S+)->.*?AUDIT_FAILURE\((?P<winevent_id>\d+)\).*?no\sdomain:\s*(?P<domain>[^:]*).*?Logon\sAccount:\s*(?P<username>[^@\s]*)(?:@(?P<domain2>\S*))?\s*Source\sWorkstation:\s*(?P<workstation>\S*).*?Error.*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$winevent_id}
userdata5={$hostname}
userdata6={$workstation}
userdata7={$domain}
userdata8={$domain2}


######################################################
# WINDOWS WEB EVENTS
######################################################

[1500 - Multiple XSS]
event_type=event
#precheck="Multiple XSS"
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>(?:Multiple)? XSS \(Cross Site Scripting\)|[^"]*)\";\sUSER:\s+\"(?:None|(?P<username>[^"]+))\";\sSRCIP:\s\"(?:None|(?P<src_ip>[^"]*))\"\;\sHOSTNAME:\s+\"\(?(?P<hostname>[^)]+|[^"]+)(?:\)\s(?:any|(?P<dst_ip>[^-\s]+))->[^"]*)?\";\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\].*?(?P<method>GET|POST|HEAD|PUT|DELETE|TRACE|CONNECT|OPTIONS)\s+(?P<resource>https?://[^\s/]+|\S+)\S*\s+\S+\s+(?P<http_code>\d+).*\[END\]"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$src_ip}
dst_ip={$dst_ip}
username={$username}
userdata1={$location}
userdata2={$rule_comment}
userdata3={$rule_group}
userdata4={$method}
userdata5={$resource}
userdata6={$http_code}

#
#   Windows audit failure SAM Express (3)
#   <if_matched_sid>18105</if_matched_sid>
#   <id>3</id>
#
[1600 - SAM Express Audit Failure (3)]
event_type=event
#precheck=""
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>104000|110001)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"[^"]*\";\sSRCIP:\s\"[^"]*\";\sHOSTNAME:\s\"\(?(?P<hostname>[^\"\)]*)(?:\)[^\"\)]*)?"; LOCATION:\s"[^"]*"; EVENT:\s"\[INIT\]\d+\s+\w+\s+\d+\s+\d+:\d+:\d+\s+WinEvtLog:\s+SAM Express:\s+AUDIT_FAILURE\(3\):\s+(?P<dst_ip>[^:]*):\s*[^:]*:[^:]*:\s+(?P<computer_name>\S+):\s+Information:\s+User ID:\s+(?P<username>\S+)\sClient Type:\s+(?P<client_type>\S+)\s*Client Address:\s+(?P<src_ip>\S+)\s+Status text:\s+(?P<msg>[^\[]*).*"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$src_ip}
dst_ip={$dst_ip}
username={$username}
userdata1={$rule_level}
userdata2={$computer_name}
userdata3={$rule_comment}
userdata4={$rule_group}
userdata5={$client_type}
userdata6={$msg}

#
#   Windows powershell events
#    Win evt IDs: 800
#    RIDs: 100350
#    ossec: alienvault-windows-powershell_rules
#

[1700 - Windows Powershell events]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+)(?:(?!INFORMATION)\S+\s)+INFORMATION\((?P<winevent_id>800)\): .*?Pipeline execution details for command line:.*?UserId=(?P<domain>[^\\]+)\\(?P<username>\S+)\s+HostName=(?P<hostname>.*?)\s+HostVersion=\S+\s+HostId=(?P<hostid>\S+)\s+HostApplication=(?P<host_application>.*?)\s+EngineVersion=\S+\s+RunspaceId=(?P<runspace_id>\S+)\s+PipelineId=(?P<pipe_id>\S+)\s+ScriptName=(?P<script_name>.*?)\s+CommandLine=\s*(?P<cmd_line>.*?)\s+Details:\s+"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$winip}
dst_ip={$winip}
username={$username}
filename={$script_name}
userdata1={$rule_level}
userdata2={$rule_group}
userdata3={$rule_comment}
userdata4={$hostname}
userdata5={$domain}
userdata6={$cmd_line}
userdata7={$host_application}
userdata8={$runspace_id}
userdata9={$pipe_id}

#
#   Windows DHCP events
#    ossec: alienvault-windows-DHCP_rules
#

[1800 - Windows DHCP events]
event_type=event
#precheck=""
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^\"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^\"]*)\";.*?HOSTNAME\:\s*"?(?:\([^\)]*\))?\s*(?P<winip>[^\s"\-]+).*?EVENT:\s*"\[INIT\]\d\d,\d+/\d+/\d+,\d+:\d+:\d+,(?P<Description>[^,]*),(?P<src_ip>[^,]*),(?P<ReportedHostname>[^,]*),(?P<MACAddress>[^,]*),(?:(?P<domain>[^\\,]+)\\+)?(?P<UserName>[^,]*),(?P<TransactionID>[^,]*),(?P<QResult>[^,]*),(?P<Probationtime>[^,]*),(?P<CorrelationID>[^,]*)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$src_ip}
username={$UserName}
userdata1={$ReportedHostname}
userdata2={$MACAddress}
userdata3={$TransactionID}
userdata4={$QResult}
userdata5={$Probationtime}
userdata6={$CorrelationID}
userdata7={$domain}

[2000 - User authentication failure (2501) with destination and source IP addresses]
event_type=event
regexp="^AV - Alert - \"(?P<date>\d+)\" --> RID: "(?P<rule_id>2501)"; RL: "\d+"; RG: "(?P<rule_group>syslog,access_control,authentication_failed,)"; RC: \"(?P<rule_comment>[^\"]*)"; USER: \"(?P<username>\S+)\"; SRCIP: \"(?P<srcip>[^\"]*)\"; HOSTNAME:\s\"(?P<agent_name>\([^\)]*\)\s+)?(?:\S+@)?\(?(?P<hostname>(?(agent_name)(?:\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})|(?:[^)\s]*)))(?:->\S+)?"; LOCATION: \"(?P<location>[^\"]*)\"; EVENT: "\[INIT\]\S+\s\d+\s+\d+:\d+:\d+\s\d+\.\d+\.\d+\.\d+\s+date=\S+\stime=\S+\sdevname="?(?P<devname>[^\s"]+(?:(?!["\s]+\w+=)\s+[^"\s]+)*)?["\s]+devid=\S+\s+logid=\S+\s+type=\S+\s+subtype=\S+\s+level="(?P<level>[^"]+)"\s+vd="(?P<vd>[^"]+)"\s+(?:event|log)time=\S+\s+logdesc="(?P<desc>[^"]+)"\s+(?:action="(?P<action>[^"]+)"\s+|result="(?P<result>[^"]+)"\s+|reason="(?P<reason>[^"]+)"\s+|status="(?P<status>[^"]+)"\s+|module="(?P<module>[^"]+)"\s+|msg="(?P<msg>[^"]+)"\s*|sn="(?P<sn>[^"]+)"\s+|user="(?P<user>[^"]+)"\s+|ui="(?P<ui>[^"]+)"\s+|method="(?P<method>[^"]+)"\s+|srcip=(?P<src>\S+)\s+|dstip=(?P<dst>\S+)\s+)+\[END\]\";"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$src}
dst_ip={$dst}
username={$user}
userdata1={$rule_group}
userdata2={$devname}
userdata3={$level}
userdata4={$desc}
userdata5={$msg}
userdata6={$reason}
userdata7={$method}
userdata8={$module}
userdata9={$status}

[2100 - Mail Scanner spam detected]
event_type=event
regexp="^AV - Alert - "(?P<date>\d+)" --> RID: "(?P<rule_id>3702)"; RL: "\d+"; RG: "(?P<rule_group>syslog,mailscanner,spam,)"; RC: "(?P<rule_comment>[^"]*)"; USER: "(?P<username>\S+)"; SRCIP: "(?P<srcip>[^"]*)"; HOSTNAME:\s+"(?P<hostname>[^"]*)";\s+LOCATION:\s+"(?P<location>[^"]*)"; EVENT: "\[INIT\]\S+\s+\d+\s+\d+:\d+:\d+\s+\S+\s+\w+\[(?P<uid>\d+)\]:\s+Message\s+(?P<message>\S+)\s+from\s+(?P<scr>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+\((?P<src_mail>[^\)]*)\)\s+to\s+(?P<spam_destination>\S+)\s+is\s+spam,\s+\S+(?:\S+\s+(?:(?!score=)\S+\s+)*)score=(?P<score>[^,]*)"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$hostname}
src_ip={$srcip}
userdata1={$location}
userdata2={$uid}
userdata3={$message}
userdata4={$src_mail}
userdata5={$spam_destination}
userdata6={$score}

[9998 - Windows generic rule]
event_type=event
regexp="^AV\s+\-\sAlert\s+\-\s\"(?P<date>\d+)\"\s\-\->\sRID\:\s\"(?P<rule_id>\d+)\"\;\s+RL\:\s+\"(?P<rule_level>\d+)\"\;\s+RG\:\s+\"(?P<rule_group>[^"]*)\"\;\s+RC\:\s+\"(?P<rule_comment>[^"]*)\";\sUSER:\s+\"(?P<username>[^"]+)\";\sSRCIP:\s\"(?P<srcip>[^"]*)\"\;\sHOSTNAME:\s+\"\((?P<hostname>[^)]+)\)\s(?P<winip>\S+)->[^"]*\";\sLOCATION\:\s\"(?P<location>[^"]*)\"\;\s+EVENT\:\s+\"\[INIT\](?P<log>[^[]*)\[END\]\"\;"
date={normalize_date($date)}
plugin_id={translate($rule_id)}
plugin_sid={$rule_id}
device={$winip}
src_ip={$srcip}
dst_ip={$winip}
username={$username}
userdata1={$hostname}
userdata2={$location}
userdata3={$rule_comment}
userdata4={$rule_group}
userdata5={$log}


[9999 - Ossec SUPER GENERIC]
event_type=event
regexp="^AV\s-\sAlert\s-\s\"(?P<date>\d+)\"\s-->\sRID:\s\"(?P<rule_id>\d+)\";\sRL:\s\"(?P<rule_level>\d+)\";\sRG:\s\"(?P<rule_group>\S+)\";\sRC:\s\"(?P<rule_comment>[^\"]*)\";\sUSER:\s\"(?P<username>\S+)\";\sSRCIP:\s\"(?P<srcip>[^\"]*)\";\sHOSTNAME:\s\"\(?(?P<hostname>[^\"\)]*).*\[END\]\";"
date={normalize_date($date)}
device={$hostname}
src_ip={$hostname}
dst_ip={$hostname}
plugin_sid={$rule_id}
plugin_id={translate($rule_id)}