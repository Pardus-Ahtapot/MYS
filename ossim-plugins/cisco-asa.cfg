# Alienvault plugin
# Author: Alienvault Team at plugins@alienvault.com
# Plugin cisco-asa id:1636 version: 0.0.28
# Last modification: 2018-05-10 14:40
#
# Plugin Selection Info:
# Cisco:ASA Adaptive Security Appliance:-
#
# END-HEADER
# Accepted products:
# cisco - asa_5500 7.0
# cisco - asa_5500 7.1
# cisco - asa_5500 7.2
# cisco - asa_5510 -
# Description:
# Cisco Asa
#
#

[DEFAULT]
plugin_id=1636

[config]
type=detector
enable=yes

source=log
location=/var/log/cisco-asa.log
create_file=false

process=
start=no
stop=no
startup=
shutdown=

#Sep 17 06:25:31 5.5.5.5 : Sep 17 06:26:10 EDT: %ASA-ids-4-401004: Shunned packet: 1.1.1.1 ==> 1.1.1.2 on interface inside
[0001 - cisco-asa - Shunned packet]
precheck="==>"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>[^:]+:\s+(?P<src_ip>\S+)\s+==>\s+(?P<dst_ip>\S+).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
dst_ip={$dst_ip}
userdata1={$asa_short_msg}


#Sep 17 06:39:36 5.5.5.5 %ASA-4-302013: Built outbound TCP connection 404165487 for outside:1.1.1.1/80 (1.1.1.1/80) to inside:1.1.1.2/1672 (1.1.1.2/1672)
[0002 - cisco-asa - Built outbound connection]
event_type=event
precheck="Built outbound"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+Built outbound\s+(?P<protocol>\S+).*?(?P<conn_id>\d+)\s+for\s+(?P<dst_iface>[^:\s]+)\s*:\s*(?:(?P<dst_ipv4>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<dst_ipv6>[^/\s]+))\/(?P<dst_port>[\d\w]+)(?:\s*\((?P<dst_nat_ip>[^/\s]+)\/(?P<dst_nat_port>[\d\w]+)\))?\s+to\s+(?P<src_iface>[^:\s]+):\s*(?:(?P<src_ipv4>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<src_ipv6>[^/\s]+))\/(?P<src_port>[\d\w]+)(?:\s*\((?P<src_nat_ip>[^/\s]+)\/(?P<src_nat_port>[\d\w]+)\))?[^/(]*(?:\((?P<username>\w+)\))?"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ipv4}
dst_ip={$dst_ipv4}
src_port={resolv_port($src_port)}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
username={$username}
userdata1={$asa_short_msg}
userdata2={$dst_ipv6}
userdata3={$dst_iface}
userdata4={resolv($dst_nat_ip)}
userdata5={$dst_nat_port}
userdata6={$src_iface}
userdata7={resolv($src_nat_ip)}
userdata8={$src_nat_port}
userdata9={$src_ipv6}


#Apr 10 15:36:00 5.5.5.5 %ASA-6-302015: Built inbound UDP connection 595141 for outside:1.1.1.1/59358 (1.1.1.1/59358) to inside:1.1.1.2/53 (1.1.1.2/53) (testuser)
[0003 - cisco-asa - Built inbound connection]
precheck="Built inbound"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+Built inbound\s+(?P<protocol>\S+).*?(?P<conn_id>\d+)\s+for\s+(?P<src_iface>\S+)\s*:\s*(?P<src_ip>[^/\s]+)\/(?P<src_port>[\d\w]+)(\s*\((?P<src_nat_ip>[^/\s]+)\/(?P<src_nat_port>[\d\w]+)\))?\s+to\s+(?P<dst_iface>\S+):\s*(?P<dst_ip>[^/\s]+)\/(?P<dst_port>[\d\w]+)(\s*\((?P<dst_nat_ip>[^/\s]+)\/(?P<dst_nat_port>[\d\w]+)\))?[^/(]*(?:\((?P<username>\w+)\))?"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
username={$username}
userdata1={$asa_short_msg}
userdata2={$conn_id}
userdata3={$src_iface}
userdata4={resolv($src_nat_ip)}
userdata5={$src_nat_port}
userdata6={$dst_iface}
userdata7={resolv($dst_nat_ip)}
userdata8={$dst_nat_port}


#Mar 28 12:03:04 testbox %ASA-7-609002: Teardown local-host inside:1.1.1.1 duration 0:02:12
[0004 - cisco-asa - Teardown local-host]
precheck="Teardown"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>(?:Teardown\slocal-host\s)(?P<iface>[^:]*):(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s\S+\s(?P<duration>\S+).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
userdata1={$asa_short_msg}
userdata2={$iface}
userdata3={$duration}


#Mar 28 12:03:04 testbox %ASA-7-302021: Teardown ICMP connection for faddr 1.1.1.1/1024 gaddr 1.1.1.2/0 laddr 1.1.1.3/0 (testuser)
#Apr 16 13:09:48 5.5.5.5 %ASA-6-302020: Built inbound ICMP connection for faddr 1.1.1.1/3083 gaddr 1.1.1.2/0 laddr 1.1.1.3/0
[0005 - cisco-asa - Built and teardown (Older style 3020)]
event_type=event
precheck="faddr"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):?\s+(?P<userdata>.*?(?P<protocol>tcp|TCP|udp|UDP|esmtp|ESMTP|ipsec|IPSEC|IPSec|icmp|ICMP|ftp|FTP)\s.*?faddr\s(?P<dst_ip>[^/\s]+)\/(?P<dst_port>[\d\w]+)\s.*?laddr\s(?P<src_ip>[^/\s]+)\/(?P<src_port>[\d\w]+)[^/(]*(?:\((?P<username>\w+)\))?.*)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={resolv_port($src_port)}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
username={$username}
userdata1={$asa_short_msg}


#Mar 28 12:01:50 testbox %ASA-6-302016: Teardown UDP connection 144435 for outside:1.1.1.1/1884 to inside:1.1.1.2/389 duration 0:02:01 bytes 287 (testuser)
#Mar 28 12:01:35 testbox %ASA-6-302014: Teardown TCP connection 144527 for outside:1.1.1.1/4743 to inside:1.1.1.2/10011 duration 0:00:13 bytes 23810 TCP Reset-O (testuser)
[0006 - cisco-asa - Teardown connection]
event_type=event
precheck="Teardown"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):?\s+(?P<userdata>Teardown\s+(?P<protocol>\S+).*?(?P<conn_id>\d+)\s+(?:for|from)\s+(?P<iface_1>[^:\s]+)\s*:\s*(?:(?P<src_ipv4>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<src_ipv6>[^/\s]+))(?:\/(?P<port_1>[\d\w]+))?.*?\s+to\s+(?P<iface_2>[^:\s]+)\s*:\s*(?:(?P<dst_ipv4>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<dst_ipv6>[^/\s]+))(?:\/(?P<port_2>[\d\w]+))?[^\(]+(?:\((?P<username>\w+)\))?)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ipv4}
dst_ip={$dst_ipv4}
src_port={$port_1}
dst_port={$port_2}
protocol={normalize_protocol($protocol)}
username={$username}
userdata1={$asa_short_msg}
userdata2={$conn_id}
userdata3={$iface_1}
userdata4={$src_ipv6}
userdata5={$port_1}
userdata6={$iface_2}
userdata7={$dst_ipv6}
userdata8={$port_2}


#May 22 07:43:43 testbox %ASA-6-305012: Teardown dynamic UDP translation from inside:1.1.1.1/56281 to outside:1.1.1.2/56281 duration 0:00:30
[0007 - cisco-asa - Generic teardown]
event_type=event
precheck="Teardown"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?P<userdata>Teardown\s+(?:dynamic|static)?\s*(?P<protocol>\S+).*?(?:for|from)\s+(?P<iface_1>\S+)\s*:\s*(?P<ip_1>[^/\s]+)(?:\/(?P<port_1>[\d\w]+))?.*?\s+to\s+(?P<iface_2>\S+)\s*:\s*(?P<ip_2>[^/\s]+)(?:\/(?P<port_2>[\d\w]+))?.*?)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$ip_1}
dst_ip={$ip_2}
src_port={$port_1}
dst_port={$port_2}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}
userdata2={$iface_1}
userdata3={$iface_2}


#Jun 13 11:53:00 5.5.5.5 %ASA-4-106023: Deny icmp src test:1.1.1.1 dst inside:test1 (type 3, code 3) by access-group "TestGroup" [0x0, 0x0]
[0008 - cisco-asa - Deny]
precheck="Deny"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?\d+-(?P<sid>\d+)):?\s+(?P<userdata>Deny\s+(?P<protocol>tcp|TCP|udp|UDP|esmtp|ESMTP|ip|IP|ipsec|IPSEC|IPSec|icmp|ICMP|ftp|FTP)[^:]*:(?P<src_ip>[^/\s]+)\/?(?P<src_port>[\d\w]+)?(?:\((?P<src_machine>[^\\]*)\\(?P<src_username>[^@]*)@(?P<src_domain>[^\)]*)\))?[^:]*:(?P<dst_ip>[^/\s(]+)\/?(?P<dst_port>[\d\w]+)?\s*(?:(?:\((?P<dst_machine>[^\\]*)\\(?P<dst_username>[^@(]*)(?:@(?P<dst_domain>[^\)]*))?\)))?[^"]*"(?P<group>[^"]*).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
username={$src_username}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}
userdata2={$group}
userdata3={$src_machine}
userdata4={$src_domain}
userdata5={$dst_machine}
userdata6={$dst_username}
userdata7={$dst_domain}


#Sep 17 06:29:56 5.5.5.5 : Sep 17 06:30:35 EDT: %ASA-session-6-106015: Deny TCP (no connection) from 1.1.1.1/3128 to 1.1.1.2/53467 flags PSH ACK  on interface inside
[0009 - cisco-asa - Deny on interface]
event_type=event
precheck="on interface"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?P<userdata>Deny(?:.+)?from\s+(?:(?P<src_ipv4>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<src_ipv6>[^/\s]+))(?:/(?P<src_port>[\d\w]+))\s+to\s+(?:(?P<dst_ipv4>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<dst_ipv6>[^/\s]+))(?:/(?P<dst_port>[\d\w]+)).*?on\s+interface\s+(?P<iface>\S+)(?:.+)?)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ipv4}
dst_ip={$dst_ipv4}
src_port={resolv_port($src_port)}
dst_port={resolv_port($dst_port)}
interface={$iface}
userdata1={$asa_short_msg}
userdata2={$src_ipv6}
userdata3={$dst_ipv6}


#Sep 17 06:39:33 5.5.5.5 : Sep 17 06:40:13 EDT: %ASA-ip-3-313001: Denied ICMP type=3, code=3 from 1.1.1.1 on interface outside to 1.1.1.1
[0010-a - cisco-asa - Denied on interface (dst ip)]
event_type=event
precheck="Denied"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+Denied .+ from (?:laddr\s+)?(?P<src_ip>\S+) on interface \S+\s+to (?P<dst_ip>\S+)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$dst_ip}
userdata1={$asa_short_msg}

#Sep 17 06:39:33 5.5.5.5 : Sep 17 06:40:13 EDT: %ASA-ip-3-313001: Denied ICMP type=3, code=3 from 1.1.1.1 on interface outside
[0010-b - cisco-asa - Denied on interface (no dst ip)]
event_type=event
precheck="Denied"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+Denied .+ from (?:laddr\s+)?(?P<src_ip>\S+) on interface \S+.*"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$device}
userdata1={$asa_short_msg}


#Dec 14 14:13:20 5.5.5.5 : Sep 27 2002 14:22:24: %ASA-6-106015: Deny TCP (no connection) from test.tta.at/23 to test.ttb.at/46170 flags FIN PSH ACK  on interface eth1
[0011 - cisco-asa - Generic Deny from -> to]
precheck="Deny"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>Deny\s+(inbound\s|outbound\s)?(?P<protocol>\S+).*?from\s(?P<src_ip>[^/\s,]+)(\/(?P<src_port>[\d\w]+))?\s+to\s(?P<dst_ip>[^/\s,]+)(\/(?P<dst_port>[\d\w]+))?.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}


#Sep 17 06:25:50 5.5.5.5 : Sep 17 06:26:29 EDT: %ASA-auth-4-113019: Group = TestGroup, Username = testuser, IP = 1.1.1.1, Session disconnected. Session Type: SSL, Duration: 8h:19m:41s, Bytes xmt: 25588196, Bytes rcv: 3839566, Reason: Idle Timeout
[0012 - cisco-asa - Group.  Reason]
precheck="Reason"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+Group\s+=\s+(?P<group>[^,]+),\s+Username\s+\=\s+(?P<user>[^,]+),(?:\s+IP = (?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?.*?(?:Session Type:\s+(?P<session_type>[^,]+),\s+Duration:\s+(?P<duration>[^,]+),\s+Bytes xmt:\s+(?P<bytes_xmt>\d+),\s+Bytes rcv:\s+(?P<bytes_rcv>\d+),\s+)?Reason:\s+(?P<reason>.+)"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$device}
username={$user}
userdata1={$asa_short_msg}
userdata2={$group}
userdata3={$reason}
userdata4={$session_type}
userdata5={$duration}
userdata6={$bytes_xmt}
userdata7={$bytes_rcv}


#Apr 10 15:35:59 5.5.5.5 %ASA-4-722041: TunnelGroup <Test Group VPN Pledge> GroupPolicy <Test Group VPN Policy> User <testuser> IP <1.1.1.1> No IPv6 address available for SVC connection
[0013 - cisco-asa - TunnelGroup]
precheck="TunnelGroup"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+TunnelGroup <(?P<tunnelgroup>.*)> GroupPolicy <(?P<grouppolicy>.*)> User <(?P<username>\S+)> IP <(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})> (?P<userdata>.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
username={$username}
src_ip={$src_ip}
userdata1={$asa_short_msg}
userdata2={$tunnelgroup}
userdata3={$grouppolicy}

#Feb  1 10:47:47 5.5.5.5 %ASA-6-713213: Group = 1.1.1.1, IP = 1.1.1.1, Deleting static route for L2L peer that came in on a dynamic map. address: 15.15.15.15, mask: 255.255.255.25
[0014-a - cisco-asa - Group, username and IP (dst ip and mask)]
precheck="Group"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?P<userdata>Group\s=\s(?P<group>[^,]*),(?:\sUsername\s=\s(?P<username>[^,]*),)?\s(?:IP\s=\s(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),)?[^\.]+\.\s+address:\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?:,\s+mask:\s+(?P<mask>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?).*"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$dst_ip}
username={$username}
userdata1={$asa_short_msg}
userdata2={$group}
userdata3={$mask}

#Sep 17 06:25:50 5.5.5.5 : Sep 17 06:26:29 EDT: %ASA-auth-4-113019: Group = TestGroup, Username = testuser, IP = 1.1.1.1, Session disconnected. Session Type: SSL, Duration: 8h:19m:41s, Bytes xmt: 25588196, Bytes rcv: 3839566, Reason: Idle Timeout
#Nov 19 16:43:56 5.5.5.5 %ASA-5-713050: Group = TestGroup, Username = testuser, Local Proxy 0.0.0.0
#May 11 04:35:59 5.5.5.5 :%ASA-vpn-7-713225: Group = 1.1.1.1, IP = 1.1.1.1, Static Crypto Map check, map WAN_map, seq = 65 is a successful match
[0014-b - cisco-asa - Group, username and IP (no dst ip)]
precheck="Group"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?P<userdata>Group\s=\s(?P<group>[^,]*),(?:\sUsername\s=\s(?P<username>[^,]*),)?\s(?:IP\s=\s(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),)?.*)"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$device}
username={$username}
userdata1={$asa_short_msg}
userdata2={$group}


#Apr 10 15:35:59 5.5.5.5 %ASA-4-722051: Group <TestGroup VPN> User <testuser> IP <1.1.1.1> Address <1.1.1.2> assigned to session
#May 24 13:52:32 5.5.5.5 %ASA-6-716059: Group <VPN_Test> User <testuser> IP <1.1.1.1> AnyConnect session resumed connection from IP <1.1.1.1>
[0015 - cisco-asa - Group Authentication]
event_type=event
precheck="IP"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*Group\ <(?P<group>.*?)>.*User\s<(?P<username>.*?)>\sIP\s<(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})>\s(?:(?:IPv4\s+)?Address\s<(?P<target_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})>)?.*)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$device}
username={$username}
userdata1={$asa_short_msg}
userdata2={$group}
userdata3={$target_ip}

#Mar 25 02:21:47 1.1.1.1 %ASA-4-402116: IPSEC: Received an ESP packet (SPI= 0x6101B57A, sequence number= 0xAA) from 2.2.2.2 (user= 3.3.3.3) to 4.4.4.4.  The decapsulated inner packet doesn't match the negotiated policy in the SA.  The packet specifies its destination as 5.5.5.5, its source as 6.6.6.6, and its protocol as icmp.  The SA specifies its local proxy as 7.7.7.7/255.255.255.255/ip/0 and its remote_proxy as 8.8.8.8/255.255.255.255/ip/0.
[0016 - cisco-asa - IPSec Packet with specified proto]
event_type=event
precheck="protocol as"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?:.*?(?:ipsec|IPSEC|IPSec):.*?from\s(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*?(?:user=\s(?P<user>[^\)]+)\)\s*)?(?:to\s)(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})).*?destination as (?P<packet_dst>[^\s,]*).*?source as (?P<packet_src>[^\s,]*).*?protocol as (?P<proto>\w+).*?proxy as (?P<proxy>[^\s+]*).*?remote_proxy as (?P<remote_proxy>[^\s]*)\."
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$dst_ip}
protocol={normalize_protocol($proto)}
username={$user}
userdata1={$asa_short_msg}
userdata2={$packet_dst}
userdata3={$packet_src}
userdata4={$proxy}
userdata5={$remote_proxy}

#Mar 28 12:02:34 testbox %ASA-6-402119: IPSEC: Received an ESP packet (SPI= 0x89CF6708, sequence number= 0x9BE) from 1.1.1.1 (user= myuser) to 1.1.1.2 that failed anti-replay checking.
[0017 - cisco-asa - IPSec ESP Packet]
precheck="ESP"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*?(?P<protocol>ipsec|IPSEC|IPSec):.*?from\s(?P<src_ip>[^/\s]+).*?(?:user=\s(?P<user>[^\)]+)\)\s*)?(?:to\s)(?P<dst_ip>[^/\s]+).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
dst_ip={$dst_ip}
protocol={normalize_protocol($protocol)}
username={$user}
userdata1={$asa_short_msg}


#Apr 15 13:09:48 5.5.5.5 %ASA-4-400014: IDS:2004 ICMP echo request from 1.1.1.1 to 1.1.1.2 on interface outside
[0018 - cisco-asa - IPS/IDS]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>[^:]+:\d+\s+(?P<protocol>\S+)\D+(?P<src_ip>\S+)\s+to\s+(?P<dst_ip>\S+).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
dst_ip={$dst_ip}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}


#May 11 06:11:45 5.5.5.5 :%ASA-vpn-6-602303: IPSEC: An inbound LAN-to-LAN SA (SPI= 0x24383A71) between 1.1.1.1 and 1.1.1.2 (user= 1.1.1.2) has been created
[0019 - cisco-asa - IPSEC (A new security association (SA) was created)]
precheck="between"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*?(?P<protocol>ipsec|IPSEC|IPSec).*?(?:between\s)(?P<src_ip>[^/\s]+)\s+(?:and\s+)(?P<dst_ip>[^/\s]+)(?:\s+\(user=\s(?P<user>[^\)]+)\)\s*).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
dst_ip={$user}
protocol={normalize_protocol($protocol)}
username={$user}
userdata1={$asa_short_msg}
userdata2={$dst_ip}


#Mar 28 12:03:04 testbox %ASA-4-402117: IPSEC: Received a non-IPSec packet (protocol= ICMP) from 1.1.1.1 to 1.1.1.2
[0020 - cisco-asa - non-IPSec packet received]
precheck="IPSEC"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>(.+)?IPSEC(.+)?protocol=(\s+)?(?P<protocol>[^)]+)(.+)?from\s+(?P<src_ip>\S+)\s+to\s+(?P<dst_ip>[^/\s]+).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
dst_ip={$dst_ip}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}


#May 22 07:43:43 testbox %ASA-6-305012: Invalid transport field for protocol=TCP, from 1.1.1.1/56281 to 1.1.1.2/56281
[0021 - cisco-asa - Invalid transport field]
precheck="protocol="
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>[^=]+protocol=\s*(?P<protocol>\w+).*?(?:from\s(?P<src_ip>[^/\s]+)(\/?(?P<src_port>[\d\w]+))?).*?(?:to)\s(?P<dst_ip>[^/\s]+)(\/(?P<dst_port>[\d\w]+))?.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}


#<190>Nov 19 2008 10:06:58: %ASA-6-201010: Embryonic connection limit exceeded 11468/11468 for inbound packet from 1.1.1.1/46954 to 1.1.1.2/443 on interface internet
[0022 - cisco-asa - Embryonic connection limit exceeded]
precheck="Embryonic"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>Embryonic connection limit exceeded.*?from\s+(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\/(?P<src_port>[\d\w]+)\sto\s(?:\S+:)?(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\/(?P<dst_port>[\d\w]+).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
userdata1={$asa_short_msg}


#<191>Apr 10 15:28:51 5.5.5.5 %ASA-3-108003: Terminating ESMTP connection; malicious pattern detected in the mail address from inside:1.1.1.1/25 to Outside:1.1.1.2/14383. Mail Address:MAIL FROM:<testuser@test.org> SIZE=1213
[0023 - cisco-asa - Mail Address]
precheck="Mail"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*?(?P<protocol>tcp|TCP|udp|UDP|esmtp|ESMTP|ipsec|IPSEC|IPSec|icmp|ICMP|ftp|FTP)\s.*?(?:faddr|from)\s+(?:\S+:)?(?P<src_ip>[^/\s]+)\/?(?P<src_port>[\d\w]+)?\s+.*?(?:gaddr|to)\s+(?:\S+:)?(?P<dst_ip>[^/\s]+)\/?(?P<dst_port>[\d\w]+)?\.\s+Mail Address:[^<]*<(?P<mail>[^>\s]+)>.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}
userdata2={$mail}


#<191>Apr 10 15:28:51 5.5.5.5 %ASA-3-108003: Terminating ESMTP connection; malicious pattern detected in the mail address from inside:1.1.1.1/25 to Outside:1.1.1.2/14383. Mail Address:MAIL FROM:<testuser@test.org> SIZE=1213
[0024 - cisco-asa - ESMTP]
precheck="ESMTP"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*?\w+\sESMTP[^:]+:\s*(?P<src_ip>[^/\s]+)(\/(?P<src_port>[\d\w]+))?[^:]+:\s*(?P<dst_ip>[^/\s]+)(\/(?P<dst_port>[\d\w]+))?.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol('TCP')}
userdata1={$asa_short_msg}


#Nov 15 2011 07:39:24: %ASA-3-414003: TCP Syslog Server OUTSIDE_PUB:1.1.1.1/1470 not responding, New connections are denied
[0025 - cisco-asa - Syslog server]
precheck="OUTSIDE_PUB"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+TCP Syslog Server OUTSIDE_PUB:(?P<src_ip>[^/\s]+)(\/(?P<src_port>[\d\w]+))?"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
userdata1={$asa_short_msg}


#Nov 15 09:36:23 5.5.5.5 Nov 15 2011 09:36:23: %ASA-3-710003: TCP access denied by ACL from 1.1.1.1/58361 to OUTSIDE_PUB:MyPubIP/80
[0026 - cisco-asa - Access denied by ACL]
precheck="access denied by ACL"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+TCP access denied by ACL from\s(?P<src_ip>[^/\s]+)(\/(?P<src_port>[\d\w]+))? to OUTSIDE_PUB:\s*(?P<dst_ip>[^/\s]+)(\/(?P<dst_port>[\d\w]+))?"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
userdata1={$asa_short_msg}


#Mar 28 12:03:04 testbox %ASA-3-710003: DHCP daemon interface inside: address granted aaaa.bbbb.cccc (1.1.1.1)
[0027 - cisco-asa - Address granted]
precheck="granted"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*?address\s+granted(.+)?\((?P<src_ip>[^,|^)]+)(,|\))(.+)?)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
userdata1={$asa_short_msg}


#Mar 28 12:04:05 testbox %ASA-7-609002: Teardown local-host inside:1.1.1.1 duration 0:00:14
[0028 - cisco-asa - Generic Local-host messages]
precheck="local-host"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*\s(?P<interface>\S+):(?P<src_ip>[^/\s]+).*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
interface={$interface}
src_ip={$src_ip}
userdata1={$asa_short_msg}



#Mar 28 12:03:14 testbox %ASA-4-313005: No matching connection for ICMP error message: icmp src outside:1.1.1.1 dst inside:1.1.1.2 (type 3, code 3) on outside interface.  Original IP payload: udp src 1.1.1.1/53 dst 1.1.1.2/2561.
[0029 - cisco-asa - No matching connection]
precheck="No matching connection"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>No matching connection for \S+.*udp src (?P<src_ip>\S+)/(?P<src_port>[\d\w]+) dst (?P<dst_ip>\S+)/(?P<dst_port>[\d\w]+))"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
userdata1={$asa_short_msg}


#Mar 28 12:03:04 testbox %ASA-auth-6-113004: AAA challenge received for user 1.1.1.1 from server 1.1.1.2
[0030 - cisco-asa - Challenge received]
precheck="AAA challenge received"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+AAA challenge received for user (?P<username>\S+) from server (?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|[^/\s\.]+)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
username={$username}
userdata1={$asa_short_msg}


#Sep 17 06:31:35 5.5.5.5 : Sep 17 06:32:14 EDT: %ASA-auth-6-113004: AAA user authentication Successful : server =  1.1.1.1: user = testuser
#Oct 15 12:51:00 testbox %ASA-7-113012: AAA user authentication Successful : local database : user = testuser
[0031 - cisco-asa - User authentication/accounting Successful/Rejected]
precheck="AAA user "
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+AAA\suser\s(?:accounting|authentication)\s(?:Successful|Rejected\s:\sreason\s=\s(?:Invalid\spassword|AAA\sfailure)?)\s:\s(?:server\s*=\s+(?P<server_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|local\sdatabase)\s*:\s*user\s=\s(?P<username>\S+)(?:\s:\suser\sIP\s=\s(?P<user_ip>\S+))?"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$user_ip}
dst_ip={$server_ip}
username={$username}
userdata1={$asa_short_msg}


#Sep 17 06:31:35 5.5.5.5 : Sep 17 06:32:14 EDT: %ASA-auth-6-113009: AAA retrieved default group policy (TestGroupPolicy) for user = testuser
[0032 - cisco-asa - Retrieved default group policy]
precheck="AAA retrieved default group policy"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+AAA retrieved default group policy.*for user = (?P<username>\S+)"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
dst_ip={$device}
username={$username}
userdata1={$asa_short_msg}


#Sep 17 06:31:35 5.5.5.5 : Sep 17 06:32:14 EDT: %ASA-auth-6-113008: AAA transaction status ACCEPT : user = testuser
[0033 - cisco-asa - Transaction status]
precheck="transaction status"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+AAA transaction status (?P<status>\S+).* user = (?P<username>\S+)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
username={$username}
userdata1={$asa_short_msg}
userdata2={$status}


#Apr 10 15:35:57 5.5.5.5 %ASA-7-734003: DAP: User testuser, Addr 1.1.1.1: Session Attribute aaa.bbb.grouppolicy = Test Group VPN
#Sep 17 06:31:35 5.5.5.5 : Sep 17 06:32:14 EDT: %ASA-dap-6-734001: DAP: User testuser, Addr 1.1.1.1, Connection AnyConnect: The following DAP records were selected for this connection: DfltAccessPolicy#012
[0034 - cisco-asa - Generic DAP messages]
precheck="DAP"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+DAP: User (?P<username>\S+), Addr (?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(:|\,) (?P<userdata>.+)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
username={$username}
src_ip={$src_ip}
userdata1={$asa_short_msg}


#Jun  6 10:22:31 textbox : %ASA-6-106100: access-list FROM-SRC_IFACE permitted tcp SRC_IFACE/1.1.1.1(2473) -> DST_IFACE/1.1.1.1(9433) hit-cnt 1 first hit [0xe4e2027a, 0x51d5addd]
[0035 - cisco-asa - Access list]
event_type=event
precheck="access-list"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+access-list (?P<acl_id>\S+) (?P<status>permitted|denied) (?P<protocol>tcp|TCP|udp|UDP|esmtp|ESMTP|ipsec|IPSEC|IPSec|icmp|ICMP|ftp|FTP) (?:for user '(?P<username>[^']*)'\s+)?(?P<src_iface>\S+)\/(?:(?P<src_ipv4>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<src_ipv6>[^/\s(]+))\((?P<src_port>[\d\w]+)\) \-> (?P<dst_iface>\S+)\/(?:(?P<dst_ipv4>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?P<dst_ipv6>[^/\s(]+))\((?P<dst_port>[\d\w]+)\) hit-cnt (?P<hitcnt>\d+)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ipv4}
dst_ip={$dst_ipv4}
src_port={resolv_port($src_port)}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
username={$username}
userdata1={$asa_short_msg}
userdata2={$acl_id}
userdata3={$status}
userdata4={$src_iface}
userdata5={$dst_iface}
userdata6={$src_ipv6}
userdata7={$dst_ipv6}


#Jul  1 16:24:59 5.5.5.5 %ASA-5-111008: User 'testuser' executed the 'ping 1.1.1.1' command
[0036 - cisco-asa - Command execution]
precheck="executed the"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+User '?(?P<user>[^'\s]+)'? executed the '(?P<command>.+?)' command"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$device}
username={$user}
userdata1={$asa_short_msg}
userdata2={$command}


#Jul  1 16:16:43 5.5.5.5 %ASA-5-111010: User 'testuser', running 'N/A' from IP 1.1.1.1, executed 'write memory'
[0037 - cisco-asa - Application execution]
event_type=event
precheck="running"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+User '(?P<user>[^'\s]+)', running '(?P<application>\S+)' from IP (?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}), executed '(?P<command>.+?)[']"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$device}
username={$user}
userdata1={$asa_short_msg}
userdata2={$application}
userdata3={$command}


#mar 19 09:24:47 5.5.5.5 %asa-4-304001: 1.1.1.1 Accessed URL 1.1.1.1:/folder1/applet/test.jar
[0038 - cisco-asa - Accessed URL]
precheck="Accessed"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+Accessed.*?URL\s+(?P<dst_ip>[^:|\s+]+)(?::)?(?P<url>\S+)?.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
dst_ip={$dst_ip}
userdata1={$asa_short_msg}
userdata2={$url}


#Mar 28 12:03:04 testbox %ASA-5-304002: Access denied URL http://www.example.com/feedout/content SRC 1.1.1.1 DEST 1.1.1.2 on interface inside
[0039 - cisco-asa - Access denied to URL]
precheck="Access denied"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s*Access denied URL\s(?P<url>\S{1,200})\s*(SRC\s(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\sDEST\s(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s)?"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
dst_ip={$dst_ip}
userdata1={$asa_short_msg}
userdata2={$url}


#Oct 15 13:10:00 10.200.5.3 %ASA-7-304005: URL Server 1.1.1.1 request pending URL
[0040 - cisco-asa - Generic URL information]
precheck="URL Server"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\sURL Server\s+(?P<dst_ip>[^/\s]+)(.+?URL\s?(?P<url>\S{1,200}))?.*"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
dst_ip={$dst_ip}
userdata1={$asa_short_msg}
userdata2={$url}


#May 11 11:54:32 5.5.5.5 :%ASA-sys-6-605005: Login permitted from 1.1.1.1/1265 to Prod:1.1.1.1/https for user "testuser"
[0041 - cisco-asa - Login]
precheck="Login"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):.*from\s(?P<src_ip>[^/\s]+)\/(?P<src_port>[\d\w]+)\sto\s(?:\S+:)?(?P<dst_ip>[^/\s]+)\/(?P<dst_port>[\d\w]+)\sfor\suser\s\"(?P<username>.*?)["]"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
username={$username}
userdata1={$asa_short_msg}


#Mar 26 15:48:44 testbox : %ASA-6-110001: No route to 1.1.1.1 from 1.1.1.2
[0042 - cisco-asa - No route]
precheck="No route"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+No route to\s+(?P<dst_ip>[^/\s]+)\/?(?P<dst_port>[\d\w]+)? from (?P<src_ip>[^/\s]+)\/?(?P<src_port>[\d\w]+)?"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
userdata1={$asa_short_msg}

[0043 - cisco-asa Device selects]
event_type=event
precheck="select"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+Device selects trust-point\s+(?P<name>\S+)\s+for\s+(?P<peer_type>\S+)\s+.*?(?P<asa_iface>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\/(?P<asa_port>\d+):(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\/(?P<src_port>\d+)\s+to\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\/(?P<dst_port>\d+)"
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata1={$asa_short_msg}
userdata2={$asa_iface}
userdata3={$asa_port}
userdata4={$name}
userdata5={$peer_type}

#Mar 31 15:14:36 1.1.1.1 %ASA-4-717037: Tunnel group search using certificate maps failed for peer certificate: serial number: asdasdasdasd, subject name: e=USER.NAME@aha.net,cn=USER.NAME,ou=ahaha,o=COMPANY,l=CITY,st=STATE,c=US, issuer_name: e=postmaster@postblabla.net,cn=something.something,ou=IT,o=COMPANY,st=STATE,c=US.
#Feb 20 07:21:16 1.1.1.1 : %ASA-3-717009: Certificate validation failed. No suitable trustpoints found to validate certificate serial number: asasasasasas, subject name: cn=COMMON NAME,o=ORGANIZATION NAME,l=CITY,st=STATE,c=GB, issuer name: cn=COMMON NAME,o=ORGANIZATION NAME,l=CITY,st=STATE,c=GB .
[0044 - cisco-asa Certificates]
event_type=event
precheck="serial number:"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?:(?!serial number:)\S+\s+)+serial number:\s+(?P<serial_number>[^,]+),\s+subject name:\s+(?:e=(?P<email>[^,]+),)?cn=(?P<username>[^,]+),\S+(?:(?!issuer(?:_| )name)\s\S+)*\s*issuer(?:_| )name:\s+(?:e=(?P<email2>[^,]+),)?cn=(?P<username2>[^,]+)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$device}
username={$username}
userdata1={$asa_short_msg}
userdata2={$serial_number}
userdata3={$email}
userdata4={$email2}
userdata5={$username2}

#Mar 17 07:38:09 1.1.1.1 : %ASA-6-737026: IPAA: Client assigned 2.2.2.2 from local pool
[0045 - cisco-asa - Client assigned ip]
event_type=event
precheck="Client assigned"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w-]*-?(?:\d+)-(?P<sid>\d+)):\s+IPAA:\s+Client assigned (?P<src>\d+\.\d+\.\d+\.\d+)\s+from\s+(?P<from>local pool|\S+)"
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src}
userdata1={$asa_short_msg}
userdata2={$from}

#May  9 02:01:22 10.105.0.5 %ASA-6-303002: FTP connection from outside:61.12.5.98/54528 to dmz:10.105.20.93/21, user DSSIUser Stored file GE Releving Order_WA02193306.pdf
[0052 - cisco-asa - FTP connection]
precheck="FTP connection from"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\sFTP\sconnection\sfrom[^:]+:(?P<src_ip>[^/]+)/(?P<src_port>\S+)\sto[^:]+:(?P<dst_ip>[^/]+)/(?P<dst_port>[^,]+),\suser\s(?P<username>\S+)\s(?:Stored|Retrieved)\sfile\s(?P<filename>.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
username={$username}
filename={$filename}
userdata1={$asa_short_msg}


#Oct 15 13:15:00 10.57.11.251 :%ASA-config-7-111009: User 'test' executed cmd: show vpn-sessiondb detail full index 10
[0053 - cisco-asa - Generic username]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):.*(User\s\'|Uname:\s|user\s+=\s+|Username\s+=\s+|for\suser\s|User\s)(?P<username>[^\"\,\s\']+)\"?"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
username={$username}
userdata1={$asa_short_msg}


#May 11 00:16:32 5.5.5.5 :%ASA-vpn-7-713222: Group = 1.1.1.1, IP = 1.1.1.1, Static Crypto Map check, map = WAN_map, seq = 6, ACL does not match proxy IDs src:1.1.1.2 dst:255.255.255.255
[0054 - cisco-asa - Generic src-dst]
precheck="src"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*?(?P<protocol>tcp|TCP|udp|UDP|esmtp|ESMTP|ipsec|IPSEC|IPSec|icmp|ICMP|ftp|FTP)?\s+src[^:]*:(?P<src_ip>[^/\s]+)(\/(?P<src_port>[\d\w]+))?\s*dst[^:]*:(?P<dst_ip>[^/\s]+)(\/(?P<dst_port>[\d\w]+))?.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}


#Mar 28 12:03:04 testbox %ASA-7-302021: Teardown ICMP connection for faddr 1.1.1.1/1024 gaddr 1.1.1.2/0 laddr 1.1.1.2/0 (testuser)
[0055 - cisco-asa - Generic faddr-gaddr]
precheck="faddr"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*?(?P<protocol>tcp|TCP|udp|UDP|esmtp|ESMTP|ipsec|IPSEC|IPSec|icmp|ICMP|ftp|FTP)?\s+.*?faddr\s+(?P<src_ip>[^/\s]+)(\/(?P<src_port>[\d\w]+))?.*?gaddr\s+(?P<dst_ip>[^/\s]+)(/(?P<dst_port>[\d\w]+))?.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
protocol={normalize_protocol($protocol)}
userdata1={$asa_short_msg}

#Nov 19 00:01:25 1.1.1.1 %ASA-5-111007: Begin configuration: 192.168.1.23 reading from http [POST]
#Feb 20 07:13:49 1.1.1.1 : %ASA-5-111001: Begin configuration: 1.1.1.1 writing to memory
#Mar 17 12:45:16 1.1.1.1 : %ASA-5-111007: Begin configuration:
#Mar 20 18:05:48 1.1.1.1 : %ASA-5-111007: Begin configuration: console reading from terminal
#Mar 20 17:46:36 1.1.1.1 : %ASA-5-111007: Begin configuration: 2.2.2.2 reading from terminal
[0056 - cisco-asa - Begin config]
precheck="Begin configuration"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w-]*-?(?:\d+)-(?P<sid>\d+)):\s+Begin configuration:(?:\s+(?:console |(?P<dst>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})).*?(?:writing to memory|reading from terminal|from\s+(?P<proto>\S+)\s+\[(?P<req_type>\S+)\]))?"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$device}
dst_ip={$dst}
protocol={normalize_protocol($proto)}
userdata1={$asa_short_msg}
userdata2={$req_type}

#Sep 17 06:25:46 testbox : Sep 17 06:26:25 EDT: %ASA-bridge-6-110002: Failed to locate egress interface for UDP from outside:1.1.1.1/58774 to 1.1.1.2/1900
#Mar 28 12:58:50 testbox %ASA-6-302015: Built inbound UDP connection 144370 for outside:1.1.1.1/63925 (1.1.1.1/63925) to NP Identity Ifc:1.1.1.2/500 (1.1.1.2/500)
#Apr 16 09:27:49 5.5.5.5 %ASA-4-313009: Denied invalid ICMP code 1, for inside:1.1.1.2/512 (1.1.1.2/512) to identity:5.5.5.5/0 (5.5.5.5/0), ICMP id 23439, ICMP type 8
#Feb 23 01:19:21 testbox : %ASA-5-305013: Asymmetric NAT rules matched for forward and reverse flows; Connection for udp src outside:1.1.1.1/59705(LOCAL\\test) dst sh-bckp:2.2.2.2/53 denied due to NAT reverse path failure
[0057 - cisco-asa - Generic from-to with protocol]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):?\s+(?P<userdata>.*?(?P<protocol>tcp|TCP|udp|UDP|esmtp|ESMTP|ipsec|IPSEC|IPSec|icmp|ICMP|ftp|FTP|RTP)\s.*(?:for|from|src)\s+(?:\S*:)?(?P<src_ip>[^/\s]+)(?:\/(?P<src_port>[\d\w]+))?(?:\((?P<domain>[^\\]+)\\\\(?P<username>[^)]+)\))?(?:.*?)(?:dst|to)\s(?:[^:]+:)?(?P<dst_ip>[^/\s]+)(?:\/(?P<dst_port>[\d\w]+))?.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={normalize_protocol($protocol)}
username={$username}
userdata1={$asa_short_msg}
userdata2={$domain}


#Oct 30 16:09:00 testbox %PIX-6-315011: SSH session from 1.1.1.1 on interface db for user "" disconnected by SSH server, reason: "TCP connection closed" (0x03)
[0058 - cisco-asa - Generic from-to without protocol]
precheck="from"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>.*?from\s+(?:\S*:)?(?P<src_ip>[^/\s]+)(\/(?P<src_port>[\d\w]+))?(.+?)(to\s(?:\S*:)?(?P<dst_ip>[^/\s]+)(\/(?P<dst_port>[\d\w]+))?)?.*)"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid={$sid}
src_ip={$src_ip}
src_port={resolv_port($src_port)}
dst_ip={$dst_ip}
dst_port={resolv_port($dst_port)}
userdata1={$asa_short_msg}


#May 11 01:15:57 5.5.5.5 :%ASA-vpn-5-713041: IP = 1.1.1.1, IKE Initiator: New Phase 1, Intf 1, IKE Peer 1.1.1.1 local Proxy Address 0.0.0.0, remote Proxy Address 1.1.1.2,  Crypto map (WAN_map)
[0059 - cisco-asa - Generic Rule with IP information]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?P<userdata>(?:.+)?(?:ip|IP)\s+=\s+(?P<src_ip>[^,]+),?(?:.*?local Proxy(?: Address)? (?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))(?:.+)?)"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src_ip}
dst_ip={$dst_ip}
userdata1={$asa_short_msg}

#Feb  1 16:10:01 1.1.1.1 %ASA-6-725002: Device completed SSL handshake with client serverfarm:15.15.15.15/50000
[0060 - cisco-asa - Device completed SSL handshake with client]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+Device completed SSL handshake with client serverfarm:\s*(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/(?P<dst_port>\d+)"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$device}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata1={$asa_short_msg}

#Feb 21 07:35:36 1.1.1.1 : %ASA-4-722003: IP <1.1.1.1> Error authenticating SVC connect request.
#Feb 20 07:13:51 1.1.1.1 : %ASA-5-111004: 1.1.1.1 end configuration: OK
[0061 - cisco-asa - SVC connect Error and End configuration]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+(?:IP <)?(?P<src>\d+\.\d+\.\d+\.\d+)>?\s+(?P<msg>Error \S+ SVC connect request|end configuration:\s+\S+)"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$src}
userdata1={$asa_short_msg}
userdata2={$msg}


#Feb 23 08:49:17 1.1.1.1 : %ASA-5-737003: IPAA: Session=0x0, DHCP configured, no viable servers found for tunnel-group 'TUNNEL-GROUP'
#Feb 19 10:16:34 1.1.1.1 : %ASA-5-737034: IPAA: Session=0x0006b000, IPv6 address: callback failed during IPv6 request
[0062 - cisco-asa - IPAA event]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(?:\d{4}\s)?\d\d:\d\d:\d\d)\s*:?(?:(?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(?:asa|ASA)-[\w\-]*-?(?:\d+)-(?P<sid>\d+)):\s+IPAA:\s+Session=(?P<session>[^,]+),\s+(?P<msg>.*?tunnel-group\s+'(?P<tunnel_group>[^']+)'|.*)"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
src_ip={$device}
dst_ip={$device}
userdata1={$asa_short_msg}
userdata2={$session}
userdata3={$tunnel_group}
userdata4={$msg}

#Jun 13 12:06:18 5.5.5.5 %ASA-4-733100: [ Scanning] drop rate-1 exceeded. Current burst rate is 1 per second, max configured rate is 10; Current average rate is 5 per second, max configured rate is 5; Cumulative total count is 3002
[0098 - cisco-asa - Generic Rule without IP information]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?\s+[\w\:\s]*%?(?P<asa_short_msg>(asa|ASA)-[\w\-]*-?(\d+)-(?P<sid>\d+)):\s+(?P<userdata>(.+))"
event_type=event
date={normalize_date($date)}
plugin_sid={$sid}
device={$device}
dst_ip={$device}
userdata1={$asa_short_msg}


#This should never really match, its a failsafe
[0099 - cisco-asa - Catch All]
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)\s*:?((?P<device>\S+)\s*:?)?(?P<userdata>(.+))"
event_type=event
date={normalize_date($date)}
device={$device}
plugin_sid=999999
