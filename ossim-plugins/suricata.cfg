# Alienvault plugin
# Author: Fatih usta <fatihusta@labrisnetworks.com>
# Plugin suricata_fastlog id:91118 version: 0.0.1
# Last modification: 2018-11-08 10:00
#
# Plugin Selection Info:
# suricata_fastlog:-
#
# END-HEADER
#
# Description:
#   suricata_fastlog
#
#
#
#
 
[DEFAULT]
plugin_id=91118
 
[config]
type=detector
enable=yes
 
source=log
location=/var/log/suricata/fast.log
 
create_file=false
 
process=
start=no
stop=no
startup=
shutdown=

# Nov 12 14:50:13 pardus suricata-fastlog 11/12/2018-15:50:14.653546  [**] [1:1000001:1] DNS Query Detection: google.com [**] [Classification: Potentially Bad Traffic] [Priority: 2] {UDP} 169.254.10.44:53180 -> 192.168.0.1:53
# Nov 12 14:50:13 pardus suricata-fastlog 11/12/2018-15:50:14.654880  [**] [1:1000001:1] DNS Query Detection: google.com [**] [Classification: Potentially Bad Traffic] [Priority: 2] {UDP} 169.254.10.44:55011 -> 192.168.0.1:53


[0001 - suricata_fastlog]
event_type=event
regexp="\w+\s+\d+\s\d+:\d+:\d+\s(?P<device>.*?)\s(?P<sensor>.*?)(?P<date>\d{2}\/\d{2}\/\d{4}-\d{2}:\d{2}:\d{2}).\d+\s+.*\[\*\*\]\s\[(?P<sid>\d+:\d+:\d+)\]\s(?P<msg>.+)\s\{(?P<protocol>.+)\}\s(?P<src_ip>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}):(?P<src_port>\d+)\s->\s(?P<dst_ip>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}):(?P<dst_port>\d+)\s*"
date={normalize_date($date)}
device={$dst_ip}
plugin_sid=1
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$protocol}
userdata1=SID: {$sid}
